webpackJsonp([1],{"3xtG":function(e,t){},OZcw:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={data:function(){return{query:{},CusIdArray:[],ruleForm:{Type:"",Amount:"",Receiver:"",ReceiverTel:"",ReceiverEmail:"",ReceiverAddress:""},FileData:[],switchContactsBool:!1,invoiceId:"",index:0}},created:function(){this.query=this.$route.query,console.log(this.query),void 0!=this.query.InvoiceAmount&&null!=this.query.InvoiceAmount&&(this.ruleForm.Amount=this.query.InvoiceAmount),this.GetCusLinkManMini()},mounted:function(){},computed:{},methods:{GetCusLinkManMini:function(){var e=this;this.API_GET("CRM/GetCusLinkManMini",{CusId:this.query.CusId}).then(function(t){e.CusIdArray=t.Dtos,console.log(t.Dtos);for(var r=0;r<e.CusIdArray.length;r++){var i=e.CusIdArray[r];console.log(i.Default),i.Default&&(e.ruleForm.Receiver=i.Name,e.ruleForm.ReceiverTel=i.Mobile,e.ruleForm.ReceiverEmail=i.Email,e.ruleForm.ReceiverAddress=i.Address)}})},receive:function(e){console.log(e),this.FileData.push({FileType:e.type,FileName:e.name,FileUrl:e.name,Base64:e.Base64,uid:e.uid,name:e.name,type:e.type})},deleteFun:function(e){console.log(e);for(var t=0;t<this.FileData.length;t++){this.FileData[t].uid==e.uid&&this.FileData.splice(t,1)}},switchContacts:function(e){this.switchContactsBool=!1,console.log(e),this.ruleForm.Receiver=e.Name,this.ruleForm.ReceiverTel=e.Mobile,this.ruleForm.ReceiverEmail=e.Email,this.ruleForm.ReceiverAddress=e.Address},applyForInvoicingFun:function(){var e=this;return console.log(this.ruleForm),""==this.ruleForm.Amount||0==this.ruleForm.Amount?(this.$message.error("请输入正确的数值！"),!1):""==this.ruleForm.Receiver?(this.$message.error("请输入收票人！"),!1):""==this.ruleForm.ReceiverTel?(this.$message.error("请输入收票人电话！"),!1):""==this.ruleForm.ReceiverAddress?(this.$message.error("请输入收票人地址！"),!1):"WorkOrder"==this.query.Type&&""==this.ruleForm.Type?(this.$message.error("请选择类型！"),!1):(this.ruleForm.MachineId=this.query.Id,void this.API_POST(this.query.API,this.ruleForm).then(function(t){0==e.FileData.length?(e.$message.success("申请成功"),e.$router.go(-1),e.$emit("refresh")):e.uploadFile(t)}))},uploadFile:function(e){var t=this;console.log(e),this.invoiceId=e,this.index=this.FileData.length;for(var r=0;r<this.FileData.length;r++){var i=this.FileData[r],o={Id:this.invoiceId,FileName:i.name,Type:i.type,FileStr:i.Base64};this.API_POST("Finance/UploadFinanceInvAtt",o,!1).then(function(e){t.index-=1,0==t.index&&(t.$message.success("申请成功"),t.$router.push({path:"/machine-sales-edit"}),t.$emit("refresh"))})}}},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},o={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("SaxoPage",{scopedSlots:e._u([{key:"title",fn:function(){return[r("saxo-button",{attrs:{mini:""},on:{click:e.applyForInvoicingFun}},[e._v("申请开票")])]},proxy:!0},{key:"content",fn:function(){return[r("h3",[e._v("开票信息")]),e._v(" "),r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,"status-icon":"","label-width":"100px"}},[r("el-form-item",{attrs:{label:"金额"}},[r("el-input",{staticStyle:{width:"500px"},attrs:{size:"mini"},model:{value:e.ruleForm.Amount,callback:function(t){e.$set(e.ruleForm,"Amount",t)},expression:"ruleForm.Amount"}})],1),e._v(" "),r("el-collapse-transition",[e.switchContactsBool?r("div",{staticClass:"switchContactsUL"},e._l(e.CusIdArray,function(t,i){return r("div",{key:i,staticClass:"switchContactsLi",on:{click:function(r){return e.switchContacts(t)}}},[r("h4",{staticStyle:{"margin-bottom":"8px"}},[e._v(e._s(t.Name))]),e._v(" "),r("p",[e._v(e._s(t.Position))]),e._v(" "),r("p",[e._v(e._s(t.Mobile))]),e._v(" "),r("p",[e._v(e._s(t.Email))]),e._v(" "),r("p",[e._v(e._s(t.Address))]),e._v(" "),t.Default?r("span",{staticClass:"mr"},[e._v("默认")]):e._e()])}),0):e._e()]),e._v(" "),r("el-form-item",{attrs:{label:"收票人"}},[r("el-input",{staticStyle:{width:"500px"},attrs:{size:"mini"},model:{value:e.ruleForm.Receiver,callback:function(t){e.$set(e.ruleForm,"Receiver",t)},expression:"ruleForm.Receiver"}},[r("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:function(t){e.switchContactsBool=!e.switchContactsBool}},slot:"append"})],1)],1),e._v(" "),r("el-form-item",{attrs:{label:"收票人电话"}},[r("el-input",{staticStyle:{width:"500px"},attrs:{size:"mini"},model:{value:e.ruleForm.ReceiverTel,callback:function(t){e.$set(e.ruleForm,"ReceiverTel",t)},expression:"ruleForm.ReceiverTel"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"收票人邮箱"}},[r("el-input",{staticStyle:{width:"500px"},attrs:{size:"mini",placeholder:"不必填"},model:{value:e.ruleForm.ReceiverEmail,callback:function(t){e.$set(e.ruleForm,"ReceiverEmail",t)},expression:"ruleForm.ReceiverEmail"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"收票人地址"}},[r("el-input",{staticStyle:{width:"500px"},attrs:{type:"textarea"},model:{value:e.ruleForm.ReceiverAddress,callback:function(t){e.$set(e.ruleForm,"ReceiverAddress",t)},expression:"ruleForm.ReceiverAddress"}})],1),e._v(" "),"WorkOrder"==e.query.Type?r("el-form-item",{attrs:{label:"类型"}},[r("el-radio",{attrs:{label:"SC"},model:{value:e.ruleForm.Type,callback:function(t){e.$set(e.ruleForm,"Type",t)},expression:"ruleForm.Type"}},[e._v("SC")]),e._v(" "),r("el-radio",{attrs:{label:"RV"},model:{value:e.ruleForm.Type,callback:function(t){e.$set(e.ruleForm,"Type",t)},expression:"ruleForm.Type"}},[e._v("RV")]),e._v(" "),r("el-radio",{attrs:{label:"SP"},model:{value:e.ruleForm.Type,callback:function(t){e.$set(e.ruleForm,"Type",t)},expression:"ruleForm.Type"}},[e._v("SP")])],1):e._e(),e._v(" "),r("el-form-item",{attrs:{label:"备注"}},[r("el-input",{staticStyle:{width:"500px"},attrs:{type:"textarea",placeholder:"不必填"},model:{value:e.ruleForm.Memo,callback:function(t){e.$set(e.ruleForm,"Memo",t)},expression:"ruleForm.Memo"}})],1)],1),e._v(" "),r("h3",[e._v("附件")]),e._v(" "),r("uploadFile",{attrs:{FileData:e.FileData,ShowDownload:!1},on:{receive:e.receive,deleteFun:e.deleteFun}})]},proxy:!0}])})},staticRenderFns:[]};var l=r("VU/8")(i,o,!1,function(e){r("3xtG")},"data-v-6b4aa4aa",null);t.default=l.exports}});