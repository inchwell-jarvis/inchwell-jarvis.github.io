webpackJsonp([87],{"/Bce":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("mvHQ"),o=a.n(r),s={data:function(){return{Product:{ProductCode:"",Manufacturer:"",Characteristics:"",CalibrationTechniques2:[],CalibrationTechniques:"",proType:"7"},restaurants:[],options:[],tableData:[],drawerShow:!1,Data:[],total:0,retrieval:{pageNum:1,numPerPage:0,orderField:"",orderDirection:"",proType:"8",productCode:"",barcodeMemo:"",man:"",desc:"",memo:""}}},created:function(){this.start(),this.GetManufacturer(),this.GetCEJSWJs(),this.GetProducts2()},computed:{retrievalJT:function(){return o()(this.retrieval)}},watch:{retrievalJT:function(t,e){this.WatchFenYe(t,e)?this.$refs.SaxoFenYe.ReviseConNumber1():this.GetProducts2()}},methods:{GetCEJSWJs:function(){var t=this;this.API_GET("Bill/GetCEJSWJs").then(function(e){console.log(e),t.options=e.Dtos})},start:function(){var t=this;this.API_GET("Product/GetProduct",{Id:this.$route.query.Id}).then(function(e){console.log(e),t.tableData=e.CLQJs||[],t.tableData.forEach(function(e){t.$set(e,"db",!0)});var a=e.ProductCode,r=e.Manufacturer,o=e.Characteristics,s=e.CalibrationTechniques;t.Product={ProductCode:a,Manufacturer:r,Characteristics:o,CalibrationTechniques:s,CalibrationTechniques2:JSON.parse(s),ID:t.$route.query.Id}})},GetManufacturer:function(){var t=this;this.API_GET("Product/GetManufacturer").then(function(e){t.optionss=e;for(var a=[],r=0;r<e.length;r++)a.push({value:e[r].Name,address:e[r].ID});t.restaurants=a})},querySearch:function(t,e){var a=this.restaurants;e(t?a.filter(this.createFilter(t)):a)},createFilter:function(t){return function(e){return 0===e.value.toLowerCase().indexOf(t.toLowerCase())}},handleSelect:function(t){this.Product.ManufacturerAddress=t.address},UpdateProduct:function(){var t=this;return""==this.Product.ProductCode?this.$message.warning("请输入型号！"):""==this.Product.Manufacturer?this.$message.warning("请输入品牌！"):0==this.Product.CalibrationTechniques2.length?this.$message.warning("请选择 校准技术！"):""==this.Product.Characteristics?this.$message.warning("请输入产品描述！"):(this.Product.CalibrationTechniques=o()(this.Product.CalibrationTechniques2),void this.API_POST("Product/UpdateProduct",this.Product).then(function(e){t.tableData.length>0?t.AddSubProducs():(t.$emit("refresh"),t.$router.push({path:"/laboratory-equipment"}),t.$message.success("修改成功！"))}))},AddSubProducs:function(){var t=this;this.$route.query.Id;var e={Id:this.$route.query.Id,Euqs:this.tableData.map(function(t){return{productid:t.ID}})};this.API_POST("Product/AddSubProducs",e).then(function(e){t.$emit("refresh"),t.$router.push({path:"/laboratory-equipment"}),t.$message.success("修改成功！")})},ShowFalse:function(){this.drawerShow=!1},func:function(t,e){this.retrieval.numPerPage=t,this.retrieval.pageNum=e,this.GetProducts2()},GetProducts2:function(){var t=this;this.API_GET("Product/GetProducts2",this.retrieval).then(function(e){t.total=e.DataBars,t.Data=e.Dtos;for(var a=0;a<t.Data.length;a++)t.Data[a].UpdateDate=t.Data[a].UpdateDate.split("T")[0]})},edit:function(t){console.log(t),this.tableData.some(function(e){return e.ID===t.ID})?this.$message.warning("已存在此设备！"):this.tableData.push(t)},deleteRow:function(t){var e=this;console.log(t),t.db?(console.log("远程"),this.API_POST("Product/DeleteSubProducts",{id:this.$route.query.Id,Euqs:[{ProductId:t.ID}]}).then(function(t){e.$message.success("删除成功！"),e.start()})):(this.$message.success("删除成功！"),this.tableData=this.tableData.filter(function(e){return e.ID!==t.ID}))}}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("SaxoPage",{scopedSlots:t._u([{key:"title",fn:function(){return[a("saxo-button",{staticStyle:{float:"right"},attrs:{mini:""},on:{click:function(e){return t.UpdateProduct()}}},[t._v("保 存")])]},proxy:!0},{key:"content",fn:function(){return[a("div",{staticClass:"From"},[a("span",[t._v("名称")]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.Product.Characteristics,callback:function(e){t.$set(t.Product,"Characteristics",e)},expression:"Product.Characteristics"}})],1),t._v(" "),a("div",{staticClass:"From"},[a("span",[t._v("型号")]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.Product.ProductCode,callback:function(e){t.$set(t.Product,"ProductCode",e)},expression:"Product.ProductCode"}})],1),t._v(" "),a("div",{staticClass:"From"},[a("span",[t._v("品牌")]),t._v(" "),a("el-autocomplete",{staticClass:"inline-input input",attrs:{"fetch-suggestions":t.querySearch,placeholder:"请输入内容"},on:{select:t.handleSelect},model:{value:t.Product.Manufacturer,callback:function(e){t.$set(t.Product,"Manufacturer",e)},expression:"Product.Manufacturer"}})],1),t._v(" "),a("div",{staticClass:"From"},[a("span",[t._v("技术文件")]),t._v(" "),a("el-select",{attrs:{placeholder:"请选择",multiple:""},model:{value:t.Product.CalibrationTechniques2,callback:function(e){t.$set(t.Product,"CalibrationTechniques2",e)},expression:"Product.CalibrationTechniques2"}},t._l(t.options,function(t){return a("el-option",{key:t.ValueStr1,attrs:{label:t.ValueStr1,value:t.ValueStr1}})}),1)],1),t._v(" "),a("div",{staticClass:"From"},[a("span",[t._v("计量台账(测量器具清单)")]),t._v(" "),a("el-table",{staticStyle:{width:"calc(100% - 400px)","margin-top":"15px",float:"left"},attrs:{data:t.tableData,size:"mini"}},[a("el-table-column",{attrs:{prop:"ProductCode",label:"名称/编号",width:"170"}}),t._v(" "),a("el-table-column",{attrs:{label:"测量范围",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("p",{domProps:{innerHTML:t._s(e.row.BarcodeMemo)}})]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"准确度等级",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("p",{domProps:{innerHTML:t._s(e.row.Unit)}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"Characteristics",label:"证书编号",width:"160"}}),t._v(" "),a("el-table-column",{attrs:{prop:"MaintainContent",label:"证书有效期",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Barcode",label:"上级溯源机构名称","show-overflow-tooltip":!0}}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("saxo-button",{attrs:{type:"danger",mini:""},on:{click:function(a){return t.deleteRow(e.row)}}},[t._v("删除")])]}}])})],1),t._v(" "),a("saxo-button",{staticStyle:{"margin-top":"15px","margin-left":"15px",float:"left"},attrs:{type:"success",mini:""},on:{click:function(e){t.drawerShow=!0}}},[t._v("添加")])],1),t._v(" "),a("SaxoDrawer",{attrs:{show:t.drawerShow,title:"计量台账"},on:{ShowFalse:t.ShowFalse}},[a("div",{staticClass:"drawerShowBox"},[a("div",{staticClass:"retrieve"},[a("div",{staticClass:"ConView"},[a("div",{staticClass:"department"},[a("span",[t._v("名称/编号")]),t._v(" "),a("el-input",{attrs:{placeholder:"名称/编号",size:"mini"},model:{value:t.retrieval.productCode,callback:function(e){t.$set(t.retrieval,"productCode",e)},expression:"retrieval.productCode"}})],1),t._v(" "),a("div",{staticClass:"department"},[a("span",[t._v("测量范围")]),t._v(" "),a("el-input",{attrs:{placeholder:"测量范围",size:"mini"},model:{value:t.retrieval.barcodeMemo,callback:function(e){t.$set(t.retrieval,"barcodeMemo",e)},expression:"retrieval.barcodeMemo"}})],1)])]),t._v(" "),a("div",{staticClass:"content2"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.Data,"header-cell-style":t.$store.state.headerCellStyle,"cell-style":t.$store.state.cellStyle,stripe:"",height:"100%"}},[a("el-table-column",{attrs:{prop:"ProductCode",label:"名称/编号",width:"170"}}),t._v(" "),a("el-table-column",{attrs:{label:"测量范围",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("p",{domProps:{innerHTML:t._s(e.row.BarcodeMemo)}})]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"准确度等级",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("p",{domProps:{innerHTML:t._s(e.row.Unit)}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"Characteristics",label:"证书编号",width:"160"}}),t._v(" "),a("el-table-column",{attrs:{prop:"MaintainContent",label:"证书有效期",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Barcode",label:"上级溯源机构名称","show-overflow-tooltip":!0}}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("saxo-button",{attrs:{type:"primary",mini:""},on:{click:function(a){return t.edit(e.row)}}},[t._v("添加")])]}}])})],1)],1),t._v(" "),a("SaxoFenYe",{ref:"SaxoFenYe",attrs:{total:t.total},on:{func:t.func}})],1)])]},proxy:!0}])})},staticRenderFns:[]};var i=a("VU/8")(s,n,!1,function(t){a("dzac")},"data-v-6a6a35f7",null);e.default=i.exports},dzac:function(t,e){}});