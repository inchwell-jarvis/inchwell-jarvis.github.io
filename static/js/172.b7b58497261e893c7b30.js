webpackJsonp([172],{"+R8W":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a("mvHQ"),i=a.n(o),s={name:"",data:function(){return{iframeData:{width:"100%",height:"99%",https:"./index.html",http:""},ToolObjectId:"",ToolProId:"",GetAllAll:[],options:[],timer:"",labelPosition:"right",formLabelAlign:{Name:"",Email:"",Tel:"",LinkManId:"",Address:"",Default:"",Mobile:"",NameEn:""},tableData:[],loading:!1,Addindex:0,GoodsInfo:[],rightPX:0}},created:function(){this.GetAllAllPartDrawing()},mounted:function(){var t=this;window.onmessage=function(e){"webpack"==String(e.data).substring(0,7)||"[object"==String(e.data).substring(0,7)||t.HTMLtoVue(e.data)}},components:{},methods:{ShowIS:function(){0==this.rightPX?this.rightPX="-780px":this.rightPX=0},adds:function(t){var e=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});console.log(t);t=JSON.parse(i()(t));this.$set(t,"Number",1),t.switch=!0,t.Describe=t.Manufacturer;for(var a=0;a<this.tableData.length;a++){var o=this.tableData[a];if(console.log(o.ProductCode==t.ProductCode),o.ProductCode==t.ProductCode)return o.Number+=1,e.close(),!1}this.tableData.push(t),e.close()},handleCurrentChange:function(t){this.pageNum=t,this.initss()},handleSizeChange:function(t){this.pagesize=t,this.initss()},initss:function(t){var e=this;1==t&&(this.pageNum=1);var a={api:"get",url:this.$store.state.http+"Product/GetProducts2",data:{pageNum:this.pageNum,numPerPage:this.pagesize,orderField:"",orderDirection:"",proType:"1",productCode:this.productCode,barcodeMemo:this.barcodeMemo,man:this.man,desc:this.desc,memo:this.memo}};this.$https(a).then(function(t){console.log(t.Data),e.total=t.Data.DataBars,e.Data=t.Data.Dtos;for(var a=0;a<e.Data.length;a++)e.Data[a].UpdateDate=e.Data[a].UpdateDate.split("T")[0];console.log(e.Data)})},handleClose:function(t){this.$confirm("确认关闭？").then(function(e){t()}).catch(function(t){})},Trues:function(){if(console.log(this.ToolProId),console.log(this.formLabelAlign),console.log(this.tableData),this.GoodsInfo=[],0==this.tableData.length)return this.$message({showClose:!0,message:"请选择零件！",type:"warning"}),!1;for(var t=0;t<this.tableData.length;t++){var e=this.tableData[t],a={};a.ProductId=e.ProductId,a.Number=e.Number,a.IsAssembly=e.switch,this.GoodsInfo.push(a)}console.log(this.GoodsInfo),this.loading=!0,this.AddOne()},AddOne:function(){this.Addindex==this.GoodsInfo.length?(this.loading=!1,this.$emit("refresh"),this.$router.push({path:"/EditOrder"})):this.AddTwo()},AddTwo:function(){var t=this,e={api:"post",url:this.$store.state.http+"SO/AddSoGood",data:{SOId:this.$store.state.Vuex.SOId,ProductId:this.GoodsInfo[this.Addindex].ProductId,Number:this.GoodsInfo[this.Addindex].Number,IsAssembly:this.GoodsInfo[this.Addindex].IsAssembly}};this.$https(e).then(function(e){t.Addindex+=1,t.AddOne()})},HTMLtoVue:function(t){var e=this;console.log(t);var a={data:{productCodce:t.replace(/^\s+|\s+$/g,"")},api:"get",url:this.$store.state.http+"Product/GetProductMini",header:this.$store.state.token};this.$https(a).then(function(t){t.Data.Number=1,t.Data.switch=!0;for(var a=0;a<e.tableData.length;a++){var o=e.tableData[a];if(o.ProductCode==t.Data.ProductCode)return o.Number+=1,!1}e.$confirm("<p> 描述： "+t.Data.Describe+"</p> <br/>  <p>编号: "+t.Data.ProductCode+"</p>","是否添加?",{confirmButtonText:"确定",cancelButtonText:"取消",dangerouslyUseHTMLString:!0}).then(function(){e.tableData.push(t.Data)}).catch(function(){}),console.log(t.Data)})},deleteRow:function(t){console.log(t.ProductCode);for(var e=0;e<this.tableData.length;e++)this.tableData[e].ProductCode==t.ProductCode&&this.tableData.splice(e,1)},GetAllAllPartDrawing:function(){var t=this,e={data:{},api:"get",url:this.$store.state.http+"System/GetAllAllPartDrawing",header:this.$store.state.token};this.$https(e).then(function(e){for(var a=0;a<e.Data.length;a++){var o=e.Data[a];o.label=o.Valus,o.value=o.Key,o.children=o.TwoDtos;for(var i=0;i<o.children.length;i++){var s=o.children[i];s.label=s.Valus,s.children=s.ThreeDtos,s.value=s.Key;for(var n=0;n<s.children.length;n++){var l=s.children[n];l.label=l.Key,l.value=l.Valus}}}console.log(e.Data),t.options=e.Data})},handleChange:function(t){console.log(t[2]),this.iframeData.http=this.$store.state.httpData+"content/pcpartsdrawing/productView/"+t[2],console.log(this.iframeData.http)}}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"box_s",attrs:{"element-loading-text":"正在添加中"}},[a("div",{staticClass:"TopClickHandelSE"},[a("el-cascader",{staticStyle:{width:"100%"},attrs:{options:t.options,placeholder:"请选择零件图",props:{expandTrigger:"hover"},size:"mini"},on:{change:t.handleChange},model:{value:t.GetAllAll,callback:function(e){t.GetAllAll=e},expression:"GetAllAll"}})],1),t._v(" "),a("div",{staticClass:"ifarCo"},[a("iframe",{attrs:{scrolling:"no",width:t.iframeData.width,height:t.iframeData.height,src:t.iframeData.http,frameborder:"0"}})]),t._v(" "),a("div",{staticClass:"ifarRi",style:{right:t.rightPX}},[a("div",{staticClass:"arrow-left",on:{click:function(e){return t.ShowIS()}}},[0==t.rightPX?a("i",{staticClass:"el-icon-s-unfold"}):t._e(),t._v(" "),0!=t.rightPX?a("i",{staticClass:"el-icon-s-fold"}):t._e()]),t._v(" "),a("el-form",{ref:"formLabelAlign",staticStyle:{marginTop:"20px"},attrs:{"label-position":t.labelPosition,"status-icon":"","label-width":"80px",size:"mini",model:t.formLabelAlign}},[a("el-form-item",{attrs:{label:""}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,"max-height":"250",size:"mini"}},[a("el-table-column",{attrs:{fixed:"",prop:"Describe",label:"品牌","show-overflow-tooltip":!0,width:"200"}}),t._v(" "),a("el-table-column",{attrs:{fixed:"",prop:"ProductCode",label:"编码","show-overflow-tooltip":!0,width:"150"}}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"数量"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input-number",{attrs:{name:"Attributes",size:"mini","controls-position":"right",min:1},model:{value:e.row.Number,callback:function(a){t.$set(e.row,"Number",a)},expression:"scope.row.Number"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"甲方安装",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:e.row.switch,callback:function(a){t.$set(e.row,"switch",a)},expression:"scope.row.switch"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.deleteRow(e.row)}}},[t._v("移除")])]}}])})],1)],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.Trues()}}},[t._v("添加到当前订单")])],1)],1)],1)])},staticRenderFns:[]};var l=a("VU/8")(s,n,!1,function(t){a("3KDa")},"data-v-1872d59a",null);e.default=l.exports},"3KDa":function(t,e){}});