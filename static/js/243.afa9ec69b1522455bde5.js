webpackJsonp([243],{"Ei+4":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a("Dd8w"),r=a.n(l),i=a("mvHQ"),s=a.n(i),o=a("t4zo"),n=a.n(o),c=a("uXZL"),u=a.n(c),v={name:"",data:function(){return{options:[{label:"全部",value:"-1"},{label:"已创建",value:"1"},{label:"正在完善",value:"2"},{label:"完成",value:"3"}],PDstates:[{label:"高",value:"高"},{label:"中",value:"中"},{label:"低",value:"低"},{label:"完成",value:"完成"}],retrieval:{pageNum:1,numPerPage:this.$store.state.NewDisplayNumber,orderField:"",orderDirection:"",search:"",creater:"",state:"-1",area:"",all:1,cusType:"",priority:""},total:0,table_data:[],table_data_all:[]}},created:function(){this.start()},computed:{retrievalJT:function(){return s()(this.retrieval)}},watch:{retrievalJT:function(e,t){this.WatchFenYe(e,t)?this.$refs.SaxoFenYe.ReviseConNumber1():this.start()}},methods:{start:function(e){var t=this;this.API_GET("CRM/GetCusVisits",this.retrieval).then(function(e){console.log(e),t.total=e.DataBars,t.table_data=e.Dtos,t.table_data.forEach(function(e){e.BeginTime=e.BeginTime?e.BeginTime.split("T")[0]:"",e.EndTime=e.EndTime?e.EndTime.split("T")[0]:""})})},getTbaleDataAll:function(){var e=this;this.API_GET("CRM/GetCusVisits",r()({},this.retrieval,{numPerPage:999999})).then(function(t){console.log(t),e.total=t.DataBars,e.table_data_all=t.Dtos,e.table_data_all.forEach(function(e){e.BeginTime=e.BeginTime?e.BeginTime.split("T")[0]:"",e.EndTime=e.EndTime?e.EndTime.split("T")[0]:""});var a=e;setTimeout(function(){a.exportExcel()},500)})},msglook:function(e){this.$router.push({path:"/customer-visit-edit",query:{Id:e.Id}})},exportExcel:function(){var e=u.a.utils.table_to_book(document.querySelector("#out-table"),{raw:!0});console.log(e);var t=u.a.write(e,{bookType:"xlsx",bookSST:!0,type:"array"});try{n.a.saveAs(new Blob([t],{type:"application/octet-stream"}),"客户拜访.xlsx")}catch(e){"undefined"!=typeof console&&console.log(e,t)}return t},func:function(e,t){this.retrieval.numPerPage=e,this.retrieval.pageNum=t,this.start()}}},p={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"box"},[a("router-view"),e._v(" "),a("div",{staticClass:"retrieve"},[a("div",{staticClass:"leftSpan"},[e._v("\n            "+e._s(e.$route.meta.title)+"\n\n            "),a("i",{staticClass:"el-icon-takeaway-box",staticStyle:{cursor:"pointer"},on:{click:function(t){return e.getTbaleDataAll()}}})]),e._v(" "),a("div",{staticClass:"ConView"},[a("div",{staticClass:"department"},[a("span",[e._v("客户名称")]),e._v(" "),a("el-input",{attrs:{placeholder:"请输入客户名称",size:"mini"},model:{value:e.retrieval.search,callback:function(t){e.$set(e.retrieval,"search",t)},expression:"retrieval.search"}})],1),e._v(" "),a("div",{staticClass:"department"},[a("span",[e._v("发起人")]),e._v(" "),a("el-input",{attrs:{placeholder:"请输入发起人",size:"mini"},model:{value:e.retrieval.creater,callback:function(t){e.$set(e.retrieval,"creater",t)},expression:"retrieval.creater"}})],1),e._v(" "),a("div",{staticClass:"department"},[a("span",[e._v("区域")]),e._v(" "),a("el-select",{attrs:{size:"mini",clearable:"",placeholder:"请选择区域"},model:{value:e.retrieval.area,callback:function(t){e.$set(e.retrieval,"area",t)},expression:"retrieval.area"}},e._l(e.$store.state.Vuex.Area,function(e){return a("el-option",{key:e.Value,attrs:{label:e.Value,value:e.Value}})}),1)],1),e._v(" "),a("div",{staticClass:"department"},[a("span",[e._v("客户类型")]),e._v(" "),a("el-select",{attrs:{placeholder:"请选择客户类型",size:"mini",clearable:""},model:{value:e.retrieval.cusType,callback:function(t){e.$set(e.retrieval,"cusType",t)},expression:"retrieval.cusType"}},e._l(e.$store.state.CustomerType,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("div",{staticClass:"department"},[a("span",[e._v("选择状态")]),e._v(" "),a("el-select",{attrs:{placeholder:"请选择状态",size:"mini"},model:{value:e.retrieval.state,callback:function(t){e.$set(e.retrieval,"state",t)},expression:"retrieval.state"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("div",{staticClass:"department"},[a("span",[e._v("优先级")]),e._v(" "),a("el-select",{attrs:{placeholder:"请选择状态",size:"mini"},model:{value:e.retrieval.PDstate,callback:function(t){e.$set(e.retrieval,"PDstate",t)},expression:"retrieval.PDstate"}},e._l(e.PDstates,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)]),e._v(" "),a("saxo-button",{staticStyle:{float:"right","margin-top":"13px"},attrs:{mini:"",type:"primary"},on:{click:function(t){return e.start()}}},[e._v("搜 索")])],1),e._v(" "),a("div",{staticClass:"content2"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.table_data,"header-cell-style":e.$store.state.headerCellStyle,"cell-style":e.$store.state.cellStyle,stripe:"",height:"100%"}},[a("el-table-column",{attrs:{fixed:"",prop:"CusFullName","show-overflow-tooltip":!0,label:"客户名称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"VisiterName",width:"100",label:"发起人"}}),e._v(" "),a("el-table-column",{attrs:{prop:"BeginTime",width:"100",label:"开始时间"}}),e._v(" "),a("el-table-column",{attrs:{prop:"EndTime",width:"100",label:"结束时间"}}),e._v(" "),a("el-table-column",{attrs:{prop:"Area",width:"100",label:"区域"}}),e._v(" "),a("el-table-column",{attrs:{prop:"StateStr",width:"100",label:"当前状态"}}),e._v(" "),a("el-table-column",{attrs:{prop:"Priority",width:"100",label:"优先级"}}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",width:"100",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("saxo-button",{attrs:{mini:""},on:{click:function(a){return e.msglook(t.row)}}},[e._v("查看")])]}}])})],1)],1),e._v(" "),a("div",{staticClass:"table",staticStyle:{display:"none"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{size:"mini",data:e.table_data_all,"highlight-current-row":"",height:this.$store.state.TableOptimumHeight,border:"",id:"out-table","header-cell-style":{background:"#e1e1e1"}}},[a("el-table-column",{attrs:{prop:"CusFullName","show-overflow-tooltip":!0,label:"客户名称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"VisiterName",width:"100",label:"发起人"}}),e._v(" "),a("el-table-column",{attrs:{prop:"BeginTime",width:"100",label:"开始时间"}}),e._v(" "),a("el-table-column",{attrs:{prop:"EndTime",width:"100",label:"结束时间"}}),e._v(" "),a("el-table-column",{attrs:{prop:"Area",width:"100",label:"区域"}}),e._v(" "),a("el-table-column",{attrs:{prop:"StateStr",width:"100",label:"当前状态"}}),e._v(" "),a("el-table-column",{attrs:{prop:"Priority",width:"100",label:"优先级"}}),e._v(" "),a("el-table-column",{attrs:{prop:"OutputValue",width:"100",label:"售后产值"}}),e._v(" "),a("el-table-column",{attrs:{prop:"AffiliatedGroup",width:"100",label:"隶属集团"}}),e._v(" "),a("el-table-column",{attrs:{prop:"BuildYear",width:"100",label:"建店年份"}}),e._v(" "),a("el-table-column",{attrs:{prop:"EquOverview",width:"100",label:"设备概述"}}),e._v(" "),a("el-table-column",{attrs:{prop:"ApprovalProcess",width:"100",label:"审批流程"}}),e._v(" "),a("el-table-column",{attrs:{prop:"FinancialBudget",width:"100",label:"财务预算"}}),e._v(" "),a("el-table-column",{attrs:{prop:"OtherInfo",width:"100",label:"其它信息"}})],1)],1),e._v(" "),a("SaxoFenYe",{ref:"SaxoFenYe",attrs:{total:e.total},on:{func:e.func}})],1)},staticRenderFns:[]},d=a("VU/8")(v,p,!1,null,null,null);t.default=d.exports}});