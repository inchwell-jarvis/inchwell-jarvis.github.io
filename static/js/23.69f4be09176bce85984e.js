webpackJsonp([23],{QFSf:function(t,e){},SiD5:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s={name:"ComUpLoad",data:function(){return{imgData:"",imgArr:this.$store.state.imgArr,imgSrc:"",allowAddImg:!0}},methods:{changeImg:function(t){console.log(t.target.files);var e=this;e.$store.state.imgArr=[];var i=t.target.files,s=new Image;if(i.length>0)var a=0,o=setInterval(function(){if("image/png"!=i.item(a).type&&"image/jpeg"!=i.item(a).type&&"image/gif"!=i.item(a).type)return!1;i.item(a).size>104857600||(s.src=window.URL.createObjectURL(i.item(a)),s.onload=function(){var t=s.width,i=s.height,a=t/i;i=(t=200)/a;var o=document.createElement("canvas"),l=o.getContext("2d"),n=document.createAttribute("width");n.nodeValue=t;var r=document.createAttribute("height");r.nodeValue=i,o.setAttributeNode(n),o.setAttributeNode(r),l.drawImage(s,0,0,t,i);var c=s.src.substring(s.src.lastIndexOf(".")).toLowerCase(),d=o.toDataURL("image/"+c,.7);e.$store.state.Tool_data_imageBase64=d,e.$store.state.imgArr.length<=1e3&&(console.log(d),e.$store.state.imgArr.push(d))}),a<i.length-1?a++:(clearInterval(o),e.$emit("parentFunction",e.$store.state.imgArr),setTimeout(function(){},1e3))},10)},deleteImg:function(t){_this.$store.state.imgArr.splice(t,1),_this.$store.state.imgArr.length<5&&(this.allowAddImg=!0)}}},a={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"com-upload-img"},[i("div",{staticClass:"img_group"},[t.allowAddImg?i("div",{staticClass:"img_box"},[t._l(this.$store.state.imgArr,function(e,s){return i("div",{key:s,staticClass:"img_box"},[i("div",{staticClass:"img_show_box"},[i("img",{attrs:{src:e,alt:""}}),t._v(" "),i("i",{staticClass:"img_delete",on:{click:function(e){return t.deleteImg(s)}}})])])}),t._v(" "),i("a",{staticClass:"a-upload",attrs:{href:"javascript:;"}},[i("input",{attrs:{type:"file",accept:".png,.jpg,.jpeg",name:"",id:""},on:{change:function(e){return t.changeImg(e)}}}),t._v("点击这里上传文件\n        ")])],2):t._e()])])},staticRenderFns:[]};var o={components:{upimg:i("VU/8")(s,a,!1,function(t){i("qIiv")},"data-v-7c53869e",null).exports},data:function(){return{orderField:"",ProductCodeDetail:"",search:"",select:!0,pageNum:1,options:[{label:"可用",value:!0,index:1},{label:"不可用",value:!1,index:2}],optionsR:[{label:"电子设备",value:"电子设备",index:1},{label:"机械设备",value:"机械设备",index:2}],optionsRtext:"电子设备",radio:"1",dialogTableVisible:!1,ProductCode:"",ProductDesc:"",Unit:"",UnitPrice:"",ToolLabel:"",Enable:!0,data:[],Data:[],total:0,pagesize:10,edits:{},editsindex:!1,fileList:[]}},created:function(){this.pagesize=this.$store.state.DisplayNumber,this.initda()},methods:{addbsList:function(){this.$router.push({path:"/bulk-add-tool-data"})},Bai:function(){console.log(this.search,this.select),this.pageNum=1,this.initda()},initda:function(){var t=this,e={data:{search:this.search,enable:this.select,pageNum:this.pageNum,numPerPage:this.pagesize,orderField:"",orderDirection:""},api:"get",url:this.$store.state.http+"CusTool/GetCusTools",header:this.$store.state.token};this.$https(e).then(function(e){console.log(e.Data),t.data=e.Data.Dtos,t.total=e.Data.DataBars})},addbs:function(){this.$refs.success.start(),this.editsindex=!1},addtrue:function(){var t=this;if(console.log(this.$store.state.Tool_data_imageBase64),this.editsindex){var e={data:{ID:this.edits.ID,ProductCodeDetail:this.ProductCodeDetail,ProductCode:this.ProductCode,ProductDesc:this.ProductDesc,Unit:this.Unit,UnitPrice:this.UnitPrice,ToolLabel:this.ToolLabel,Enable:this.Enable},api:"post",url:this.$store.state.http+"CusTool/UpdateCusTool",header:this.$store.state.token};return this.$https(e).then(function(e){""==t.$store.state.Tool_data_imageBase64?(t.dialogTableVisible=!1,t.deleteadddata(),t.initda()):t.upimgData(e.Data)}),!1}if(console.log(this.optionsRtext),""==this.optionsRtext||""==this.ProductCode||""==this.ProductDesc||""==this.Unit||""==this.ProductCodeDetail)return alert("请输入完整"),!1;var i=!1;"2"==this.radio&&(i=!0);e={data:{AssetsType:this.optionsRtext,Calibration:i,ProductCodeDetail:this.ProductCodeDetail,ProductCode:this.ProductCode,ProductDesc:this.ProductDesc,Unit:this.Unit,UnitPrice:this.UnitPrice,ToolLabel:this.ToolLabel,Enable:this.Enable},api:"post",url:this.$store.state.http+"CusTool/AddCusTool",header:this.$store.state.token};this.$https(e).then(function(e){t.upimgData(e.Data)})},upimgData:function(t){var e=this,i={data:{Id:t,FileStr:this.$store.state.Tool_data_imageBase64},api:"post",url:this.$store.state.http+"CusTool/UploadToolProPhoto",header:this.$store.state.token};this.$https(i).then(function(t){e.dialogTableVisible=!1,e.deleteadddata(),e.initda()})},handleClose:function(t){var e=this;this.$confirm("确认关闭？").then(function(i){t(),e.deleteadddata()}).catch(function(t){})},deleteadddata:function(){this.ProductCode="",this.ProductDesc="",this.Unit="",this.UnitPrice="",this.ToolLabel="",this.ProductCodeDetail="",this.$store.state.imgArr=[],this.$store.state.Tool_data_imageBase64="",this.$refs.success.start()},switchs:function(t){var e=this;console.log(t);var i={data:{Id:t.ID},api:"post",url:this.$store.state.http+"CusTool/SetCusTool",header:this.$store.state.token};this.$https(i).then(function(t){e.$message({showClose:!0,type:"success",message:"修改状态成功"})})},func:function(t,e){this.pagesize=t,this.pageNum=e,this.initda()},edit:function(t){this.$store.state.imgArr=[],null!=t.ImageUrl&&(this.$store.state.imgArr[0]=this.$store.state.Filehttp+"CusTool/"+t.ImageUrl),console.log(t),this.edits=t,this.ProductCodeDetail=t.ProductCodeDetail,this.ProductCode=t.ProductCode,this.ProductDesc=t.ProductDesc,this.Unit=t.Unit,this.UnitPrice=t.UnitPrice,this.ToolLabel=t.ToolLabel,this.Enable=t.Enable,this.editsindex=!0,this.$refs.success.start()},dialogTableVisiblefalse:function(){this.$refs.success.start(),this.deleteadddata()},sele:function(){console.log(this.select),this.initda()}}},l={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"box"},[i("router-view"),t._v(" "),i("div",{staticClass:"TopSerch"},[i("el-input",{staticStyle:{width:"193px"},attrs:{size:"mini",placeholder:"请输入内容"},on:{change:function(e){return t.Bai()}},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),t._v(" "),i("el-select",{staticStyle:{width:"100px"},attrs:{size:"mini",placeholder:"请选择"},on:{change:function(e){return t.sele()}},model:{value:t.select,callback:function(e){t.select=e},expression:"select"}},t._l(t.options,function(t){return i("el-option",{key:t.index,attrs:{label:t.label,value:t.value}})}),1),t._v(" "),i("el-button",{attrs:{type:"primary",loading:this.$store.state.Vuex.loading,size:"mini"},on:{click:function(e){return t.Bai()}}},[t._v("检索")]),t._v(" "),i("el-button",{staticStyle:{float:"right"},attrs:{type:"success",size:"mini"},on:{click:function(e){return t.addbsList()}}},[t._v("批量添加")]),t._v(" "),i("el-button",{staticStyle:{float:"right"},attrs:{type:"success",size:"mini"},on:{click:function(e){return t.addbs()}}},[t._v("添加")]),t._v(" "),i("saxo-pop",{ref:"success",attrs:{type:"success",title:"添加工具",width:"800px"},on:{close:function(e){return t.$refs.success.start()}}},[i("div",{staticClass:"dial",staticStyle:{width:"100%",height:"350px"}},[i("div",{staticClass:"li"},[i("el-select",{staticStyle:{width:"100px",marginRight:"50px"},attrs:{size:"mini",placeholder:"请选择"},model:{value:t.optionsRtext,callback:function(e){t.optionsRtext=e},expression:"optionsRtext"}},t._l(t.optionsR,function(t){return i("el-option",{key:t.index,attrs:{label:t.label,value:t.value}})}),1),t._v(" "),i("el-radio",{attrs:{label:"1"},model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}},[t._v("不需要校准")]),t._v(" "),i("el-radio",{attrs:{label:"2"},model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}},[t._v("需要校准")])],1),t._v(" "),i("div",{staticClass:"li"},[i("el-input",{attrs:{placeholder:"请输入厂商提供的简短编码",size:"mini"},model:{value:t.ProductCode,callback:function(e){t.ProductCode=e},expression:"ProductCode"}},[i("template",{slot:"prepend"},[t._v("工具编号")])],2)],1),t._v(" "),i("div",{staticClass:"li"},[i("el-input",{attrs:{placeholder:"例如以VAS、000721、T 开头的厂商提供的编码",size:"mini"},model:{value:t.ProductCodeDetail,callback:function(e){t.ProductCodeDetail=e},expression:"ProductCodeDetail"}},[i("template",{slot:"prepend"},[t._v("详细编码")])],2)],1),t._v(" "),i("div",{staticClass:"li"},[i("el-input",{attrs:{placeholder:"请输入工具描述",size:"mini"},model:{value:t.ProductDesc,callback:function(e){t.ProductDesc=e},expression:"ProductDesc"}},[i("template",{slot:"prepend"},[t._v("工具描述")])],2)],1),t._v(" "),i("div",{staticClass:"li"},[i("el-input",{attrs:{placeholder:"请输入销售单价 （非必填）",size:"mini"},model:{value:t.UnitPrice,callback:function(e){t.UnitPrice=e},expression:"UnitPrice"}},[i("template",{slot:"prepend"},[t._v("销售单价")])],2)],1),t._v(" "),i("div",{staticClass:"li"},[i("el-input",{attrs:{placeholder:"请输入单位",size:"mini"},model:{value:t.Unit,callback:function(e){t.Unit=e},expression:"Unit"}},[i("template",{slot:"prepend"},[t._v("单  位")])],2)],1),t._v(" "),i("div",{staticClass:"li"},[i("el-input",{attrs:{placeholder:"请输入标签 （非必填）",size:"mini"},model:{value:t.ToolLabel,callback:function(e){t.ToolLabel=e},expression:"ToolLabel"}},[i("template",{slot:"prepend"},[t._v("标  签")])],2)],1),t._v(" "),i("upimg")],1),t._v(" "),i("div",{staticStyle:{width:"100%","text-align":"right"}},[i("el-button",{attrs:{size:"mini"},on:{click:function(e){t.dialogTableVisiblefalse(),t.$refs.success.start()}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(e){return t.addtrue()}}},[t._v("确 定")])],1)])],1),t._v(" "),i("div",{staticClass:"content"},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.data,size:"mini",height:this.$store.state.TableOptimumHeight,"highlight-current-row":"",border:"","header-cell-style":{background:"#e1e1e1"}}},[i("el-table-column",{attrs:{fixed:"",prop:"ProductCode",label:"工具编号",sortable:"",width:"150"}}),t._v(" "),i("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"ProductCodeDetail",width:"200",label:"详细编码"}}),t._v(" "),i("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"ProductDesc",label:"工具描述"}}),t._v(" "),i("el-table-column",{attrs:{prop:"Unit",label:"单位",width:"120"}}),t._v(" "),i("el-table-column",{attrs:{prop:"UnitPrice",label:"销售单价",width:"120"}}),t._v(" "),i("el-table-column",{attrs:{prop:"ToolLabel",label:"标签",width:"120"}}),t._v(" "),i("el-table-column",{attrs:{fixed:"right",label:"可用状态",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button-group",[i("el-switch",{staticClass:"an",attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:function(i){return t.switchs(e.row)}},model:{value:e.row.Enable,callback:function(i){t.$set(e.row,"Enable",i)},expression:"scope.row.Enable"}})],1)]}}])}),t._v(" "),i("el-table-column",{attrs:{fixed:"right",label:"操作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button-group",[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(i){return t.edit(e.row)}}},[t._v("编辑")])],1)]}}])})],1)],1),t._v(" "),i("SaxoFenYe",{attrs:{total:t.total},on:{func:t.func}})],1)},staticRenderFns:[]};var n=i("VU/8")(o,l,!1,function(t){i("QFSf")},"data-v-59a06e50",null);e.default=n.exports},qIiv:function(t,e){}});