webpackJsonp([159],{L6sO:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("mvHQ"),l=a.n(n),o=a("t4zo"),s=a.n(o),r=a("uXZL"),i=a.n(r),u={data:function(){return{ReturnClientFunds:!1,returnhttpData:{},returnData:{},options:[{value:-1,label:"全部"},{value:9,label:"可用资金"},{value:1,label:"未认领"},{value:2,label:"部分认领"},{value:3,label:"全部认领"}],options2:[{value:"",label:"全部"},{value:"服务公司",label:"服务公司"},{value:"技术公司",label:"技术公司"}],tableData:[],tableData2:[],total:0,search:"",state:9,pageNum:1,numPerPage:0,belong:"",billingTime:"",dialogVisible:!1,acknowledgeDataRow:{},acknowledgeData:{Str:"",Other:"",id:""}}},methods:{deleteAmount:function(t){var e=this;this.$confirm("此操作将永久删除该笔资金, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.API_POST("CRM/DelCusCapital",{Id:t.ID}).then(function(t){e.$message.success("删除成功!"),e.start()})}).catch(function(){e.$message.info("已取消删除!")})},returnDataFun:function(t){var e=this;if(t){if(""==this.returnhttpData.Str)return this.$message({showClose:!0,message:"请输入金额!",type:"warning"}),!1;this.API_POST("CRM/CusCapitalRetrace",this.returnhttpData).then(function(t){e.$message.success("申请退款成功!"),e.returnDataFun(!1),e.start()})}else this.ReturnClientFunds=!1,this.returnhttpData={Str:"",Other:"",id:""}},restitution:function(t){console.log(t),this.returnData=JSON.parse(l()(t)),this.returnhttpData={Str:"",Other:"",id:t.ID},this.ReturnClientFunds=!0},acknowledgebut:function(t){var e=this;if(t){if(""==this.acknowledgeData.Str)return this.$message({showClose:!0,message:"请输入金额!",type:"warning"}),!1;if(""==this.acknowledgeData.Other)return this.$message({showClose:!0,message:"请输入合同号",type:"warning"}),!1;this.API_POST("Finance/FinanceClaim",this.acknowledgeData).then(function(t){e.$message({showClose:!0,message:"认领成功!",type:"success"}),e.acknowledgebut(!1),e.start()})}else this.dialogVisible=!1,this.acknowledgeData={Str:"",Other:"",id:""}},acknowledge:function(t){console.log(t),this.acknowledgeDataRow=t,this.acknowledgeData.id=t.ID,this.dialogVisible=!0},history:function(){this.$router.push({path:"/CustomerFundsHistory"})},AddCusCapital:function(){this.$router.push({path:"/CreateGetCusCapitalPools"})},start:function(){var t=this,e={data:{search:this.search,state:this.state,pageNum:this.pageNum,numPerPage:this.numPerPage,belong:this.belong,begin:null!=this.billingTime?this.billingTime[0]:"",end:null!=this.billingTime?this.billingTime[1]:"",orderField:"",orderDirection:""},api:"get",url:this.$store.state.http+"CRM/GetCusCapitalPools"};this.$https(e).then(function(e){console.log(e),t.tableData=e.Data.Dtos,t.total=e.Data.DataBars;for(var a=0;a<t.tableData.length;a++){var n=t.tableData[a];n.CreateDate=n.CreateDate.split("T")[0],""!=n.SystemInfo&&null!=n.SystemInfo?n.SystemInfo2=n.SystemInfo.split("@"):n.SystemInfo2=[]}})},start2:function(){var t=this,e={data:{search:this.search,state:this.state,pageNum:1,numPerPage:999999999,belong:this.belong,begin:null!=this.billingTime?this.billingTime[0]:"",end:null!=this.billingTime?this.billingTime[1]:"",orderField:"",orderDirection:""},api:"get",url:this.$store.state.http+"CRM/GetCusCapitalPools"};this.$https(e).then(function(e){t.tableData2=e.Data.Dtos;for(var a=0;a<t.tableData.length;a++){var n=t.tableData[a];n.CreateDate=n.CreateDate.split("T")[0],""!=n.SystemInfo&&null!=n.SystemInfo?n.SystemInfo2=n.SystemInfo.split("@"):n.SystemInfo2=[]}var l=t;setTimeout(function(){l.exportExcel()},2e3)})},SaxoFenYe:function(t,e){this.numPerPage=t,this.pageNum=e,this.start()},exportExcel:function(){var t=i.a.utils.table_to_book(document.querySelector("#out-table"),{raw:!0});console.log(t);var e=i.a.write(t,{bookType:"xlsx",bookSST:!0,type:"array"});try{s.a.saveAs(new Blob([e],{type:"application/octet-stream"}),"客户资金.xlsx")}catch(t){"undefined"!=typeof console&&console.log(t,e)}return e}},created:function(){this.numPerPage=this.$store.state.NewDisplayNumber,this.start()},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},c={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"box"},[a("router-view",{on:{refresh:t.start}}),t._v(" "),a("div",{staticClass:"retrieve"},[a("div",{staticClass:"leftSpan"},[t._v("\n            客户资金\n            "),a("i",{staticClass:"el-icon-date",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.history()}}}),t._v(" "),a("i",{staticClass:"el-icon-printer",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.start2()}}})]),t._v(" "),a("div",{staticClass:"ConView",staticStyle:{width:"calc(100% - 400px)"}},[a("div",{staticClass:"department"},[a("span",[t._v("客户名称")]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入客户名称",size:"mini"},on:{input:function(e){return t.start()}},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),t._v(" "),a("div",{staticClass:"department"},[a("span",[t._v("状态")]),t._v(" "),a("el-select",{attrs:{placeholder:"请选择状态",size:"mini"},on:{change:function(e){return t.start()}},model:{value:t.state,callback:function(e){t.state=e},expression:"state"}},t._l(t.options,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),a("div",{staticClass:"department"},[a("span",[t._v("隶属公司")]),t._v(" "),a("el-select",{attrs:{placeholder:"请选择状态",size:"mini"},on:{change:function(e){return t.start()}},model:{value:t.belong,callback:function(e){t.belong=e},expression:"belong"}},t._l(t.options2,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),a("div",{staticClass:"department",staticStyle:{width:"500px"}},[a("span",[t._v("开始/结束")]),t._v(" "),a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",size:"mini",type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:function(e){return t.start()}},model:{value:t.billingTime,callback:function(e){t.billingTime=e},expression:"billingTime"}})],1)]),t._v(" "),a("saxo-button",{staticStyle:{float:"right","margin-top":"13px","margin-left":"5px"},attrs:{mini:"",type:"success"},on:{click:function(e){return t.AddCusCapital()}}},[t._v("创 建")])],1),t._v(" "),a("div",{staticClass:"content2"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,"header-cell-style":t.$store.state.headerCellStyle,"cell-style":t.$store.state.cellStyle,stripe:"",height:"100%"}},[a("el-table-column",{attrs:{prop:"BusinessLicenseName",label:"客户名称","show-overflow-tooltip":!0}}),t._v(" "),a("el-table-column",{attrs:{prop:"PayName",label:"付款名称","show-overflow-tooltip":!0}}),t._v(" "),a("el-table-column",{attrs:{prop:"Other",label:"隶属公司",width:"80"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Source",label:"来自",width:"80"}}),t._v(" "),a("el-table-column",{attrs:{label:"资金量",width:"110"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{float:"right"}},[t._v(" "+t._s(t.FinancialAmountFormat(e.row.Amount)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"使用量",width:"110"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{float:"right"}},[t._v(" "+t._s(t.FinancialAmountFormat(e.row.UsageAmount)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"剩余量",width:"110"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{float:"right"}},[t._v(" "+t._s(t.FinancialAmountFormat(e.row.Amount-e.row.UsageAmount)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"Creater",label:"创建人",width:"80"}}),t._v(" "),a("el-table-column",{attrs:{prop:"CreateDate",label:"创建时间",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"StateStr",label:"状态",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{label:"系统信息",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-popover",{attrs:{placement:"top-start",title:"系统信息",trigger:"hover"}},[t._l(e.row.SystemInfo2,function(e,n){return a("p",{key:n},[t._v(t._s(e))])}),t._v(" "),a("span",{attrs:{slot:"reference"},slot:"reference"},[t._v("系统信息"),a("i",{staticClass:"el-icon-warning-outline"})])],2)]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"Memo",label:"备注",width:"120","show-overflow-tooltip":!0}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"200",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("saxo-button",{attrs:{mini:"",type:"info"},on:{click:function(a){return t.restitution(e.row)}}},[t._v("退回")]),t._v(" "),a("saxo-button",{attrs:{mini:"",type:"primary"},on:{click:function(a){return t.acknowledge(e.row)}}},[t._v("认领")]),t._v(" "),"未使用"==e.row.StateStr?a("saxo-button",{attrs:{mini:"",type:"danger"},on:{click:function(a){return t.deleteAmount(e.row)}}},[t._v("删除")]):t._e()]}}])})],1),t._v(" "),a("el-table",{staticStyle:{width:"100%",display:"none"},attrs:{data:t.tableData2,"header-cell-style":t.$store.state.headerCellStyle,"cell-style":t.$store.state.cellStyle,stripe:"",height:"100%",id:"out-table"}},[a("el-table-column",{attrs:{prop:"BusinessLicenseName",label:"客户名称","show-overflow-tooltip":!0}}),t._v(" "),a("el-table-column",{attrs:{prop:"PayName",label:"付款名称","show-overflow-tooltip":!0}}),t._v(" "),a("el-table-column",{attrs:{prop:"Other",label:"隶属公司",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{label:"资金量",width:"130"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{float:"right"}},[t._v(" "+t._s(t.FinancialAmountFormat(e.row.Amount,"")))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"使用量",width:"130"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{float:"right"}},[t._v(" "+t._s(t.FinancialAmountFormat(e.row.UsageAmount,"")))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"剩余量",width:"130"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{float:"right"}},[t._v(" "+t._s(t.FinancialAmountFormat(e.row.Amount-e.row.UsageAmount,"")))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"Creater",label:"创建人",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"CreateDate",label:"创建时间",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"StateStr",label:"状态",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{label:"系统信息",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-popover",{attrs:{placement:"top-start",title:"系统信息",trigger:"hover"}},[t._l(e.row.SystemInfo2,function(e,n){return a("p",{key:n},[t._v(t._s(e))])}),t._v(" "),a("span",{attrs:{slot:"reference"},slot:"reference"},[t._v("系统信息"),a("i",{staticClass:"el-icon-warning-outline"})])],2)]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"Memo",label:"备注",width:"120","show-overflow-tooltip":!0}})],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"认领资金",visible:t.dialogVisible,width:"30%","append-to-body":!0},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-form",{attrs:{"label-width":"80px",model:t.acknowledgeData,size:"mini"}},[a("el-form-item",{attrs:{label:"名称"}},[a("span",{domProps:{textContent:t._s(t.acknowledgeDataRow.BusinessLicenseName)}})]),t._v(" "),a("el-form-item",{attrs:{label:"资金量"}},[a("span",{domProps:{textContent:t._s(t.FinancialAmountFormat(t.acknowledgeDataRow.Amount))}})]),t._v(" "),a("el-form-item",{attrs:{label:"剩余量"}},[a("span",{domProps:{textContent:t._s(t.FinancialAmountFormat(t.acknowledgeDataRow.Amount-t.acknowledgeDataRow.UsageAmount))}})]),t._v(" "),a("el-form-item",{attrs:{label:"金额"}},[a("el-input",{model:{value:t.acknowledgeData.Str,callback:function(e){t.$set(t.acknowledgeData,"Str",e)},expression:"acknowledgeData.Str"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"合同号"}},[a("el-input",{model:{value:t.acknowledgeData.Other,callback:function(e){t.$set(t.acknowledgeData,"Other",e)},expression:"acknowledgeData.Other"}})],1)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("saxo-button",{attrs:{mini:"",type:"default"},on:{click:function(e){return t.acknowledgebut(!1)}}},[t._v("取消")]),t._v(" "),a("saxo-button",{attrs:{mini:"",type:"primary"},on:{click:function(e){return t.acknowledgebut(!0)}}},[t._v("确认")])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"退回资金",visible:t.ReturnClientFunds,width:"30%","append-to-body":!0},on:{"update:visible":function(e){t.ReturnClientFunds=e}}},[a("el-form",{attrs:{"label-width":"80px",model:t.returnData,size:"mini"}},[a("el-form-item",{attrs:{label:"名称"}},[a("span",{domProps:{textContent:t._s(t.returnData.BusinessLicenseName)}})]),t._v(" "),a("el-form-item",{attrs:{label:"资金量"}},[a("span",{domProps:{textContent:t._s(t.FinancialAmountFormat(t.returnData.Amount))}})]),t._v(" "),a("el-form-item",{attrs:{label:"剩余量"}},[a("span",{domProps:{textContent:t._s(t.FinancialAmountFormat(t.returnData.Amount-t.returnData.UsageAmount))}})]),t._v(" "),a("el-form-item",{attrs:{label:"退回金额"}},[a("el-input",{model:{value:t.returnhttpData.Str,callback:function(e){t.$set(t.returnhttpData,"Str",e)},expression:"returnhttpData.Str"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:4}},model:{value:t.returnhttpData.Other,callback:function(e){t.$set(t.returnhttpData,"Other",e)},expression:"returnhttpData.Other"}})],1)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("saxo-button",{attrs:{mini:"",type:"default"},on:{click:function(e){return t.returnDataFun(!1)}}},[t._v("取消")]),t._v(" "),a("saxo-button",{attrs:{mini:"",type:"primary"},on:{click:function(e){return t.returnDataFun(!0)}}},[t._v("确认")])],1)],1),t._v(" "),a("SaxoFenYe",{attrs:{total:t.total},on:{func:t.SaxoFenYe}})],1)},staticRenderFns:[]};var p=a("VU/8")(u,c,!1,function(t){a("fi1E")},"data-v-262b6664",null);e.default=p.exports},fi1E:function(t,e){}});