webpackJsonp([181],{"0yfA":function(t,e){},"6W6h":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){console.log(t||"*");for(var e='style="border:1px solid #ccc;"',a="",n=0;n<t.data.length;n++){var i=t.data[n];a+="<tr>\n                        <td  "+e+">"+i.Key+"</td>\n                        <td  "+e+">"+i.Other+"</td>\n                        <td  "+e+">"+i.OtherDouble+"</td>\n                        <td  "+e+">"+i.Otherdec+"</td>\n                    </tr>"}var r='\n    <html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">\n\n        <head>\n            <meta charset="utf-8">\n        </head>\n\n        <body style=\'font-family: "Arial";\'>\n            <table>\n                <tr>\n                    <td  colspan=\'4\'  style="width:1200px;background:rgb(197,217,241);font-weight:bolder;text-align:center;line-height:50px;height:50px">'+t.name+"</td>\n                </tr>\n\n                <tr>\n                    <th  "+e+">姓名</th>\n                    <th  "+e+">合同号</th>\n                    <th  "+e+">折扣率</th>\n                    <th  "+e+">金额</th>\n                </tr>\n\n                "+a+"\n\n               \n            </table>\n        </body>\n    </html>",o=document.createElement("a");o.download=t.name+".xls",o.href="data:application/vnd.ms-excel;base64,"+window.btoa(unescape(encodeURIComponent(r))),document.body.appendChild(o),o.click(),document.body.removeChild(o)},i={data:function(){return{retrieval:{month:"",salerName:""},data:[],data2:[],seriesdata:[],monthName:"",monthData:[],monthColor:["#409EFF","#67C23A","#E6A23C","#F56C6C"],BigNumber:0}},created:function(){var t=new Date;this.retrieval.month=t.getFullYear()+"-"+(t.getMonth()+1),this.start()},mounted:function(){},computed:{},watch:{},methods:{Downloadpiechart:function(){n({name:this.retrieval.month+"个人销售额",data:this.data})},Downloadpiechart2:function(){n({name:this.retrieval.salerName+this.retrieval.month+"销售额",data:this.data2})},start:function(){var t=this;""!=this.retrieval.salerName&&this.GetPersonalMonthInformation({month:this.retrieval.month,name:this.retrieval.salerName});var e=this.retrieval;this.API_GET("Statistic/MSOOneMonthSalesVolumeStat",e).then(function(e){t.data=e.MSOOneMonthSalesVolumeDto,console.log(t.data),t.seriesdata=[],t.data.forEach(function(e){t.seriesdata.push({value:e.Otherdec,name:e.Key,month:t.retrieval.month,salerName:e.Key})}),t.drawLinerwo()})},drawLinerwo:function(){var t=this,e=t.$echarts.init(document.getElementById("myChart1"));e.setOption({title:{text:t.retrieval.month+" 个人销售额",x:"center"},color:["#cca272","#74608f","#d7a02b","#c8ba23","#9bca63","#fe8463","#fcce10","#FF0099","#d8a056","#909399","#67C23A","#F56C6C"],tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{orient:"vertical",left:"left",data:t.myChart1data},series:[{name:"标题!",type:"pie",radius:"55%",center:["50%","60%"],data:t.seriesdata,emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0}}}]}),e.on("click",function(e){console.log(e),t.retrieval.salerName=e.data.name,t.start()})},GetPersonalMonthInformation:function(t){var e=this,a={month:t.month,salerName:t.name};this.API_GET("Statistic/MSOOneMonthSalesVolumeStat",a).then(function(a){var n=e;n.monthName=t.name+" "+t.month.split("-")[0]+"年"+t.month.split("-")[1]+"月 销售信息",e.data2=a.MSOOneMonthSalesVolumeDto,n.monthData=[],console.log(e.data2);for(var i=function(t){var a=[];e.data2.forEach(function(e){Number(e.OtherDate.split("T")[0].split("-")[2])==t&&a.push(e),e.Otherdec>n.BigNumber&&(n.BigNumber=e.Otherdec)}),a.length&&n.monthData.push(a)},r=0;r<31;r++)i(r);console.log(n.monthData)})}},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"box_s"},[a("router-view",{on:{refresh:t.start}}),t._v(" "),a("div",{staticClass:"retrieve"},[a("div",{staticClass:"leftSpan"},[t._v("\n            个人销售额统计\n        ")]),t._v(" "),a("div",{staticClass:"ConView"},[a("div",{staticClass:"department"},[a("span",[t._v("月份")]),t._v(" "),a("el-date-picker",{attrs:{"value-format":"yyyy-MM",size:"mini",type:"month",placeholder:"选择月"},on:{change:function(e){return t.start()}},model:{value:t.retrieval.month,callback:function(e){t.$set(t.retrieval,"month",e)},expression:"retrieval.month"}})],1),t._v(" "),a("div",{staticClass:"department"},[a("span",[t._v("销售员")]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入销售员",size:"mini"},on:{change:function(e){return t.start()}},model:{value:t.retrieval.salerName,callback:function(e){t.$set(t.retrieval,"salerName",e)},expression:"retrieval.salerName"}})],1)])]),t._v(" "),a("div",{staticClass:"content2"},[a("div",{style:{width:"480px",height:"320px",float:"left",padding:"10px"},attrs:{id:"myChart1"}}),t._v(" "),a("div",{staticClass:"particularity"},[a("div",{staticClass:"title"},[t._v(t._s(t.monthName))]),t._v(" "),a("div",{staticClass:"Data"},t._l(t.monthData,function(e,n){return a("div",{key:n,staticClass:"item2022"},[a("div",{staticClass:"Time",style:{lineHeight:35*e.length+"px"}},[t._v(t._s(e[0].OtherDate.split("T")[0].split("-")[2])+" ")]),t._v(" "),a("div",{staticClass:"xian"},t._l(e,function(e,i){return a("div",{key:i,staticClass:"item_li"},[a("div",{staticClass:"item_li_li"},[a("div",{staticClass:"item_li_li_zhu1"},[a("span",[t._v(t._s(e.Other||"-")+" ")]),t._v(" "),a("span",[t._v(t._s(e.OtherDouble||"-")+" % ")]),t._v(" "),a("span",[t._v(t._s("¥"+e.Otherdec))])]),t._v(" "),a("div",{staticClass:"item_li_li_zhu",style:{width:e.Otherdec/t.BigNumber*100+"%",background:t.monthColor[n%4]}})])])}),0)])}),0)]),t._v(" "),a("div",{staticStyle:{width:"100%",float:"left"}},[a("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.Downloadpiechart()}}},[t._v("下载饼图")]),t._v(" "),a("br"),t._v(" "),a("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.Downloadpiechart2()}}},[t._v("下载柱状图")])],1)])],1)},staticRenderFns:[]};var o=a("VU/8")(i,r,!1,function(t){a("0yfA")},"data-v-12b170ca",null);e.default=o.exports}});