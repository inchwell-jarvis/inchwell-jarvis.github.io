webpackJsonp([70],{"4DZl":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("gRE1"),i=a.n(n),r=a("mvHQ"),l=a.n(r),o={data:function(){return{retrieval:{begin:"",end:"",appliedby:"",areaId:"",area:"",paybegin:"",payend:""},month:[],month2:[],total:{accommodation_fee:0,gas_fee:0,toll_fee:0,intercity_transfer_fee:0,installation_fee:0,meal_fee:0,expedition_allowance:0,qt_fee:0,hj:0},ValueData:[],seriesdata:[],download_summary:{}}},computed:{retrievalJT:function(){return l()(this.retrieval)}},watch:{retrievalJT:function(t,e){this.start()}},created:function(){var t=new Date;t.setFullYear(t.getFullYear(),0,1);var e=new Date;function a(t){return t.getFullYear()+"-"+("0"+(t.getMonth()+1)).slice(-2)+"-"+("0"+t.getDate()).slice(-2)}e.setDate(1),this.retrieval.begin=a(t),this.retrieval.end=a(e),this.month=[this.retrieval.begin,this.retrieval.end]},mounted:function(){},methods:{start:function(){var t=this;this.total={accommodation_fee:0,gas_fee:0,toll_fee:0,intercity_transfer_fee:0,installation_fee:0,meal_fee:0,expedition_allowance:0,qt_fee:0,hj:0},this.API_GET("Finance/GetRecStat",this.retrieval).then(function(e){t.data=e.map(function(t){return JSON.parse(t.Other)}),t.total={accommodation_fee:0,gas_fee:0,toll_fee:0,intercity_transfer_fee:0,installation_fee:0,meal_fee:0,expedition_allowance:0,qt_fee:0,hj:0},t.download_summary={},t.data.forEach(function(e){var a=e.data,n=a.reduce(function(t,e){return t+(Number(e.a4.value)||0)},0);t.total.accommodation_fee+=n;var i=a.reduce(function(t,e){return t+(Number(e.a11.value)||0)},0);t.total.gas_fee+=i;var r=a.reduce(function(t,e){return t+(Number(e.a9.value)||0)},0);t.total.toll_fee+=r;var l=a.reduce(function(t,e){return t+(Number(e.a8.value)||0)},0);l+=a.reduce(function(t,e){return t+(Number(e.a6.value)||0)},0),t.total.intercity_transfer_fee+=l;var o=a.reduce(function(t,e){return t+(Number(e.a14.value)||0)},0);t.total.installation_fee+=o;var d=a.reduce(function(t,e){return t+(Number(e.a15.value)||0)},0);t.total.meal_fee+=d;var s=a.reduce(function(t,e){return t+(Number(e.a17.value)||0)},0);t.total.qt_fee+=s;var c=e.tripMealAmount;t.total.expedition_allowance+=c;var f=e.MeData.Name,u={name_time:e.MeData.Name+"-"+e.ReimbursementDate,accommodation_fee:n,gas_fee:i,toll_fee:r,intercity_transfer_fee:l,installation_fee:o,meal_fee:d,qt_fee:s,expedition_allowance:c};t.download_summary[f]?t.download_summary[f].push(u):t.download_summary[f]=[u]}),console.log(t.download_summary),t.total.hj=i()(t.total).reduce(function(t,e){return t+e},0),t.ValueData=[],t.ValueData=[t.total.accommodation_fee.toFixed(2),t.total.gas_fee.toFixed(2),t.total.toll_fee.toFixed(2),t.total.intercity_transfer_fee.toFixed(2),t.total.installation_fee.toFixed(2),t.total.meal_fee.toFixed(2),t.total.expedition_allowance.toFixed(2),t.total.qt_fee.toFixed(2)],t.seriesdata=[],t.seriesdata=[{value:t.total.accommodation_fee.toFixed(2),name:"住宿费"},{value:t.total.gas_fee.toFixed(2),name:"汽油费"},{value:t.total.toll_fee.toFixed(2),name:"过路费"},{value:t.total.intercity_transfer_fee.toFixed(2),name:"交通费"},{value:t.total.installation_fee.toFixed(2),name:"安装费"},{value:t.total.meal_fee.toFixed(2),name:"餐费"},{value:t.total.expedition_allowance.toFixed(2),name:"出差补助"},{value:t.total.qt_fee.toFixed(2),name:"其他"}],t.drawLine(),t.drawLinerwo()})},monthrange:function(t){t?(this.retrieval.begin=t[0],this.retrieval.end=t[1]):(this.retrieval.begin="",this.retrieval.end="")},monthrange2:function(t){t?(this.retrieval.paybegin=t[0],this.retrieval.payend=t[1]):(this.retrieval.paybegin="",this.retrieval.payend="")},changeArea:function(t){var e=this;this.$store.state.Vuex.Area.forEach(function(a){a.Id==t&&(console.log(a.Value),e.retrieval.area=a.Value)})},drawLine:function(){var t=this.$echarts.init(document.getElementById("myChart1"));t.setOption({color:["#3398DB"],xAxis:{type:"category",data:["住宿费","汽油费","过路费","交通费","安装费","餐费","出差补助","其他"]},yAxis:{type:"value"},title:{x:"center",text:"费用详情柱状图",subtextStyle:{color:"red"}},tooltip:{},series:[{data:this.ValueData,name:"",type:"bar",itemStyle:{normal:{color:function(t){return["#228bff","#32e068","#ffe222","#a96659","#ff7a4a","#ff4a77","#ff7d96","#aaffcc"][t.dataIndex]}},label:{show:!0,rotate:70,position:"top",distance:20,verticalAlign:"middle",textStyle:{color:"black",fontSize:12}}}}]}),t.on("click",function(t){console.log(t)})},drawLinerwo:function(){var t=this.$echarts.init(document.getElementById("myChart2"));t.off("click"),t.setOption({title:{text:"费用占比饼图",x:"center"},color:["#228bff","#32e068","#ffe222","#a96659","#ff7a4a","#ff4a77","#ff7d96","#aaffcc"],tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{orient:"vertical",left:"left",data:["住宿费","汽油费","过路费","交通费","安装费","餐费","出差补助","其他"]},series:[{name:"标题!",type:"pie",radius:"55%",center:["50%","60%"],data:this.seriesdata,emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0}}}]})},printer:function(){var t="";for(var e in this.download_summary){var a=this.download_summary[e];t+="\n                    <tr>\n                        <td>"+a[0].name_time.split("-")[0]+'</td>\n                        <td colspan="3"></td>\n                    </tr>\n                    ';for(var n=0;n<a.length;n++){t+="\n                        <tr>\n                            <td></td>\n                            <td>"+a[n].name_time+'</td>\n                            <td colspan="2"></td>\n                        </tr>\n                    ',t+="\n                        <tr>\n                            <td></td>\n                            <td></td>\n                            <td>住宿费</td>\n                            <td>"+this.total.accommodation_fee+"</td>\n                        </tr>\n                        <tr>\n                            <td></td>\n                            <td></td>\n                            <td>汽油费</td>\n                            <td>"+this.total.gas_fee+"</td>\n                        </tr>\n                        <tr>\n                            <td></td>\n                            <td></td>\n                            <td>过路费</td>\n                            <td>"+this.total.toll_fee+"</td>\n                        </tr>\n                        <tr>\n                            <td></td>\n                            <td></td>\n                            <td>交通费</td>\n                            <td>"+this.total.intercity_transfer_fee+"</td>\n                        </tr>\n                        <tr>\n                            <td></td>\n                            <td></td>\n                            <td>安装费</td>\n                            <td>"+this.total.installation_fee+"</td>\n                        </tr>\n                        <tr>\n                            <td></td>\n                            <td></td>\n                            <td>餐费</td>\n                            <td>"+this.total.meal_fee+"</td>\n                        </tr>\n                        <tr>\n                            <td></td>\n                            <td></td>\n                            <td>出差补助</td>\n                            <td>"+this.total.expedition_allowance+"</td>\n                        </tr>\n                        <tr>\n                            <td></td>\n                            <td></td>\n                            <td>其他</td>\n                            <td>"+this.total.qt_fee+"</td>\n                        </tr>\n                    "}}var i='\n               <tbody>\n                <tr>\n                    <td colspan="4"></td>\n                </tr>\n                <tr>\n                    <td colspan="2">申请人</td>\n                    <td colspan="2">'+this.retrieval.appliedby+'</td>\n                </tr>\n                <tr>\n                    <td colspan="2">报销月份</td>\n                    <td colspan="2">'+this.retrieval.begin+" - "+this.retrieval.end+'</td>\n                </tr>\n                <tr>\n                    <td colspan="2">区域</td>\n                    <td colspan="2">'+this.retrieval.area+'</td>\n                </tr>\n                <tr>\n                    <td colspan="2">支付时间</td>\n                    <td colspan="2">'+this.retrieval.paybegin+" - "+this.retrieval.payend+'</td>\n                </tr>\n                <tr>\n                    <td colspan="4"></td>\n                </tr>\n                '+t+"\n                \n               \n                </tbody>\n            ";this.downloadTable(i,"下载")}},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("SaxoPage",{scopedSlots:t._u([{key:"title",fn:function(){return[a("i",{staticClass:"el-icon-printer",staticStyle:{float:"left","font-size":"17px","margin-top":"22px","margin-left":"-125px",cursor:"pointer"},on:{click:t.printer}}),t._v(" "),a("div",{staticClass:"department"},[a("span",[t._v("申请人")]),t._v(" "),a("el-input",{attrs:{placeholder:"申请人",size:"mini"},model:{value:t.retrieval.appliedby,callback:function(e){t.$set(t.retrieval,"appliedby",e)},expression:"retrieval.appliedby"}})],1),t._v(" "),a("div",{staticClass:"department",staticStyle:{width:"300px"}},[a("span",[t._v("报销月份")]),t._v(" "),a("el-date-picker",{staticStyle:{width:"200px"},attrs:{size:"mini",type:"monthrange","range-separator":"至","value-format":"yyyy-MM-dd","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:t.monthrange},model:{value:t.month,callback:function(e){t.month=e},expression:"month"}})],1),t._v(" "),a("div",{staticClass:"department"},[a("span",[t._v("区域：")]),t._v(" "),a("el-select",{attrs:{size:"mini",clearable:"",placeholder:"请选择区域"},on:{change:t.changeArea},model:{value:t.retrieval.areaId,callback:function(e){t.$set(t.retrieval,"areaId",e)},expression:"retrieval.areaId"}},t._l(t.$store.state.Vuex.Area,function(t){return a("el-option",{key:t.Value,attrs:{label:t.Value,value:t.Id}})}),1)],1),t._v(" "),a("div",{staticClass:"department",staticStyle:{width:"300px"}},[a("span",[t._v("支付时间")]),t._v(" "),a("el-date-picker",{staticStyle:{width:"200px"},attrs:{size:"mini",type:"monthrange","range-separator":"至","value-format":"yyyy-MM-dd","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:t.monthrange2},model:{value:t.month2,callback:function(e){t.month2=e},expression:"month2"}})],1)]},proxy:!0},{key:"content",fn:function(){return[a("h3",[t._v("统计信息")]),t._v(" "),a("el-descriptions",{attrs:{column:1,labelStyle:{width:"120px"},contentStyle:{width:"120px",textAlign:"right"}}},[a("el-descriptions-item",{attrs:{label:"住宿费"}},[t._v(t._s(t.FinancialAmountFormat(t.total.accommodation_fee)))]),t._v(" "),a("el-descriptions-item",{attrs:{label:"汽油费"}},[t._v(t._s(t.FinancialAmountFormat(t.total.gas_fee)))]),t._v(" "),a("el-descriptions-item",{attrs:{label:"过路费"}},[t._v(t._s(t.FinancialAmountFormat(t.total.toll_fee)))]),t._v(" "),a("el-descriptions-item",{attrs:{label:"交通费"}},[t._v(t._s(t.FinancialAmountFormat(t.total.intercity_transfer_fee)))]),t._v(" "),a("el-descriptions-item",{attrs:{label:"安装费"}},[t._v(t._s(t.FinancialAmountFormat(t.total.installation_fee)))]),t._v(" "),a("el-descriptions-item",{attrs:{label:"餐费"}},[t._v(t._s(t.FinancialAmountFormat(t.total.meal_fee)))]),t._v(" "),a("el-descriptions-item",{attrs:{label:"出差补助"}},[t._v(t._s(t.FinancialAmountFormat(t.total.expedition_allowance)))]),t._v(" "),a("el-descriptions-item",{attrs:{label:"其他"}},[t._v(t._s(t.FinancialAmountFormat(t.total.qt_fee)))]),t._v(" "),a("el-descriptions-item",{attrs:{label:"合计"}},[t._v(t._s(t.FinancialAmountFormat(t.total.hj)))])],1),t._v(" "),a("h3",[t._v("统计图例")]),t._v(" "),a("div",{style:{width:"700px",height:"400px",float:"left"},attrs:{id:"myChart1"}}),t._v(" "),a("div",{style:{width:"500px",height:"400px",float:"left"},attrs:{id:"myChart2"}})]},proxy:!0}])})},staticRenderFns:[]};var s=a("VU/8")(o,d,!1,function(t){a("V3wD")},"data-v-7d64044d",null);e.default=s.exports},V3wD:function(t,e){}});