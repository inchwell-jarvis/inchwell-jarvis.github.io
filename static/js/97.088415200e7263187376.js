webpackJsonp([97],{qBiI:function(t,a){},qeIe:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i={data:function(){return{Data:[],url:["https://fuss10.elemecdn.com/e/5d/4a731a90594a4af544c0c25941171jpeg.jpeg"],Reason:"",options:[],EmployeeId:"",imageUrlList:[],imgVideoBase64List:[],imageUrl:{},dialogVisibleMainGraph:!1,loading:!1,UpImgdata:0}},computed:{},watch:{},methods:{FDimg:function(t){console.log(t),this.imageUrl.url="http://icms.inchwell.com.cn/File/EquInstallOrderFile/"+t,this.imageUrl.type="jpg",this.$refs.primary.start()},init:function(){var t=this,a={api:"get",url:this.$store.state.http+"StorageRoom/GetStandbyApproval",data:{Id:this.$store.state.Vuex.AddSparePartsID}};this.$https(a).then(function(a){t.Data=a.Data.StandbyApprovalDto,console.log(t.Data.State),console.log(t.Data),t.Data.ApprovalType=1==t.Data.ApprovalType?"整机申请":"零配件申请"})},UpdateSAppState:function(t){var a=this;console.log(t);var e={api:"post",url:this.$store.state.http+"StorageRoom/UpdateSAppState",data:{Id:this.$store.state.Vuex.AddSparePartsID,ToState:t,Reason:this.Reason}};this.$https(e).then(function(e){a.init(),3==t&&a.$message.success("已拒绝！"),2==t&&a.$message.success("已同意！"),6==t&&a.$message.success("已收货！"),10==t&&a.$message.success("已结单！")})},GetEmployeeMini:function(){var t=this,a={api:"get",url:this.$store.state.http+"System/GetEmployeeMini",data:{type:2}};this.$https(a).then(function(a){console.log(a.Data),t.options=a.Data})},UpdateEmployeeId:function(){var t=this;if(""==this.EmployeeId)return this.$message.warning("请选择工程师！"),!1;var a={api:"post",url:this.$store.state.http+"StorageRoom/AssignSApp",data:{Id:this.$store.state.Vuex.AddSparePartsID,Str:String(this.EmployeeId)}};this.$https(a).then(function(a){console.log(a),t.$message.success("指派成功！"),t.init()})},beforeuploadMainGraph:function(t){var a=(t.size/1024/1024).toFixed(3);if(console.log(a+"MB"),console.log(t),a>10&&"video/mp4"==t.type)return this.$message.warning("视频文件大小不得超过10MB"),!1;var e=this,i=new FileReader;i.readAsDataURL(t),i.onload=function(a){var s=i.result;e.imgVideoBase64List.push({uid:t.uid,base64:s}),console.log(e.imgVideoBase64List)}},handleSuccessMainGraph:function(t,a,e){this.imageUrlList=e},handlePreviewMainGraph:function(t){this.imageUrl.type=t.raw.type,this.imageUrl.url=t.url,console.log(t),this.$refs.primary.start()},handleRemoveMainGraph:function(t,a){console.log(t.uid);for(var e=0;e<this.imgVideoBase64List.length;e++){this.imgVideoBase64List[e].uid===t.uid&&this.imgVideoBase64List.splice(e,1)}console.log(this.imgVideoBase64List)},UpdataImg:function(){if(0==this.imgVideoBase64List.length)return this.$message.warning("请选择图片 或 等待图片解压完成！"),!1;this.loading=!0;for(var t=0;t<this.imgVideoBase64List.length;t++){var a=this.imgVideoBase64List[t];this.UploadSAppImage(a)}},UploadSAppImage:function(t){var a=this,e={api:"post",url:this.$store.state.http+"StorageRoom/UploadSAppImage",data:{Id:this.$store.state.Vuex.AddSparePartsID,FileStr:t.base64,Type:1}};this.$https(e).then(function(t){console.log(t),a.UpImgdata+=1,a.SHnagchuanWanchang()})},SHnagchuanWanchang:function(){this.UpImgdata==this.imgVideoBase64List.length&&(this.loading=!1,this.UpImgdata=0,this.imgVideoBase64List=[],this.imageUrlList=[],this.init())}},created:function(){this.init(),this.GetEmployeeMini()},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},s={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"box_s",attrs:{"element-loading-text":"正在上传"}},[e("div",{staticClass:"segmentation"},[t._v("\n        基础信息\n    ")]),t._v(" "),e("div",{staticClass:"itemmsgxx_document"},[e("p",[e("span",[t._v("客户名称:")]),t._v(t._s(t.Data.CusFullName))])]),t._v(" "),e("div",{staticClass:"itemmsgxx_document"},[e("p",[e("span",[t._v("发起人:")]),t._v(t._s(t.Data.Sponsor))])]),t._v(" "),e("div",{staticClass:"itemmsgxx_document"},[e("p",[e("span",[t._v("审批人:")]),t._v(t._s(t.Data.Approved))])]),t._v(" "),e("div",{staticClass:"itemmsgxx_document"},[e("p",[e("span",[t._v("审批时间:")]),t._v(t._s(t.Data.ApproveDate))])]),t._v(" "),e("div",{staticClass:"itemmsgxx_document"},[e("p",[e("span",[t._v("审批原因:")]),t._v(t._s(t.Data.Reason))])]),t._v(" "),e("div",{staticClass:"itemmsgxx_document"},[e("p",[e("span",[t._v("状态:")]),t._v(t._s(t.Data.StateStr))])]),t._v(" "),e("div",{staticClass:"itemmsgxx_document"},[e("p",[e("span",[t._v("申请类型:")]),t._v(t._s(t.Data.ApprovalType))])]),t._v(" "),"零配件申请"==t.Data.ApprovalType?e("div",{staticClass:"segmentation"},[t._v("\n        整机信息\n    ")]):t._e(),t._v(" "),e("div",{staticClass:"itemmsgxx_document"},[e("p",[e("span",[t._v("名称:")]),t._v(t._s(t.Data.ProductDesc))])]),t._v(" "),e("div",{staticClass:"itemmsgxx_document"},[e("p",[e("span",[t._v("编码:")]),t._v(t._s(t.Data.ProductCode))])]),t._v(" "),e("div",{staticClass:"itemmsgxx_document"},[e("p",[e("span",[t._v("品牌:")]),t._v(t._s(t.Data.Brand))])]),t._v(" "),e("div",{staticClass:"itemmsgxx_document"},[e("p",[e("span",[t._v("备注:")]),t._v(t._s(t.Data.Memo))])]),t._v(" "),"零配件申请"==t.Data.ApprovalType?e("div",{staticClass:"segmentation"},[t._v("\n        零配件信息\n    ")]):t._e(),t._v(" "),"零配件申请"==t.Data.ApprovalType?e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.Data.SADetailDtos}},[e("el-table-column",{attrs:{prop:"ProductCode",label:"产品编码",width:"180"}}),t._v(" "),e("el-table-column",{attrs:{prop:"Brand",label:"品牌",width:"180"}}),t._v(" "),e("el-table-column",{attrs:{prop:"ProductDesc",label:"产品描述","show-overflow-tooltip":!0}})],1):t._e(),t._v(" "),1!=t.Data.State?e("div",[e("div",{staticClass:"segmentation"},[t._v("\n            照片\n            "),2==t.Data.State||3==t.Data.State||4==t.Data.State||5==t.Data.State||6==t.Data.State||7==t.Data.State||8==t.Data.State?e("el-button",{staticStyle:{float:"right"},attrs:{size:"mini",type:"primary"},on:{click:function(a){return t.UpdataImg()}}},[t._v("上传")]):t._e()],1),t._v(" "),t._l(t.Data.SAImageDtos,function(a,i){return e("el-image",{key:i,staticStyle:{width:"100px",height:"100px",margin:"10px"},attrs:{src:"http://icms.inchwell.com.cn/File/EquInstallOrderFile/"+a.Image,fit:"scale-down"},on:{click:function(e){return t.FDimg(a.Image)}}})}),t._v(" "),2==t.Data.State||3==t.Data.State||4==t.Data.State||5==t.Data.State||6==t.Data.State||7==t.Data.State||8==t.Data.State?e("el-upload",{staticStyle:{margin:"10px"},attrs:{action:"https://httpbin.org/post",data:{attachType:0},name:"appFile",limit:10,multiple:!0,accept:"image/*,video/*","before-upload":t.beforeuploadMainGraph,"on-success":t.handleSuccessMainGraph,"on-preview":t.handlePreviewMainGraph,"list-type":"picture-card","file-list":t.imageUrlList}},[e("i",{staticClass:"el-icon-plus spc1"})]):t._e()],2):t._e(),t._v(" "),e("saxo-pop",{ref:"primary",attrs:{type:"primary",title:"查看",width:"600px"},on:{close:function(a){return t.$refs.primary.start()}}},["video/mp4"!=t.imageUrl.type?e("img",{attrs:{width:"100%",src:t.imageUrl.url,alt:""}}):t._e()]),t._v(" "),1==t.Data.State?e("div",{staticClass:"segmentation"},[t._v("审批")]):t._e(),t._v(" "),1==t.Data.State?e("div",{staticStyle:{padding:"20px",float:"left"}},[e("el-input",{staticStyle:{width:"500px"},attrs:{type:"textarea",autosize:{minRows:2,maxRows:8},placeholder:"请输入审批愿意 非必填"},model:{value:t.Reason,callback:function(a){t.Reason=a},expression:"Reason"}}),t._v(" "),e("el-button-group",{staticStyle:{float:"right",padding:"20px"}},[e("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return t.UpdateSAppState(3)}}},[t._v("拒绝")]),t._v(" "),e("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){return t.UpdateSAppState(2)}}},[t._v("同意")])],1)],1):t._e(),t._v(" "),2==t.Data.State||6==t.Data.State?e("div",{staticClass:"segmentation"},[t._v("指派工程师")]):t._e(),t._v(" "),2==t.Data.State||6==t.Data.State?e("div",{staticStyle:{padding:"20px",float:"left"}},[e("el-select",{attrs:{filterable:"",placeholder:"请选择",size:"mini"},model:{value:t.EmployeeId,callback:function(a){t.EmployeeId=a},expression:"EmployeeId"}},t._l(t.options,function(t){return e("el-option",{key:t.EmployeeId,attrs:{label:t.Name,value:t.EmployeeId}})}),1),t._v(" "),e("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){return t.UpdateEmployeeId()}}},[t._v("确认")])],1):t._e(),t._v(" "),5==t.Data.State?e("div",{staticClass:"segmentation"},[t._v("收货\n        "),e("el-button",{staticStyle:{float:"right"},attrs:{size:"mini",type:"primary"},on:{click:function(a){return t.UpdateSAppState(6)}}},[t._v("收货")])],1):t._e(),t._v(" "),8==t.Data.State?e("div",{staticClass:"segmentation"},[t._v("结单")]):t._e(),t._v(" "),8==t.Data.State?e("div",{staticStyle:{padding:"20px",float:"left"}},[e("el-input",{staticStyle:{width:"500px"},attrs:{type:"textarea",autosize:{minRows:2,maxRows:8},placeholder:"备注"},model:{value:t.Reason,callback:function(a){t.Reason=a},expression:"Reason"}}),t._v(" "),e("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){return t.UpdateSAppState(10)}}},[t._v("结单")])],1):t._e()],1)},staticRenderFns:[]};var n=e("VU/8")(i,s,!1,function(t){e("qBiI")},"data-v-626b2987",null);a.default=n.exports}});