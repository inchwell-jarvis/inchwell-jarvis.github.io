webpackJsonp([55],{Iy3y:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("mvHQ"),n=a.n(i),o=a("uXZL"),l=a.n(o),s={data:function(){return{FullName:"",CustomerId:"",inputUp:!0,data:[],Basic:[]}},computed:{},watch:{},methods:{formatDate:function(t,e){var a=t-1,i=Math.round(24*(a-Math.floor(a))*60*60),n=new Date(1900,0,a,0,0,i),o=n.getFullYear(),l=n.getMonth()+1,s=n.getDate();return o+e+(l<10?"0"+l:l)+e+(s<10?"0"+s:s)},querySearch:function(t,e){if(console.log(t),void 0==t)return t="",!1;""==t&&(t="北京"),this.API_GET("CRM/GetCustomerMini",{search:t}).then(function(t){if(console.log(t.Dtos),0==t.Dtos.length)return e([]),!1;for(var a=0;a<t.Dtos.length;a++)t.Dtos[a].value=t.Dtos[a].FullName;e(t.Dtos)})},handleSelect:function(t){console.log(t),this.CustomerId=t.CusId},getFile:function(t){var e=t.target.files[0];this.exportData(e),t.target.value=""},exportData:function(t){var e=this,a=new FileReader;FileReader.prototype.readAsBinaryString=function(t){var a,i,n="",o=new FileReader;o.onload=function(t){for(var s=new Uint8Array(o.result),r=s.byteLength,u=0;u<r;u++)n+=String.fromCharCode(s[u]);a=l.a.read(n,{type:"binary"}),i=l.a.utils.sheet_to_json(a.Sheets[a.SheetNames[0]],{header:1}),console.log(i),e.data=[],e.Basic=[];for(var c=0;c<i.length;c++){var d=i[c];if(c<6&&e.Basic.push({T01:d[0].split(":")[0],T02:d[0].split(":")[1]}),6==c&&e.Basic.push({T01:d[0].split(":")[0],T02:e.formatDate(d[1],"/")}),c>10){if(2==d[0].split("-").length)var p=d[0].split("-")[0];else p=d[0];e.data.push({Pos:p,DeliverQuantity:d[1],Quantity:d[2],ProductCode:d[3],LongProductCode:d[4],Desc:d[5]})}}console.log(e.Basic),console.log(e.data)},o.readAsArrayBuffer(t)},a.readAsBinaryString(t)},submitForm:function(){var t=this;this.API_POST("Bill/AddEquCheckBill",{CusId:this.CustomerId,CusFullName:this.FullName,EquDtos:this.data,Other:n()(this.Basic)}).then(function(){t.$router.push({path:"/GetEquCheckBills"})})}},created:function(){},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"box_s"},[a("div",{staticClass:"select"},[a("el-autocomplete",{staticClass:"inline-input",staticStyle:{width:"350px"},attrs:{size:"mini","show-overflow-tooltip":!0,"fetch-suggestions":t.querySearch,placeholder:"请选择客户",clearable:""},on:{select:t.handleSelect},model:{value:t.FullName,callback:function(e){t.FullName=e},expression:"FullName"}},[a("template",{slot:"prepend"},[t._v("选择客户")])],2)],1),t._v(" "),a("br"),t._v(" "),a("el-button",{attrs:{type:"success",icon:"el-icon-folder",size:"mini"}},[a("label",{attrs:{for:"int"}},[t._v("上传文件")]),t._v(" "),t.inputUp?a("input",{ref:"referenceUpload",staticStyle:{"margin-left":"70px",display:"none"},attrs:{id:"int",type:"file",accept:".xlsx, .xls"},on:{change:function(e){return t.getFile(e)}}}):t._e()]),t._v(" "),t.Basic[0]?a("div",[a("p",{staticClass:"tit"},[t._v("基础信息")]),t._v(" "),a("el-descriptions",{attrs:{size:"mini",border:""}},t._l(t.Basic,function(e,i){return a("el-descriptions-item",{key:i,attrs:{label:e.T01}},[t._v(t._s("  "+e.T02))])}),1),t._v(" "),a("p",{staticClass:"tit"},[t._v("设备数据")]),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.data,size:"mini",height:this.$store.state.TableOptimumHeight-250,stripe:""}},[a("el-table-column",{attrs:{prop:"Pos",width:"100",label:"序号"}}),t._v(" "),a("el-table-column",{attrs:{prop:"DeliverQuantity",width:"100",label:"发货数量"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Quantity",width:"100",label:"合同数量"}}),t._v(" "),a("el-table-column",{attrs:{prop:"ProductCode",label:"零件号",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"LongProductCode",label:"长编码",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Desc",label:"产品描述/产品名称"}})],1)],1):t._e(),t._v(" "),a("div",{staticClass:"bottom_but"},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.submitForm()}}},[t._v("立即创建")])],1)],1)},staticRenderFns:[]};var u=a("VU/8")(s,r,!1,function(t){a("Pmfk")},"data-v-b1f61b8a",null);e.default=u.exports},Pmfk:function(t,e){}});