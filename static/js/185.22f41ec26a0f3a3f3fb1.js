webpackJsonp([185],{loM3:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("Xxa5"),a=n.n(r),i=n("//Fk"),o=n.n(i),l=n("exGp"),s=n.n(l),c={data:function(){return{data:[],checkedCities:!1,checkedList:[],expandedRowKeys:[]}},created:function(){this.start()},mounted:function(){},computed:{},watch:{},methods:{start:function(){var t=s()(a.a.mark(function t(){var e,n,r,i=this;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e={search:"",buyer:"",state:2,paystate:-1,pageNum:1,numPerPage:99999,orderField:"",orderDirection:"",potype:"MPO",invoiceState:-1,forTo:"index"},t.next=3,this.API_GET("MachineSO/GetMPOs",e);case 3:return n=t.sent,r=n.Dtos.map(function(t){return t.ID}),t.next=7,o.a.all(r.map(function(t){return i.GetMPO(t)}));case 7:this.data=t.sent,console.log(this.data);case 9:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),GetMPO:function(){var t=s()(a.a.mark(function t(e){var n;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.API_GET("MachineSO/GetMPO",{mpoId:e});case 2:return(n=t.sent).MPO.MachinePOFiles=n.MachinePOFiles,t.abrupt("return",n.MPO);case 5:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),MPOApproval:function(){var t=s()(a.a.mark(function t(e,n){var r,i=this,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r={Id:e.ID,Other:e.Memo,Str:n},t.next=3,this.API_POST(2==e.State?"MachineSO/MPOApproval":"MachineSO/MPOSubmitForManager",r,!1).then(function(t){o||(i.$message.success("审核成功！"),i.start())});case 3:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}(),review:function(){var t=s()(a.a.mark(function t(e){var n=this;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.a.all(this.checkedList.map(function(t){return n.MPOApproval(t,e,!0)}));case 2:this.start(),this.$message.success("审核成功！");case 4:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),handleRowClick:function(t){console.log(this.expandedRowKeys),this.expandedRowKeys.includes(t.ID)?this.expandedRowKeys=this.expandedRowKeys.filter(function(e){return e!==t.ID}):this.expandedRowKeys.push(t.ID)}},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},u={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"box"},[n("SaxoPage",{scopedSlots:t._u([{key:"title",fn:function(){return[t.checkedList.length>0?n("saxo-button",{attrs:{mini:"",type:"primary"},on:{click:function(e){return t.review(1)}}},[t._v("审核通过 ("+t._s(t.checkedList.length)+")")]):t._e(),t._v(" "),t.checkedList.length>0?n("saxo-button",{attrs:{mini:"",type:"danger"},on:{click:function(e){return t.review(0)}}},[t._v("审核驳回 ("+t._s(t.checkedList.length)+")")]):t._e()]},proxy:!0},{key:"content",fn:function(){return[n("el-table",{staticStyle:{width:"100%"},attrs:{"expand-row-keys":t.expandedRowKeys,data:t.data,"row-key":function(t){return t.ID},"header-cell-style":t.$store.state.headerCellStyle,"cell-style":t.$store.state.cellStyle,stripe:"",height:"100%"},on:{"row-click":t.handleRowClick,"selection-change":function(e){t.checkedList=e}}},[n("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",{staticClass:"device_information"},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.row.MachinePOEquDtos,stripe:"",size:"mini"}},[n("el-table-column",{attrs:{prop:"Describe",label:"设备描述","show-overflow-tooltip":!0}}),t._v(" "),n("el-table-column",{attrs:{prop:"Brand",label:"品牌",width:"200"}}),t._v(" "),n("el-table-column",{attrs:{prop:"POQuantity",label:"数量",width:"100"}}),t._v(" "),n("el-table-column",{attrs:{label:"价格",width:"100"},scopedSlots:t._u([{key:"default",fn:function(r){return[n("span",{staticStyle:{float:"right"}},[t._v(t._s(t.FinancialAmountFormat(r.row.UnitPrice,t.FinancialAmountSymbol(e.row.BuyingCurrency))))])]}}],null,!0)})],1),t._v(" "),t._l(e.row.MachinePOFiles,function(e){return n("p",{key:e.FileUrl,staticStyle:{"text-align":"right","line-height":"30px"}},[n("el-link",{attrs:{type:"primary",underline:!1,href:"http://icms.inchwell.com.cn"+e.FileUrl,target:"_blank"}},[t._v(t._s(e.FileName))])],1)})],2)]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"CusFullName",label:"客户名称","show-overflow-tooltip":!0}}),t._v(" "),n("el-table-column",{attrs:{prop:"POCode",label:"订单编号",width:"150"}}),t._v(" "),n("el-table-column",{attrs:{label:"总金额",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{staticStyle:{float:"right"}},[t._v(t._s(t.FinancialAmountFormat(e.row.TotalAmount,t.FinancialAmountSymbol(e.row.BuyingCurrency))))])]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"CreateDateStr",label:"创建时间",width:"150"}}),t._v(" "),n("el-table-column",{attrs:{prop:"BelongCompany",label:"隶属公司",width:"100"}}),t._v(" "),n("el-table-column",{attrs:{prop:"Buyer",label:"申请人",width:"80"}}),t._v(" "),n("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),n("el-table-column",{attrs:{label:"操作",fixed:"right",width:"160"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("saxo-button",{attrs:{mini:"",type:"danger"},on:{click:function(n){return t.MPOApproval(e.row,0)}}},[t._v("驳回")]),t._v(" "),n("saxo-button",{attrs:{mini:"",type:"primary"},on:{click:function(n){return t.MPOApproval(e.row,1)}}},[t._v("批准")])]}}])})],1)]},proxy:!0}])})],1)},staticRenderFns:[]};var p=n("VU/8")(c,u,!1,function(t){n("yelN")},"data-v-0f201539",null);e.default=p.exports},yelN:function(t,e){}});