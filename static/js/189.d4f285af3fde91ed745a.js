webpackJsonp([189],{"30FU":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n("Xxa5"),i=n.n(a),r=n("exGp"),s=n.n(r),l=n("mvHQ"),o=n.n(l),c={data:function(){return{year:"",CusFullName:"",ContractCode:"",Saler:"",billingTime:"",paymentTime:"",CusType:"全部",CusTypeList:[],ProJect:[],ProJectList:[],ProgressOfPay:"全部",ProgressOfPayList:["全部","全部回款","未全部回款"],subordinate:"全部",subordinateList:["全部","技术公司","服务公司"],ProJectType:[],ProJectTypeList:[],ConfirmationDate:"",SentSearch:"全部",Sents:[],tableData:[],DataBars:0,backup:[],backup2:[],Invoices:[],Returns:[],Pays:[],SaxoStyle:{},className:"ConView",InvoicesBigLength:0,ReturnsBigLength:0,PaysBigLength:0}},created:function(){this.year=this.GetDate().split("-")[0],this.start()},beforeDestroy:function(){document.body.removeEventListener("click",this.Listener,!1)},mounted:function(){document.body.addEventListener("click",this.Listener,!1)},methods:{toFinanceData:function(){this.$router.push({path:"/FinanceData"})},loadMore:function(t){"bottom"==t&&(this.tableData=this.tableData.concat(this.backup.slice(this.tableData.length,this.tableData.length+100)))},Listener:function(){this.className="ConView"},simplicity:function(t){return this.FinancialAmountFormat(t.Otherdec)},simplicity2:function(t){return this.FinancialAmountFormat(t.Otherdec,"")},start:function(){var t=this;this.API_GET("Finance/GetFinanceAllPro",{year:this.year}).then(function(e){console.log(e.FinanceAllProDtos),t.ProcessData(e.FinanceAllProDtos,!0),t.DataBars=e.DataBars})},ProcessData:function(t,e){var n=this;this.Invoices=[],this.Returns=[],this.Pays=[],this.CusTypeList=["全部"],this.ProJectList=[],this.ProJectTypeList=[],this.Sents=["全部"],this.InvoicesBigLength=0,this.ReturnsBigLength=0,this.PaysBigLength=0,t.forEach(function(t,e){t.TimeStr=t.ContractConfirmDate.split("T")[0],t.index=e,n.Invoices.push(t.Invoices),n.InvoicesBigLength=n.InvoicesBigLength<t.Invoices.length?t.Invoices.length:n.InvoicesBigLength,n.Returns.push(t.Returns),n.ReturnsBigLength=n.ReturnsBigLength<t.Returns.length?t.Returns.length:n.ReturnsBigLength,n.Pays.push(t.Pays),n.PaysBigLength=n.PaysBigLength<t.Pays.length?t.Pays.length:n.PaysBigLength,!n.CusTypeList.includes(t.CusType)&&n.CusTypeList.push(t.CusType),!n.ProJectList.includes(t.ProJect)&&n.ProJectList.push(t.ProJect),!n.ProJectTypeList.includes(t.ProJectType)&&n.ProJectTypeList.push(t.ProJectType),!n.Sents.includes(t.Sent)&&n.Sents.push(t.Sent)}),this.backup=t,this.backup2=t,this.tableData=t.slice(0,100),this.Invoices=this.repaiRneWarR(JSON.parse(o()(this.Invoices)),"Invoices"),this.Pays=this.repaiRneWarR(JSON.parse(o()(this.Pays)),"Pays"),this.Returns=this.repaiRneWarR(JSON.parse(o()(this.Returns)),"Returns")},repaiRneWarR:function(t,e){var n=this;if(0==t.length)return t;var a=0;return t.forEach(function(t){t.length>a&&(a=t.length)}),t.forEach(function(t){for(var e=a-t.length,n=0;n<e;n++)t.push({Id:" ",Key:" ",Value:" ",Other:" ",OtherInt:" ",Otherdec:" "})}),t.forEach(function(t,a){for(var i=0;i<t.length;i++)n.backup[a][e+"_"+i]=t[i]}),t},SecondaryRetrieval:function(){var t=s()(i.a.mark(function t(){var e,n,a,r=this;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=function(t,e,n){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],r=[];return""!==n?t.forEach(function(t){var s=!0;"ProJect"!==e&&"ProJectType"!==e?(a&&"全部"===n&&(r.push(t),s=!1),null!=t[e]&&s&&(i?t[e]===n:-1!=t[e].indexOf(n))&&r.push(t)):(a&&0==n.length&&(r.push(t),s=!1),null!=t[e]&&s&&-1!=n.indexOf(t[e])&&r.push(t))}):r=t,r},n=JSON.parse(o()(this.backup2)),n=e(n,"CusFullName",this.CusFullName),n=e(n,"ContractCode",this.ContractCode),n=e(n,"Saler",this.Saler),n=e(n,"CusType",this.CusType,!0),n=e(n,"ProJect",this.ProJect,!0),n=e(n,"ProJectType",this.ProJectType,!0,!0),n=e(n,"Belong",this.subordinate,!0),n=e(n,"Sent",this.SentSearch,!0),a=[],""!=this.ProgressOfPay?"全部"==this.ProgressOfPay?a=n:n.forEach(function(t){"全部回款"==r.ProgressOfPay&&100==t.ProgressOfPay&&a.push(t),"未全部回款"==r.ProgressOfPay&&t.ProgressOfPay<100&&a.push(t)}):a=n,n=a,a=[],""!=this.ConfirmationDate&&null!=this.ConfirmationDate?n.forEach(function(t){console.log(t.TimeStr),t.TimeStr>=r.ConfirmationDate[0]&&t.TimeStr<=r.ConfirmationDate[1]&&a.push(t)}):a=n,n=a,a=[],""!=this.billingTime&&null!=this.billingTime?n.forEach(function(t){if(0!=t.Invoices.length){var e=!0;t.Invoices.forEach(function(n){n.Other>=r.billingTime[0]&&n.Other<=r.billingTime[1]&&e&&(a.push(t),e=!1)})}}):a=n,n=a,a=[],""!=this.paymentTime&&null!=this.paymentTime?n.forEach(function(t){if(0!=t.Pays.length){var e=!0;t.Pays.forEach(function(n){n.Other>=r.paymentTime[0]&&n.Other<=r.paymentTime[1]&&e&&(a.push(t),e=!1)})}}):a=n,this.backup=a,this.DataBars=this.backup.length,this.tableData=a.slice(0,100),this.$refs.tablePro.bodyWrapper.scrollTop=0;case 25:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),exportExcel2:function(){for(var t=this,e="",n=0;n<this.InvoicesBigLength;n++)e+="<th>第"+(n+1)+"次开票</th><th>第"+(n+1)+"次开票时间</th>";var a="";for(n=0;n<this.PaysBigLength;n++)a+="<th>第"+(n+1)+"次回款</th><th>第"+(n+1)+"次回款时间</th><th>第"+(n+1)+"次回款来源</th>";var i="";for(n=0;n<this.ReturnsBigLength;n++)i+="<th>第"+(n+1)+"次退款</th><th>第"+(n+1)+"次退款时间</th><th>第"+(n+1)+"次退款来源</th>";var r="\n                    <tr>\n                        <th>序号</th>\n                        <th style='width:600px'>客户名称</th>\n                        <th>销售员</th>\n                        <th>客户品牌</th>\n                        <th>项目</th>\n                        <th>分类</th>\n                        <th>隶属公司</th>\n                        <th>合同号</th>\n                        <th>发货</th>\n                        <th>合同金额</th>\n                        <th>实际合同额</th>\n                        <th>合同确认日期</th>\n                        <th>回款进度</th>\n                        <th>开票总额</th>\n                        <th>回款总额</th>\n                        <th>退款合计</th>\n                        <th>实际回款</th>\n                        "+e+"\n                        "+a+"\n                        "+i+"\n                    </tr>";this.backup.forEach(function(e,n){for(var a="",i=0;i<t.InvoicesBigLength;i++)a+="<td>"+("已作废"!=e["Invoices_"+i].Key?t.FinancialAmountFormat(e["Invoices_"+i].Otherdec,""):"0")+"</td><td>"+e["Invoices_"+i].Other+"</td>";for(var s="",l=0;l<t.PaysBigLength;l++)s+="<td>"+t.FinancialAmountFormat(e["Pays_"+l].Otherdec,"")+"</td><td>"+e["Pays_"+l].Other+"</td><td>"+e["Pays_"+l].Value+"</td>";for(var o="",c=0;c<t.ReturnsBigLength;c++)o+="<td>"+t.FinancialAmountFormat(e["Returns_"+c].Otherdec,"")+"</td><td>"+e["Returns_"+c].Other+"</td><td>"+e["Returns_"+c].Value+"</td>";r+="<tr>\n                                    <td>"+Number(n+1)+"</td>\n                                    <td>"+e.CusFullName+"</td>\n                                    <td>"+e.Saler+"</td>\n                                    <td>"+e.CusType+"</td>\n                                    <td>"+e.ProJect+"</td>\n                                    <td>"+e.ProJectType+"</td>\n                                    <td>"+e.Belong+"</td>\n                                    <td>"+e.ContractCode+"</td>\n                                    <td>"+e.Sent+"</td>\n                                    <td>"+t.FinancialAmountFormat(e.ContractAmount,"")+"</td>\n                                    <td>"+t.FinancialAmountFormat(e.ActualContractAmount,"")+"</td>\n                                    <td>"+t.FinancialAmountFormat(e.TimeStr,"")+"</td>\n                                    <td>"+t.FinancialAmountFormat(e.ProgressOfPay,"")+"%</td>\n                                    <td>"+t.FinancialAmountFormat(e.InvoiceAmount,"")+"</td>\n                                    <td>"+t.FinancialAmountFormat(e.PayAmount,"")+"</td>\n                                    <td>"+t.FinancialAmountFormat(e.ReturnAmount,"")+"</td>\n                                    <td>"+t.FinancialAmountFormat(e.RealityPayAmount,"")+"</td>   \n                                    "+a+"\n                                    "+s+"\n                                    "+o+"  \n                                </tr>"}),this.downloadTable(r,"大表")}}},u={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"box"},[n("router-view",{on:{refresh:t.start}}),t._v(" "),n("div",{staticClass:"retrieve"},[n("div",{staticClass:"leftSpan"},[t._v("\n            财务大表\n            "),n("i",{staticClass:"el-icon-s-data",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.toFinanceData()}}})]),t._v(" "),n("div",{class:t.className,style:t.SaxoStyle,on:{click:function(t){t.stopPropagation()}}},[n("div",{staticClass:"retrieval",on:{click:function(e){e.stopPropagation(),t.className+=" flex  animate__animated animate__fadeIn"}}},[t._v("\n                显示更多\n            ")]),t._v(" "),n("div",{staticClass:"department"},[n("span",[t._v("年份")]),t._v(" "),n("el-date-picker",{attrs:{clearable:!1,"value-format":"yyyy",type:"year",placeholder:"选择年",size:"mini"},on:{change:function(e){return t.start()}},model:{value:t.year,callback:function(e){t.year=e},expression:"year"}})],1),t._v(" "),n("div",{staticClass:"department"},[n("span",[t._v("客户名称")]),t._v(" "),n("el-input",{attrs:{placeholder:"客户名称",size:"mini"},on:{input:function(e){return t.SecondaryRetrieval()}},model:{value:t.CusFullName,callback:function(e){t.CusFullName=e},expression:"CusFullName"}})],1),t._v(" "),n("div",{staticClass:"department"},[n("span",[t._v("合同号")]),t._v(" "),n("el-input",{attrs:{placeholder:"合同号",size:"mini"},on:{input:function(e){return t.SecondaryRetrieval()}},model:{value:t.ContractCode,callback:function(e){t.ContractCode=e},expression:"ContractCode"}})],1),t._v(" "),n("div",{staticClass:"department"},[n("span",[t._v("销售员")]),t._v(" "),n("el-input",{attrs:{placeholder:"销售员",size:"mini"},on:{input:function(e){return t.SecondaryRetrieval()}},model:{value:t.Saler,callback:function(e){t.Saler=e},expression:"Saler"}})],1),t._v(" "),n("div",{staticClass:"department"},[n("span",[t._v("品牌")]),t._v(" "),n("el-select",{attrs:{clearable:!0,placeholder:"品牌",size:"mini"},on:{change:function(e){return t.SecondaryRetrieval()}},model:{value:t.CusType,callback:function(e){t.CusType=e},expression:"CusType"}},t._l(t.CusTypeList,function(t){return n("el-option",{key:t+"ert",attrs:{label:t,value:t}})}),1)],1),t._v(" "),n("div",{staticClass:"department"},[n("span",[t._v("项目")]),t._v(" "),n("el-select",{attrs:{clearable:"",placeholder:"项目",size:"mini",multiple:"","collapse-tags":""},on:{change:function(e){return t.SecondaryRetrieval()}},model:{value:t.ProJect,callback:function(e){t.ProJect=e},expression:"ProJect"}},t._l(t.ProJectList,function(t){return n("el-option",{key:t+"erp",attrs:{label:t,value:t}})}),1)],1),t._v(" "),n("div",{staticClass:"department"},[n("span",[t._v("分类")]),t._v(" "),n("el-select",{attrs:{clearable:"",placeholder:"分类",size:"mini",multiple:"","collapse-tags":""},on:{change:function(e){return t.SecondaryRetrieval()}},model:{value:t.ProJectType,callback:function(e){t.ProJectType=e},expression:"ProJectType"}},t._l(t.ProJectTypeList,function(t){return n("el-option",{key:t+"erp",attrs:{label:t,value:t}})}),1)],1),t._v(" "),n("div",{staticClass:"department"},[n("span",[t._v("回款")]),t._v(" "),n("el-select",{attrs:{clearable:"",placeholder:"回款进度",size:"mini"},on:{change:function(e){return t.SecondaryRetrieval()}},model:{value:t.ProgressOfPay,callback:function(e){t.ProgressOfPay=e},expression:"ProgressOfPay"}},t._l(t.ProgressOfPayList,function(t){return n("el-option",{key:t+"wer",attrs:{label:t,value:t}})}),1)],1),t._v(" "),n("div",{staticClass:"department"},[n("span",[t._v("发货")]),t._v(" "),n("el-select",{attrs:{clearable:"",placeholder:"发货状态",size:"mini"},on:{change:function(e){return t.SecondaryRetrieval()}},model:{value:t.SentSearch,callback:function(e){t.SentSearch=e},expression:"SentSearch"}},t._l(t.Sents,function(t){return n("el-option",{key:t+"wer",attrs:{label:t,value:t}})}),1)],1),t._v(" "),n("div",{staticClass:"department"},[n("span",[t._v("隶属公司")]),t._v(" "),n("el-select",{attrs:{clearable:"",placeholder:"隶属公司",size:"mini"},on:{change:function(e){return t.SecondaryRetrieval()}},model:{value:t.subordinate,callback:function(e){t.subordinate=e},expression:"subordinate"}},t._l(t.subordinateList,function(t){return n("el-option",{key:t+"rty",attrs:{label:t,value:t}})}),1)],1),t._v(" "),"ConView"!=t.className?n("div",{staticStyle:{width:"100%"}}):t._e(),t._v(" "),n("div",{staticClass:"department",staticStyle:{width:"500px"}},[n("span",[t._v("开票日期")]),t._v(" "),n("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",size:"mini",type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:function(e){return t.SecondaryRetrieval()}},model:{value:t.billingTime,callback:function(e){t.billingTime=e},expression:"billingTime"}})],1),t._v(" "),n("div",{staticClass:"department",staticStyle:{width:"500px"}},[n("span",[t._v("回款日期")]),t._v(" "),n("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",size:"mini",type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:function(e){return t.SecondaryRetrieval()}},model:{value:t.paymentTime,callback:function(e){t.paymentTime=e},expression:"paymentTime"}})],1),t._v(" "),n("div",{staticClass:"department",staticStyle:{width:"500px"}},[n("span",[t._v("确认日期")]),t._v(" "),n("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",size:"mini",type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:function(e){return t.SecondaryRetrieval()}},model:{value:t.ConfirmationDate,callback:function(e){t.ConfirmationDate=e},expression:"ConfirmationDate"}})],1)]),t._v(" "),n("saxo-button",{staticStyle:{float:"right","margin-top":"13px"},attrs:{mini:"",type:"info"},on:{click:function(e){return t.exportExcel2()}}},[t._v("导出全部")])],1),t._v(" "),n("div",{staticClass:"content2"},[n("el-table",{directives:[{name:"loadmore",rawName:"v-loadmore",value:t.loadMore,expression:"loadMore"}],ref:"tablePro",staticStyle:{width:"100%"},attrs:{data:t.tableData,"header-cell-style":t.$store.state.headerCellStyle,"cell-style":t.$store.state.cellStyle,stripe:"",height:"100%"}},[n("el-table-column",{attrs:{type:"index",width:"60"}}),t._v(" "),n("el-table-column",{attrs:{prop:"CusFullName",label:"客户名称",width:"350"}}),t._v(" "),n("el-table-column",{attrs:{prop:"BusName",label:"营业执照",width:"350"}}),t._v(" "),n("el-table-column",{attrs:{prop:"CusArea",label:"区域",width:"100"}}),t._v(" "),n("el-table-column",{attrs:{prop:"Saler",label:"销售员",width:"70"}}),t._v(" "),n("el-table-column",{attrs:{prop:"CusType",label:"客户品牌",width:"100"}}),t._v(" "),n("el-table-column",{attrs:{prop:"ProJect",label:"项目",width:"80"}}),t._v(" "),n("el-table-column",{attrs:{prop:"ProJectType",label:"分类",width:"80"}}),t._v(" "),n("el-table-column",{attrs:{prop:"Belong",label:"隶属公司",width:"100"}}),t._v(" "),n("el-table-column",{attrs:{prop:"ContractCode",label:"合同号",width:"180"}}),t._v(" "),n("el-table-column",{attrs:{prop:"Sent",label:"发货",width:"80"}}),t._v(" "),n("el-table-column",{attrs:{label:"合同金额",width:"110",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.FinancialAmountFormat(e.row.ContractAmount)))]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"实际合同额",width:"110",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.FinancialAmountFormat(e.row.ActualContractAmount)))]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"TimeStr",label:"合同确认日期",width:"120"}}),t._v(" "),n("el-table-column",{attrs:{label:"回款进度",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.ProgressOfPay+"%"))]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"开票总额",width:"110",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.FinancialAmountFormat(e.row.InvoiceAmount)))]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"回款总额",width:"110",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.FinancialAmountFormat(e.row.PayAmount)))]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"退款合计",width:"110",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.FinancialAmountFormat(e.row.ReturnAmount)))]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"实际回款",width:"110",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.FinancialAmountFormat(e.row.RealityPayAmount)))]}}])}),t._v(" "),t._l(t.InvoicesBigLength,function(e){return n("el-table-column",{directives:[{name:"show",rawName:"v-show",value:t.InvoicesBigLength,expression:"InvoicesBigLength"}],key:e+"Iindex",attrs:{width:"120",label:"第"+e+"次开票"},scopedSlots:t._u([{key:"default",fn:function(a){return["已开票"==a.row["Invoices_"+(e-1)].Key?n("span",{staticStyle:{color:"#67C23A"}},[t._v(t._s(t.simplicity(a.row["Invoices_"+(e-1)])))]):"等待开票"==a.row["Invoices_"+(e-1)].Key?n("span",{staticStyle:{color:"#E6A23C"}},[t._v(t._s(t.simplicity(a.row["Invoices_"+(e-1)])))]):n("span",{staticClass:"invalid"},[t._v(t._s(t.simplicity(a.row["Invoices_"+(e-1)])))]),t._v(" "),n("p",[t._v(t._s(a.row["Invoices_"+(e-1)].Other))])]}}],null,!0)})}),t._v(" "),t._l(t.PaysBigLength,function(e){return n("el-table-column",{directives:[{name:"show",rawName:"v-show",value:t.PaysBigLength,expression:"PaysBigLength"}],key:e+"Pindex",attrs:{width:"150",label:"第"+e+"次回款"},scopedSlots:t._u([{key:"default",fn:function(a){return[n("div",{staticClass:"parent_box"},["已付款"==a.row["Pays_"+(e-1)].Key?n("span",{staticStyle:{color:"#67C23A"}},[t._v(t._s(t.simplicity(a.row["Pays_"+(e-1)])))]):n("span",{staticStyle:{color:"#E6A23C"}},[t._v(t._s(t.simplicity(a.row["Pays_"+(e-1)])))]),t._v(" "),n("p",[n("span",{staticStyle:{width:"40px",display:"block",float:"left"}},[t._v(t._s(a.row["Pays_"+(e-1)].Value))]),t._v(" "),t._v("\n                            "+t._s(a.row["Pays_"+(e-1)].Other)+"\n                        ")])])]}}],null,!0)})}),t._v(" "),t._l(t.ReturnsBigLength,function(e){return n("el-table-column",{directives:[{name:"show",rawName:"v-show",value:t.ReturnsBigLength,expression:"ReturnsBigLength"}],key:e+"rindex",attrs:{width:"150",label:"第"+e+"次退款"},scopedSlots:t._u([{key:"default",fn:function(a){return[n("p",{class:{invalid:"无效"==a.row["Returns_"+(e-1)].Key},staticStyle:{color:"#67C23A"}},[t._v("\n                        "+t._s(t.simplicity(a.row["Returns_"+(e-1)])))]),t._v(" "),n("p",[n("span",{staticStyle:{width:"40px",display:"block",float:"left"}},[t._v(t._s(a.row["Returns_"+(e-1)].Value))]),t._v("\n                        "+t._s(a.row["Returns_"+(e-1)].Other)+"\n                    ")])]}}],null,!0)})})],2),t._v(" "),n("p",[t._v("共 "+t._s(t.DataBars)+" 条")])],1)],1)},staticRenderFns:[]};var h=n("VU/8")(c,u,!1,function(t){n("6+UJ")},"data-v-04016d52",null);e.default=h.exports},"6+UJ":function(t,e){}});