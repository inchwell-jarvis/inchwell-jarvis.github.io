webpackJsonp([46],{d86H:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={data:function(){return{WorkDailyDetailDto:{},imageUrlList:[],uploadFileUrlapp:"https://httpbin.org/post",imgVideoBase64List:[],Describe:[],Arrange:[],ImagesPage:0,loading:!1,loadingText:"",Isitover:!1,Other:""}},computed:{},watch:{},methods:{UpdataIf:function(){var e=this;this.$confirm("上传后不可修改, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.UpaData()}).catch(function(){e.$message({type:"info",message:"已取消"})})},UpaData:function(){var e=this;if(""==this.Other)return this.$message.warning("请选择本次日报是否同时进行了回访?");console.log(this.imgVideoBase64List);for(var t=[],i=[],a=0;a<this.Describe.length;a++){var s=this.Describe[a].text;""!=s&&void 0!=s&&t.push(s)}for(var o=0;o<this.Arrange.length;o++){var n=this.Arrange[o].text;""!=n&&void 0!=n&&i.push(n)}console.log(t),console.log(i),this.loading=!0,this.loadingText="正在上传文字内容 ~ ";var l={WorkDailyId:this.$store.state.Vuex.Id,Contents:t,Plans:i};this.API_POST("PCenter/AddWorkDailyContent",l).then(function(t){0!=e.imgVideoBase64List.length?(e.iFbase64(),e.loadingText="正在上传图片 ~ "):(e.loading=!1,e.loadingText="",e.Code0())})},iFbase64:function(){this.imgVideoBase64List.length==this.ImagesPage?(this.loading=!1,this.loadingText="上传完成！",console.log("上传完成！"),this.Code0()):(this.Upimages(),this.ImagesPage+=1,this.loadingText="正在上传第"+this.ImagesPage+"张图片 ~ ")},Upimages:function(){var e=this,t=this.imgVideoBase64List[this.ImagesPage].base64;this.API_POST("PCenter/UploadWorkDailyPhoto",{Id:this.$store.state.Vuex.Id,FileStr:t}).then(function(t){e.iFbase64()})},Code0:function(){var e=this,t={Id:this.$store.state.Vuex.Id,type:this.Isitover?1:0,Other:this.Other};this.API_POST("PCenter/UploadWorkDaily",t).then(function(t){e.$emit("refresh"),e.$router.push({path:"work-log"})})},start:function(){var e=this;this.API_GET("PCenter/GetWorlDaily",{workdailyId:this.$store.state.Vuex.Id}).then(function(t){console.log(t),e.WorkDailyDetailDto=t.WorkDailyDetailDto})},beforeuploadMainGraph:function(e){var t=(e.size/1024/1024).toFixed(3);if(console.log(t+"MB"),console.log(e),t>10&&"video/mp4"==e.type)return this.$message.warning("视频文件大小不得超过10MB"),!1;var i=this,a=new FileReader;a.readAsDataURL(e),a.onload=function(t){var s=a.result;i.imgVideoBase64List.push({uid:e.uid,base64:s})}},handleSuccessMainGraph:function(e,t,i){this.imageUrlList=i},handlePreviewMainGraph:function(e){this.imageUrl.type=e.raw.type,this.imageUrl.url=e.url,console.log(e),this.dialogVisibleMainGraph=!0},beforeremoveMainGraph:function(e,t){},handleRemoveMainGraph:function(e,t){console.log(e.uid);for(var i=0;i<this.imgVideoBase64List.length;i++){this.imgVideoBase64List[i].uid===e.uid&&this.imgVideoBase64List.splice(i,1)}console.log(this.imgVideoBase64List)}},created:function(){console.log(this.$store.state.Vuex.Id),this.start()}},s={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("SaxoPage",{scopedSlots:e._u([{key:"title",fn:function(){return[i("saxo-button",{attrs:{mini:""},on:{click:function(t){return e.UpdataIf()}}},[e._v("上传")])]},proxy:!0},{key:"content",fn:function(){return[i("h3",[e._v("日报基础信息")]),e._v(" "),i("div",{staticClass:"setUp"},[i("div",{staticClass:"labelFronLong"},[i("p",[i("span",[e._v("客户")]),e._v(e._s(e.WorkDailyDetailDto.CustomerName))])]),e._v(" "),i("div",{staticClass:"labelFron"},[i("p",[i("span",[e._v("服务日期")]),e._v(e._s(e.WorkDailyDetailDto.ServiceDate))])]),e._v(" "),i("div",{staticClass:"labelFron"},[e.WorkDailyDetailDto.CreateDate?i("p",[i("span",[e._v("创建时间")]),e._v(e._s(e.WorkDailyDetailDto.CreateDate.split("T")[0]))]):e._e()]),e._v(" "),i("div",{staticClass:"labelFron"},[i("p",[i("span",[e._v("工程师")]),e._v(e._s(e.WorkDailyDetailDto.Engineer))])]),e._v(" "),i("div",{staticClass:"labelFron"},[i("p",[i("span",[e._v("服务类型")]),e._v(e._s(e.WorkDailyDetailDto.ServiceType))])]),e._v(" "),i("div",{staticClass:"labelFron"},[i("p",[i("span",[e._v("型号")]),e._v(e._s(e.WorkDailyDetailDto.ModelNumber))])]),e._v(" "),i("div",{staticClass:"labelFron"},[i("p",[i("span",[e._v("序列号")]),e._v(e._s(e.WorkDailyDetailDto.SerialNumber))])])]),e._v(" "),i("h3",[e._v("联系人")]),e._v(" "),i("div",{staticClass:"setUp"},[i("div",{staticClass:"labelFron"},[i("p",[i("span",[e._v("联系人")]),e._v(e._s(e.WorkDailyDetailDto.LinkMan))])]),e._v(" "),i("div",{staticClass:"labelFron"},[i("p",[i("span",[e._v("电话")]),e._v(e._s(e.WorkDailyDetailDto.LinkTel))])]),e._v(" "),i("div",{staticClass:"labelFronText"},[i("p",[i("span",[e._v("邮箱")]),e._v(e._s(e.WorkDailyDetailDto.LinkEmail))])])]),e._v(" "),i("h3",[e._v("是否完结")]),e._v(" "),i("el-switch",{staticStyle:{"margin-left":"30px"},attrs:{"active-text":"已完结","inactive-color":"red","inactive-text":"未完结"},model:{value:e.Isitover,callback:function(t){e.Isitover=t},expression:"Isitover"}}),e._v(" "),i("h3",[e._v("本次日报是否同时进行了回访?")]),e._v(" "),i("el-radio-group",{model:{value:e.Other,callback:function(t){e.Other=t},expression:"Other"}},[i("el-radio",{attrs:{label:3}},[e._v("是")]),e._v(" "),i("el-radio",{attrs:{label:6}},[e._v("否")])],1),e._v(" "),i("h3",[e._v("工作描述/预计工作安排")]),e._v(" "),i("div",{staticClass:"ForTextHead"},[e._v("工作描述   "),i("i",{staticClass:"el-icon-circle-plus-outline Add",on:{click:function(t){return e.Describe.push({text:""})}}})]),e._v(" "),e._l(e.Describe,function(t,a){return i("div",{key:a+"sss",staticClass:"ForText"},[i("i",{staticClass:"el-icon-delete-solid del",on:{click:function(t){return e.Describe.splice(a,1)}}}),e._v(" "),i("el-input",{staticStyle:{marginTop:"5px"},attrs:{type:"textarea",autosize:"",placeholder:"请输入工作描述"},model:{value:t.text,callback:function(i){e.$set(t,"text",i)},expression:"item.text"}})],1)}),e._v(" "),i("div",{staticClass:"ForTextHead"},[e._v("工作安排   "),i("i",{staticClass:"el-icon-circle-plus-outline Add",on:{click:function(t){return e.Arrange.push({text:""})}}})]),e._v(" "),e._l(e.Arrange,function(t,a){return i("div",{key:a,staticClass:"ForText"},[i("i",{staticClass:"el-icon-delete-solid del",on:{click:function(t){return e.Arrange.splice(a,1)}}}),e._v(" "),i("el-input",{staticStyle:{marginTop:"5px"},attrs:{type:"textarea",autosize:"",placeholder:"请输入预计工作安排"},model:{value:t.text,callback:function(i){e.$set(t,"text",i)},expression:"Arrangeitem.text"}})],1)}),e._v(" "),i("h3",[e._v("图片")]),e._v(" "),i("el-upload",{attrs:{action:e.uploadFileUrlapp,data:{attachType:0},name:"appFile",limit:10,multiple:!0,accept:"image/*,video/*","before-upload":e.beforeuploadMainGraph,"on-success":e.handleSuccessMainGraph,"on-preview":e.handlePreviewMainGraph,"before-remove":e.beforeremoveMainGraph,"on-remove":e.handleRemoveMainGraph,"list-type":"picture-card","file-list":e.imageUrlList}},[i("i",{staticClass:"el-icon-plus spc1"})])]},proxy:!0}])})},staticRenderFns:[]};var o=i("VU/8")(a,s,!1,function(e){i("zNg3")},"data-v-d2fea8e2",null);t.default=o.exports},zNg3:function(e,t){}});