webpackJsonp([187],{"5B3w":function(t,e){},L0co:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n("Dd8w"),i=n.n(a),s=n("d7EF"),o=n.n(s),l=n("mvHQ"),r=n.n(l),c=n("uXZL"),u=n.n(c),p=n("PXCl").Base64,d={data:function(){return{CapitalPoolDtos:[],SaxoDrawer:!1,Id:"",MSO:{},total:0,Datatable:[],InvoiceTypeS:[{value:1,label:"增值税普通发票"},{value:2,label:"增值税专用发票"}],PayTypes:[{value:1,label:"先付款后发货"},{value:2,label:"先发货后付款"}],BJState:!1,TypeOfShippings:[{value:"陆运",label:"陆运"},{value:"海运",label:"海运"},{value:"空运",label:"空运"}],IsShowOriginalAmounts:[{value:!0,label:"展示"},{value:!1,label:"不展示"}],DateOfDeliverys:["1-2 weeks","2-4 weeks","4-6 weeks","6-8 weeks","8-12 weeks","12-16 weeks","16-20 weeks","现货供应","交期不定"],DateOfDeliverysIndex999:"交货期",DateOfDeliverysIndex999Length:0,Discount:0,PriceSynchronization:!1,ModifyPriceID:{},PaymentAmount:"",MacSODispatchOrderDtosStateStr:0,InvoiceID:"",LastDeliveryTimes:"",LogisticDtos:[],textarea:"",x:"",y:"",display:!1,Applicant:{},discountindex:0,Remarks:"",CustomDeliveryDate:"",CustomDeliveryDate2:"",OrderTemplate:!1,tableData3:[],total3:0,pagesize3:0,pageNum3:1,search:"",add_table_length:0,DeviceDatabaseShow:!1,Memo:"",BuyerBuyingOnCreditAmount:0,Subscription:0,Consignee:{},MachineSOEquDtosFHD:[],ApplySent:void 0,PointingDevice:void 0,PutUpAndExpandbool:!1,PutUpAndExpandbool2:!1,OtherBool:"0",MachineSOEquDtosSeach:"",fireds:[{value:"已发完",label:"已发完"},{value:"未发完",label:"未发完"}],Amount_to_be_fired:"",retrievalData:[],dialogVisible:!1,receiverTableData:[]}},computed:{newCapitalPoolDtos:function(){return JSON.parse(r()(this.CapitalPoolDtos))}},watch:{newCapitalPoolDtos:function(t){var e=this;this.Subscription=0,t.forEach(function(t){t.Number>0&&(e.Subscription+=Number(t.Number))})}},methods:{SeeApplyEquipment:function(t){console.log(t),this.$router.push({path:"machine-sales-replace-equipment-see",query:{ID:t.ID}})},SavePrizeWinners:function(){var t=this;console.log(this.MSO.PrizeWinnersList);for(var e=0,n=0;n<this.MSO.PrizeWinnersList.length;n++){var a=this.MSO.PrizeWinnersList[n];if(!a.name||!a.value)return this.$message.warning("第"+(n+1)+"项错误，请修正！"),!1;e+=Number(a.value)}if(console.log(e),100!=e)return this.$message.warning("提成比例之和应为 100"),!1;for(var i="",s=0;s<this.MSO.PrizeWinnersList.length;s++){var o=this.MSO.PrizeWinnersList[s];i+=o.name+":"+o.value,s+1!=this.MSO.PrizeWinnersList.length&&(i+="|")}this.API_POST("MachineSO/MsoAllocationPrize",{Id:this.Id,str:i}).then(function(e){t.$message.success("修改成功！"),t.$refs.primary.start(),t.start()})},PrizeWinnersListDel:function(t){console.log(t)},CommissionFun:function(){9!=this.MSO.State&&this.$refs.primary.start()},SaveMemo:function(){var t=this;this.API_POST("MachineSO/SaveMSOMemo",{ID:this.Id,Str:this.Remarks}).then(function(e){t.$message.success("保存成功！"),t.start()})},PaymentRatio100:function(t){var e=t.split(",");1==e.length&&100!=Number(t)&&this.$message.warning("付款比例之和必须等于100"),2==e.length&&Number(e[0])+Number(e[1])!=100&&this.$message.warning("付款比例之和必须等于100"),3==e.length&&Number(e[0])+Number(e[1])+Number(e[2])!=100&&this.$message.warning("付款比例之和必须等于100")},ExportExcel:function(){if(console.log(this.retrievalData),0==this.retrievalData.length)return this.$message.warning("表格无数据！"),!1;var t="\n                <tr>\n                    <th>产品编码</th>\n                    <th>产品描述</th>\n                    <th>订单数量</th>\n                    <th>已发量</th>\n                    <th>待发量</th>\n                    <th>库位</th>\n                </tr>\n            ";this.retrievalData.forEach(function(e){var n="";e.LocationList.length&&"无"!=e.LocationList&&(console.log(e.LocationList),e.LocationList.forEach(function(t){n+="供应商库"!=t.split("-")[0]?t:t.split("-")[0]+"-"+t.split(",")[1]})),t+="\n                    <tr>\n                        <td>"+e.ProductCode+"&nbsp;</td>\n                        <td>"+e.Describe+"</td>\n                        <td>"+e.Quantity+"</td>\n                        <td>"+e.ThisSent+"</td>\n                        <td>"+e.WatiSent+"</td>\n                        <td>"+n+"</td>\n                    </tr>\n                "}),this.downloadTable(t,"发货清单"+this.Amount_to_be_fired)},DeleteInvoices:function(t){var e=this;this.API_POST("Finance/DelInvoice",{ID:t.ID}).then(function(t){e.$message.success("删除成功！"),e.start()})},OperationInvoice:function(t){var e=this;this.$prompt("请输入内容","操作发票",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(n){var a=n.value;e.API_POST("Finance/ApplyHandleInvoice",{ID:t.ID,Str:a}).then(function(t){e.$message.success("操作成功"),e.start()})}).catch(function(){e.$message("取消操作发票")})},LookReturnRefund_fun:function(t){console.log(t.ID),this.$router.push({path:"/MachineSOGetFinanceMSOReturnsEdit",query:{row:t,mode:!1}})},ReplaceEquipment:function(){this.$router.push({path:"/machine-sales-replace-equipment",query:{Id:this.Id,EquDtos:this.MSO.MachineSOEquDtos}})},ReturnRefund_fun:function(){this.$router.push({path:"/ReturnRefund",query:{Id:this.Id,From:1,EquDtos:this.MSO.MachineSOEquDtos}})},retrievalMSO:function(){var t=this,e=JSON.parse(r()(this.MSO.MachineSOEquDtos)),n=[];""!=this.MachineSOEquDtosSeach?e.forEach(function(e){-1!=(String(e.ProductCode)+String(e.Describe)).indexOf(t.MachineSOEquDtosSeach)&&n.push(e)}):n=e;var a=[];""!=this.Amount_to_be_fired?("已发完"==this.Amount_to_be_fired&&n.forEach(function(t){0==t.WatiSent&&a.push(t)}),"未发完"==this.Amount_to_be_fired&&n.forEach(function(t){t.WatiSent>0&&a.push(t)})):a=n,this.retrievalData=a},MsoAmountRounding:function(t){var e=this;this.$prompt("当前金额为："+t,"金额抹零",{confirmButtonText:"确定",cancelButtonText:"取消",inputPlaceholder:"抹零范围不得大于10元！"}).then(function(t){var n=t.value;if(!isNaN(parseFloat(n))&&isFinite(n)){var a={Id:e.Id,Str:n};e.API_POST("MachineSO/MsoAmountRounding",a).then(function(t){e.SaxoDrawer=!1,e.$message.success("抹零成功！"),e.start()})}else e.$message.warning("请输入数值！")}).catch(function(){e.$message.info("已取消抹零！")})},goAnchor:function(t){document.querySelector(t).scrollIntoView({behavior:"smooth"})},getFile:function(t){var e=t.target.files[0];this.exportData(e),t.target.value=""},exportData:function(t){var e=this,n=new FileReader;FileReader.prototype.readAsBinaryString=function(t){var n,a,i="",s=new FileReader;s.onload=function(t){for(var o=new Uint8Array(s.result),l=o.byteLength,r=0;r<l;r++)i+=String.fromCharCode(o[r]);n=u.a.read(i,{type:"binary"}),a=u.a.utils.sheet_to_json(n.Sheets[n.SheetNames[0]]),e.fillIn(a)},s.readAsArrayBuffer(t)},n.readAsBinaryString(t)},ChinesetoEnglish:function(t){},fillIn:function(t){var e=this;console.log(t);var n=[];if(t.forEach(function(t){1!=t.__rowNum__&&n.push({Number:t.__EMPTY,ProName:t["整机销售发货设备上传"],SellingPrice:t.__EMPTY_1,Other:t.__EMPTY_2})}),console.log(n),0==n.length)return this.$message.error("没有在表内找到数据"),!1;this.API_POST("MachineSO/AddMSOEqus2",{Id:this.Id,Euqs:n}).then(function(t){e.SaxoDrawer=!1,e.$message.success("上传成功"),e.start()})},download:function(){for(var t=this.MSO.CusFullName+"_设备清单",e="height:40px;line-height:40px;font-size:20px;font-weight: bold;",n="height:40px;line-height:40px;font-size:20px;text-align: left;",a="text-align: left;",i="text-align: right;",s="",o=0;o<this.MSO.MachineSOEquDtos.length;o++){var l=this.MSO.MachineSOEquDtos[o];s+="<tr>\n                    <td style='"+a+"'>"+(o+1)+"</td>\n                    <td style='"+a+"'>"+l.ProductCode+"</td>\n                    <td style='"+a+"'>"+l.Describe+"</td>\n                    <td>"+l.NetInventory0+"</td>\n                    <td>"+l.NetInventory1+"</td>\n                    <td>"+l.NetInventory2+"</td>\n                    <td>"+l.NetInventory3+"</td>\n                    <td>"+l.NetInventory4+"</td>\n                    <td>"+l.DateOfDelivery+"</td>\n                    <td  style='"+i+"'>￥"+l.OriginalPrice.toFixed(2)+"</td>\n                    <td  style='"+i+"'>"+l.Discount+"%</td>\n                    <td  style='"+i+"'>￥"+l.DiscountPrice.toFixed(2)+"</td>\n                    <td  style='"+i+"'>￥"+(l.DiscountPrice*l.Quantity).toFixed(2)+"</td>\n                    <td  style='"+a+"'>"+l.Quantity+"</td>\n\n                    <td  style='"+a+"'>"+l.NoSentQuantity+"</td>\n                    <td  style='"+a+"'>"+l.ReturnQuantity+"</td>\n                    <td  style='"+a+"'>"+l.DeliverQuantity+"</td>\n                    <td  style='"+a+"'>"+l.WatiSent+"</td>\n\n                </tr>\n                "}var r='\n\n            <html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">\n                <head>\n                <meta charset="utf-8">\n                </head>\n                <body>\n                <table border=1 style="font-family: "宋体";padding:10px">\n\n                    <tr>\n                       <th colspan=\'18\' style=\'font-size:40px;line-height:100px;height:100px;color:rgb(20,25,244)\'>'+t+"</th>\n                    </tr>\n\n                    <tr>\n                       <td colspan='3' style='"+e+"'>创建时间</td>\n                       <td colspan='15' style='"+n+"'>"+this.MSO.CreateDateStr+" </td>\n                    </tr>\n                    <tr>\n                       <td colspan='3' style='"+e+"'>订单编号</td>\n                       <td colspan='15' style='"+n+"'>"+this.MSO.SOCode+"</td>\n                    </tr>\n                    <tr>\n                       <td colspan='3' style='"+e+"'>客户类型</td>\n                       <td colspan='15' style='"+n+"'>"+this.MSO.CusType+"</td>\n                    </tr>\n\n                    <tr>\n                       <td colspan='3' style='"+e+"'>订单状态</td>\n                       <td colspan='15' style='"+n+"'>"+this.MSO.StateStr+"</td>\n                    </tr>\n                    <tr>\n                       <td colspan='3' style='"+e+"'>联系人</td>\n                       <td colspan='15' style='"+n+"'>"+this.MSO.CusLinkMan.ChineseName+"</td>\n                    </tr>\n                    <tr>\n                       <td colspan='3' style='"+e+"'>手 机</td>\n                       <td colspan='15' style='"+n+"'>"+this.MSO.CusLinkMan.MobilePhone+" </td>\n                    </tr>\n                    <tr>\n                       <td colspan='3' style='"+e+"'>EMail</td>\n                       <td colspan='15' style='"+n+"'>"+this.MSO.CusLinkMan.EMail+"</td>\n                    </tr>\n                    <tr>\n                       <td colspan='3' style='"+e+"'>地 址</td>\n                       <td colspan='15' style='"+n+"'>"+this.MSO.CusLinkMan.Address+"</td>\n                    </tr>\n\n                    <tr style='height:60px;line-height:60px;font-size:25px;margin:0 20px'>\n                       <th>序号</th>\n                       <th>产品编码</th>\n                       <th>描述</th>\n                       <th>采购中</th>\n                       <th>在途</th>\n                       <th>在库</th>\n                       <th>销售量</th>\n                       <th>净库存</th>\n                       <th>交货期</th>\n                       <th>原始单价</th>\n                       <th>折扣</th>\n                       <th>优惠后单价</th>\n                       <th>优惠后合计</th>\n                       <th>数量</th>\n\n                       <th>不需发货量</th>\n                       <th>退货量</th>\n                       <th>已发货量</th>\n                       <th>待发量</th>\n                    </tr>\n                    "+s+"\n                </table>\n                </body>\n                </html>",c=document.createElement("a");c.download=t+".xls",c.href="data:application/vnd.ms-excel;base64,"+window.btoa(unescape(encodeURIComponent(r))),document.body.appendChild(c),c.click(),document.body.removeChild(c)},DownloadShippingList:function(t){var e=this;console.log(t);var n=this.MSO.MacSODispatchOrderDtos[t].MacSODispatchOrderGoods,a=this.MSO.MacSODispatchOrderDtos[t].CusLinkMan;console.log(n);var i=[];n.forEach(function(t){0!=t.SentNumer&&(t.From="供应商库"!=t.From.split("-")[0]?t.From:t.From.split("-")[0]+"-"+t.From.split("-")[2],i.push(t))}),i.forEach(function(t){e.MSO.MachineSOEquDtos.forEach(function(e){t.ProductId==e.ProductId&&(t.ProductCode=e.ProductCode,t.Describe=e.Describe,t.serialNumber=e.serialNumber)})}),i.sort(function(t,e){return t.serialNumber<e.serialNumber?-1:t.serialNumber>e.serialNumber?1:t.serialNumber==e.serialNumber?0:void 0}),console.log(i);for(var s=this.MSO.CusFullName+"_"+this.MSO.SOCode+"_发货单_"+(Number(t)+1),o="height:40px;line-height:40px;font-size:20px;font-weight: bold;",l="height:40px;line-height:40px;font-size:20px;text-align: left;",r="text-align: left;font-size:18px;",c="text-align: center;font-size:18px;",u=new Date,p="",d=0;d<i.length;d++){var h=i[d];p+="<tr>\n                    <td style='"+c+"'>"+h.serialNumber+"</td>\n                    <td style='"+r+"'>"+h.ProductCode+"</td>\n                    <td style='"+r+"'>"+h.Describe+"</td>\n                    <td style='"+r+"'>"+h.From+"</td>\n                    <td style='"+c+"'>"+h.SentNumer+"</td>\n                </tr>\n                "}var m='\n\n            <html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">\n                <head>\n                <meta charset="utf-8">\n                </head>\n                <body>\n                <table border=1 style="font-family: "宋体";padding:10px">\n\n                    <tr>\n                       <th colspan=\'5\' style=\'font-size:40px;line-height:100px;height:100px;color:rgb(20,25,244)'+"'>北京英之杰天祥发货单</th>\n                    </tr>\n\n                    <tr>\n                       <td colspan='2' style='"+o+"'>客户名称</td>\n                       <td colspan='3' style='"+l+"'>"+this.MSO.CusFullName+"</td>\n                    </tr>\n                    <tr>\n                       <td colspan='2' style='"+o+"'>订单编号</td>\n                       <td colspan='3' style='"+l+"'>"+this.MSO.SOCode+"</td>\n                    </tr>\n                    <tr>\n                       <td colspan='2' style='"+o+"'>联系人</td>\n                       <td colspan='3' style='"+l+"'>"+a.ChineseName+"</td>\n                    </tr>\n                    <tr>\n                       <td colspan='2' style='"+o+"'>手 机</td>\n                       <td colspan='3' style='"+l+"'>"+a.MobilePhone+"</td>\n                    </tr>\n                    <tr>\n                       <td colspan='2' style='"+o+"'>地 址</td>\n                       <td colspan='3' style='"+l+"'>"+a.Address+"</td>\n                    </tr>\n                    <tr>\n                       <td colspan='2' style='"+o+"'>当前日期</td>\n                       <td colspan='3' style='"+l+"'>"+u.getFullYear()+"/"+(u.getMonth()+1)+"/"+u.getDate()+" "+u.getHours()+" : "+u.getMinutes()+" </td>\n                    </tr>\n\n                    <tr style='height:60px;line-height:60px;font-size:25px;margin:0 20px'>\n                       <th>序号</th>\n                       <th>产品编码</th>\n                       <th>描述</th>\n                       <th>库位</th>\n                       <th>发货数量</th>\n                    </tr>\n                    "+p+"\n                </table>\n                </body>\n                </html>",v=document.createElement("a");v.download=s+".xls",v.href="data:application/vnd.ms-excel;base64,"+window.btoa(unescape(encodeURIComponent(m))),document.body.appendChild(v),v.click(),document.body.removeChild(v)},AddMSOPaymentFun:function(){var t=this;console.log(this.CapitalPoolDtos);for(var e=[],n=0;n<this.CapitalPoolDtos.length;n++){var a=this.CapitalPoolDtos[n];isNaN(parseFloat(a.Number))||e.push({SourceId:a.ID,UsageAmount:Number(a.Number),From:"资金池"==a.LB||"不明款"==a.LB?1:2})}if(0==e.length)return this.$message.error("请输入使用量"),!1;var i={Id:this.Id,PayAmount:this.Subscription,UsageFeeDtos:e};this.API_POST("MachineSO/AddMSOPayment",i).then(function(e){t.SaxoDrawer=!1,t.$message.success("认款成功"),t.start()})},GetCusCapitalPool:function(){var t=this;this.CapitalPoolDtos=[],this.SaxoDrawer=!0;var e={cusId:this.MSO.CusId,onlyPart:!0,includebboc:!0,includebuming:!0};this.API_GET("CRM/GetCusCapitalPool",e).then(function(e){var n=e.BBOCDtos,a=e.CapitalPoolDtos;null!=n&&n.forEach(function(e){e.LB="挂帐款",e.CreateDate=e.CreateDate.split("T")[0],""!=e.SystemInfo&&null!=e.SystemInfo?e.SystemInfo2=e.SystemInfo.split("@"):e.SystemInfo2=[],t.CapitalPoolDtos.push(e)}),null!=a&&a.forEach(function(e){e.LB=e.Type,e.CreateDate=e.CreateDate.split("T")[0],""!=e.SystemInfo&&null!=e.SystemInfo?e.SystemInfo2=e.SystemInfo.split("@"):e.SystemInfo2=[],t.CapitalPoolDtos.push(e)}),console.log(t.CapitalPoolDtos)})},ShowFalse:function(t){this.DeviceDatabaseShow=t},DataBase:function(t){var e=this;console.log(t);for(var n=[],a=0;a<t.length;a++){var i=t[a];n.push({ProductId:i.ID,Number:i.Quantity})}var s={Id:this.Id,Euqs:n};this.API_POST("MachineSO/AddMSOEqus",s).then(function(t){e.start()})},AddSOInvoice:function(){this.$router.push({path:"/ZJbilling",query:{API:"MachineSO/AddMSOInvoice",Id:this.Id,CusId:this.MSO.CusId}})},handleCommand:function(t){var e="",n={};"1"==t&&(e="download/Purchase_and_sale_contract.html",n={url:p.encodeURI(this.$store.state.http+"MachineSO/GetMSO"),ID:p.encodeURI(this.Id),Number:p.encodeURI("1"),token:p.encodeURI(localStorage.getItem("token"))}),"2"==t&&(e="download/Purchase_and_sale_contract.html",n={url:p.encodeURI(this.$store.state.http+"MachineSO/GetMSO"),ID:p.encodeURI(this.Id),Number:p.encodeURI("0"),token:p.encodeURI(localStorage.getItem("token"))}),"3"==t&&(e="download/Quotation_of_complete_machine.html",n={url:p.encodeURI(this.$store.state.http+"MachineSO/GetMSO"),ID:p.encodeURI(this.Id),Number:p.encodeURI("1"),token:p.encodeURI(localStorage.getItem("token"))}),"4"==t&&(e="download/Quotation_of_complete_machine.html",n={url:p.encodeURI(this.$store.state.http+"MachineSO/GetMSO"),ID:p.encodeURI(this.Id),Number:p.encodeURI("0"),token:p.encodeURI(localStorage.getItem("token"))}),this.jump(e,n)},handleCommand2:function(t){if(5==t){var e={msoid:this.Id,token:localStorage.getItem("token"),url:this.$store.state.http+"MachineSO/MsoQuotation"};return this.jump("machine/PorscheGeneralQuote.html",e),!1}if(6==t){var n={msoid:this.Id,token:localStorage.getItem("token"),url:this.$store.state.http+"MachineSO/MsoQuotation"};return this.jump("machine/PorscheGeneralQuote_NO.html",n),!1}if(7==t){var a={msoid:this.Id,token:localStorage.getItem("token"),url:this.$store.state.http+"MachineSO/MsoQuotation"};return this.jump("machine/PorscheGeneralQuote_NO_discounted.html",a),!1}if(8==t){var i={msoid:this.Id,token:localStorage.getItem("token"),url:this.$store.state.http+"MachineSO/MsoQuotation"};return this.jump("machine/PorscheGeneralQuote_Holding.html",i),!1}if(9==t){var s={msoid:this.Id,token:localStorage.getItem("token"),url:this.$store.state.http+"MachineSO/MsoQuotation"};return this.jump("machine/PorscheGeneralQuote_Holding_NO0.html",s),!1}var o="",l={url:p.encodeURI(this.$store.state.http+"MachineSO/GetMSO"),ID:p.encodeURI(this.Id),token:p.encodeURI(localStorage.getItem("token")),Time:p.encodeURI(this.GetDate("/"))};"1"==t&&(o="download/MassSalesDepartment/index30.html"),"2"==t&&(o="download/MassSalesDepartment/index100.html"),"3"==t&&(o="download/MassSalesDepartment/HolidingIndex30.html"),"4"==t&&(o="download/MassSalesDepartment/HolidingIndex100.html"),this.jump(o,l)},addTemplate_li:function(t){var e=this,n={Id:this.Id,Euqs:[{ProductId:t.ProductId,Number:t.Quantity}]};this.API_POST("MachineSO/AddMSOEqus",n,!1).then(function(t){e.add_table_length-=1,0==e.add_table_length&&(e.OrderTemplate=!1,e.start())})},addTemplate:function(t){var e=this;this.API_GET("MachineSO/GetSOTemplate",{sotId:t.ID}).then(function(t){var n=t.Dto.EquDtos;console.log(n),e.add_table_length=n.length;for(var a=0;a<n.length;a++){var i=n[a];e.addTemplate_li(i)}})},func3:function(t,e){this.pagesize3=t,this.pageNum3=e,this.GetSOTemplates()},GetSOTemplates:function(){var t=this;this.OrderTemplate=!0;var e={search:this.search,pageNum:this.pageNum3,numPerPage:this.pagesize3,orderField:"",orderDirection:""};this.API_GET("MachineSO/GetSOTemplates",e).then(function(e){console.log("订单模板"),console.log(e),t.tableData3=e.Dtos;for(var n=0;n<t.tableData3.length;n++){var a=t.tableData3[n];a.CreateDate=a.CreateDate.split("T")[0],a.UpdateDt=a.UpdateDt.split("T")[0]}t.total3=e.DataBars})},forceUpdate:function(){this.$forceUpdate()},CustomDeliveryDateFun:function(t){console.log(t)},DateOfDeliverysFun:function(t){console.log(t);var e=this.DateOfDeliverysIndex999;t&&""!=this.CustomDeliveryDate2&&(e=this.CustomDeliveryDate2,this.CustomDeliveryDate2="",this.$forceUpdate()),this.DateOfDeliverysIndex999Length=this.MSO.MachineSOEquDtos.length;for(var n=0;n<this.MSO.MachineSOEquDtos.length;n++){var a=this.MSO.MachineSOEquDtos[n];a.DateOfDelivery=e,this.UpdateMSOEquPrice(a,999)}},Basic_information_modify_delivery_date:function(t){console.log(t)},PaymentAmountClick:function(){var t=this,e=Number(this.PaymentAmount);if(console.log(e),e){var n={url:this.$store.state.http+"MachineSO/AddMSOPayment",api:"post",data:{Id:this.Id,Str:e}};this.$https(n).then(function(e){t.$message({showClose:!0,message:"付款成功！",type:"success"}),t.start(),t.PaymentAmount=""})}else this.$message.error("请输入正确的金额！")},ConfirmToModifyThePrice:function(t){var e=this,n=t.DiscountPrice2,a=this.ModifyPriceID,i={url:this.$store.state.http+"MachineSO/UpdateMSOEquPrice",api:"post",data:{Id:t.ID,DateOfDelivery:t.DateOfDelivery,Discount:t.Discount,DiscountPrice:Number(n),Quantity:t.Quantity}};this.$https(i).then(function(t){var n=a.DiscountPrice2,i={url:e.$store.state.http+"MachineSO/UpdateMSOEquPrice",api:"post",data:{Id:a.ID,DateOfDelivery:a.DateOfDelivery,Discount:a.Discount,DiscountPrice:Number(n),Quantity:a.Quantity}};e.$https(i).then(function(t){e.$message({showClose:!0,message:"修改成功！",type:"success"}),e.start(),e.PriceSynchronization=!1})})},synchronization:function(t){this.ModifyPriceID=t,console.log(t);for(var e=this.subtract(t.DiscountPrice,t.DiscountPrice2)*t.Quantity,n=0;n<this.MSO.MachineSOEquDtos.length;n++){var a=this.MSO.MachineSOEquDtos[n];if(a.confirm=!1,a.ID!=t.ID){console.log(a.ID);var i=e/a.Quantity;a.DiscountPrice2=a.DiscountPrice+i,a.confirm=!0}}},add:function(t,e){return(Math.round(100*t)+Math.round(100*e))/100},subtract:function(t,e){return this.add(t,-e)},ZTdiscount:function(t){console.log(t),this.discountindex=this.MSO.MachineSOEquDtos.length;for(var e=0;e<this.MSO.MachineSOEquDtos.length;e++){var n=this.MSO.MachineSOEquDtos[e];this.UpdateMSOEquPrice(n,4,t)}},UpdateMSOEquPrice:function(t,e,n){var a=this,i=t.DiscountPrice;if(1!=e&&999!=e||console.log(t),98==e){if(""==this.CustomDeliveryDate)return this.$message({message:"不能输入空！",type:"warning"}),!1;var s=this;setTimeout(function(){s.$refs.selectAppType.blur()},50),t.DateOfDelivery=this.CustomDeliveryDate,this.CustomDeliveryDate=""}2==e&&console.log(t),3==e&&console.log(t),4==e&&(t.Discount=n);var o=t.Quantity;if("Del"==e||"Add"==e){if(1==t.Quantity&&"Del"==e)return this.dele(t),!1;o="Del"==e?t.Quantity-1:t.Quantity+1}"saxo"==e&&(o=n);var l={Id:t.ID,DateOfDelivery:t.DateOfDelivery,Discount:t.Discount,DiscountPrice:i,Quantity:o};this.API_POST("MachineSO/UpdateMSOEquPrice",l,!1).then(function(t){4==e?(a.discountindex-=1,0==a.discountindex&&(a.$message({showClose:!0,message:"修改成功！",type:"success"}),a.start())):999==e?(console.log("999"),a.DateOfDeliverysIndex999Length-=1,0==a.DateOfDeliverysIndex999Length&&(a.$message({showClose:!0,message:"修改成功！",type:"success"}),a.start(),a.DateOfDeliverysIndex999="交货期")):(a.$message({showClose:!0,message:"修改成功！",type:"success"}),a.start())})},CloseBHMso:function(){var t=this;this.API_POST("MachineSO/CloseBHMso",{Id:this.Id}).then(function(e){t.$message({showClose:!0,message:"备货结单成功！",type:"success"}),t.start()})},UpdateMSOStateEqu:function(t,e){var n=this,a={Id:this.Id,ToState:t,other:e,Remarks:this.Remarks};this.API_POST("MachineSO/UpdateMSOStateEqu",a).then(function(e){2==t&&n.$message({showClose:!0,message:"订单确认成功！",type:"success"}),9==t&&n.$message({showClose:!0,message:"订单撤单成功！",type:"success"}),7==t&&n.$message({showClose:!0,message:"订单报价成功！",type:"success"}),n.start()})},approval:function(t,e){var n=this,a={Id:this.Id,ToState:t,other:e,Remarks:this.Remarks};this.API_POST("MachineSO/MSOApprovalDiscount",a).then(function(t){n.$message({showClose:!0,message:"审批成功！",type:"success"}),n.start()})},start:function(){var t=this,e={msoId:this.Id};this.API_GET("MachineSO/GetMSO",e).then(function(e){t.MSO=e.MSO,t.Discount=t.MSO.Discount,console.log(t.MSO),t.Remarks=t.MSO.Remarks,t.Consignee=e.Consignee,console.log(t.MSO.PrizeWinners),t.MSO.PrizeWinnersList=t.MSO.PrizeWinners.split("|").map(function(t){var e=t.split(":"),n=o()(e,2);return{name:n[0],value:n[1]}}),console.log(t.MSO.PrizeWinnersList);for(var n=0;n<t.MSO.MachineSOPayments.length;n++){var a=t.MSO.MachineSOPayments[n];1==a.State&&(a.State="未开票"),1==a.State&&(a.State="已开票"),1==a.State&&(a.State="已作废"),a.ConfirmDt&&(a.ConfirmDt=a.ConfirmDt.split("T")[0]),""!=a.SystemInfo&&null!=a.SystemInfo?a.SystemInfo2=a.SystemInfo.split("@"):a.SystemInfo2=[]}for(var i=0;i<t.MSO.MachineSOEquDtos.length;i++){var s=t.MSO.MachineSOEquDtos[i];t.$set(s,"DiscountPrice2",Number(s.DiscountPrice)),t.$set(s,"apply",""),t.$set(s,"serialNumber",i+1),s.Locations?t.$set(s,"LocationList",s.Locations.split("、")):t.$set(s,"LocationList","无");for(var l=Object(),c=0;c<s.LocationList.length;c++)l[s.LocationList[c]]="";t.$set(s,"Obj",l),s.NetInventory0=Number(s.NetInventory.split("*")[0]),s.NetInventory1=Number(s.NetInventory.split("*")[1]),s.NetInventory2=Number(s.NetInventory.split("*")[2]),s.NetInventory3=Number(s.NetInventory.split("*")[3]),s.NetInventory4=Number(s.NetInventory.split("*")[4])}if(console.log(t.MSO.MacSODispatchOrderDtos.length),0==t.MSO.MacSODispatchOrderDtos.length||"申请中"!=t.MSO.MacSODispatchOrderDtos[t.MSO.MacSODispatchOrderDtos.length-1].Status?t.MacSODispatchOrderDtosStateStr=0:t.MacSODispatchOrderDtosStateStr=1,0!=t.MSO.MacSODispatchOrderDtos.length){t.InvoiceID=t.MSO.MacSODispatchOrderDtos[t.MSO.MacSODispatchOrderDtos.length-1].ID,t.LogisticDtos=[];for(var u=0,p=0;p<t.MSO.MacSODispatchOrderDtos.length;p++){var d=t.MSO.MacSODispatchOrderDtos[p];console.log(d);for(var h=[],m="",v=0;v<d.MacSODispatchOrderGoods.length;v++){var S=d.MacSODispatchOrderGoods[v];h.push(S),m+=S.From?S.From+" ":""}t.$set(d,"From",m);for(var _=0;_<t.MSO.MachineSOEquDtos.length;_++){var f=t.MSO.MachineSOEquDtos[_];t.$set(f,"Number"+p,""),t.LastDeliveryTimes="Number"+p;for(var y=0;y<h.length;y++){var b=h[y];f.ProductId==b.ProductId&&(f[String("Number"+p)]=b.ApplyNumer+"|"+b.SentNumer,f.ApplyNumerB=b.ApplyNumer,f.SentNumerB=b.SentNumer)}}t.LogisticDtos.push({Number:u,ApplyDt:d.ApplyDt,SentDt:d.SentDt}),u+=1}}if(t.retrievalData=JSON.parse(r()(t.MSO.MachineSOEquDtos)),void 0!=t.ApplySent){var O=t.ApplySent;t.ApplySent=void 0;var g=t;if(setTimeout(function(){g.goAnchor("#commercialInvoice")},500),console.log(O),console.log(g.MSO.MachineSOEquDtos),g.MacSODispatchOrderDtosStateStr)return t.$message({message:"已有正在申请中的发货",type:"warning"}),!1;console.log("开始填充数量！"),O.forEach(function(t){g.retrievalData.forEach(function(e){t.Id==e.ID&&(e.apply=t.OtherInt)})}),t.$message({message:"已填充申请发货数量,等待点击申请发货",type:"success"})}void 0!=t.PointingDevice&&t.retrievalData.forEach(function(e){if(e.ProductCode==t.PointingDevice){var n=t;setTimeout(function(){n.goAnchor("#"+t.PointingDevice+"_PointingDevice")},500)}}),console.log(t.MSO)})},oneClickApplicationForShipment:function(){for(var t=!1,e=0;e<this.retrievalData.length;e++){var n=this.retrievalData[e];console.log(n),n.NetInventory2>0&&(n.apply=n.NetInventory2>n.WatiSent?n.WatiSent:n.NetInventory2,t=!0)}t&&this.$message({message:"一键填充完成！",type:"success"}),t||this.$message({message:"没有符合填充要求的发货单",type:"warning"})},OneKeyDelivery:function(){for(var t=!1,e=[],n=0;n<this.retrievalData.length;n++){var a=this.retrievalData[n];if(console.log(a),null!=a.Locations&&-1==a.Locations.indexOf("、")){e.push(a);var i;if((i=a.ApplyNumerB-a.SentNumerB)>0){var s=Number(a.Locations.split("[")[1].split("]")[0]);for(var o in a.Obj)t=!0;a.Obj[o]=i<=s?i:s}}}t&&this.$message({message:"一键填充完成！",type:"success"}),t||this.$message({message:"没有符合填充要求的发货单",type:"warning"})},deliverGoods:function(){for(var t=this,e=[],n=0;n<this.retrievalData.length;n++){var a=this.retrievalData[n];for(var i in a.Obj)""!=a.Obj[i]&&e.push({ProductId:a.ProductId,Other:i.split(",")[0],Number:a.Obj[i]})}if(0==e.length)return this.$message({message:"请输入发货数量！",type:"warning"}),!1;console.log(e);var s={api:"post",url:this.$store.state.http+"MachineSO/MSOSent",data:{Id:this.InvoiceID,Euqs:e,Other:this.textarea,OtherBool:"1"==this.OtherBool}};this.$https(s).then(function(e){t.$message({message:"发货成功！",type:"success"}),t.start(),t.textarea=""})},applydeliverGoods:function(){for(var t=this,e=[],n=0;n<this.retrievalData.length;n++){var a=this.retrievalData[n];""!=a.apply&&e.push({ProductId:a.ProductId,Number:a.apply})}if(0==e.length)return this.$message.warning("请输入发货数量！");this.dialogVisible=!0,console.log(this.MSO.CusId),this.API_GET("CRM/GetCusLinkManMini",{cusId:this.MSO.CusId}).then(function(e){t.receiverTableData=e.Dtos.map(function(t){return i()({},t,{ChineseName:t.Name,MobilePhone:t.Mobile})}),console.log(t.receiverTableData)})},DetermineTheSender:function(){for(var t=this,e=[],n=0;n<this.retrievalData.length;n++){var a=this.retrievalData[n];""!=a.apply&&e.push({ProductId:a.ProductId,Number:a.apply})}var i=this.receiverTableData.filter(function(t){return t.Default});if(!i.length)return this.$message.warning("请选择收货人！");var s={Id:this.MSO.ID,Euqs:e,Other:this.textarea,CusLinkMan:i[0]};this.API_POST("MachineSO/MSOApplySent",s).then(function(e){t.$message.success("发货成功！"),t.start(),t.textarea="",t.dialogVisible=!1})},dele:function(t){var e=this;console.log(t);var n={api:"post",url:this.$store.state.http+"MachineSO/DelMSOEqu",data:{Id:t.ID}};this.$https(n).then(function(t){e.$message({message:"删除成功",type:"success"}),e.start()})},SaveMSOEqu:function(){var t=this,e=this.MSO.OriginalAmount,n=this.MSO.DiscountAmount;this.Discount!=this.MSO.Discount&&(n=e*(this.MSO.Discount/100));var a={url:this.$store.state.http+"MachineSO/SaveMSOEqu",api:"post",data:{ID:this.Id,Discount:this.MSO.Discount,TypeOfShipping:this.MSO.TypeOfShipping,TransportationCost:this.MSO.TransportationCost,TaxIncluded:this.MSO.TaxIncluded,InvoiceType:this.MSO.InvoiceType,PayType:this.MSO.PayType,OriginalAmount:e,DiscountAmount:n,IsShowOriginalAmount:this.MSO.IsShowOriginalAmount,CusLinkMan:this.MSO.CusLinkMan,Remarks:this.Remarks,DeliveryDate:this.MSO.DeliveryDate,PaymentRatio:this.MSO.PaymentRatio}};this.$https(a).then(function(e){t.BJState=!1,t.$message({message:"保存成功！",type:"success"}),t.start()})}},created:function(){this.Id=this.$route.query.Id,this.ApplySent=[],this.ApplySent=this.$route.query.ApplySent,this.PointingDevice=this.$route.query.PointingDevice,this.pagesize3=this.$store.state.DisplayNumber,this.start()},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){this.$emit("refresh")},destroyed:function(){},activated:function(){}},h={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("SaxoPage",{scopedSlots:t._u([{key:"title",fn:function(){return[t.BJState||-1==[1,6].indexOf(t.MSO.State)?t._e():n("saxo-button",{staticClass:"butState",attrs:{mini:"",type:"primary"},on:{click:function(e){t.BJState=!t.BJState}}},[t._v("编辑")]),t._v(" "),t.BJState?n("saxo-button",{staticClass:"butState",attrs:{mini:"",type:"success"},on:{click:t.SaveMSOEqu}},[t._v("保存")]):t._e(),t._v(" "),t.BJState?n("saxo-button",{staticClass:"butState",attrs:{mini:"",type:"danger"},on:{click:function(e){t.start,t.BJState=!t.BJState}}},[t._v("放弃")]):t._e(),t._v(" "),t.BJState||1!=t.MSO.State?t._e():n("saxo-button",{staticClass:"butState",attrs:{mini:"",plain:"",type:"danger"},on:{click:function(e){return t.UpdateMSOStateEqu(9)}}},[t._v("撤单")]),t._v(" "),t.BJState||7!=t.MSO.State?t._e():n("saxo-button",{staticClass:"butState",attrs:{mini:"",plain:"",type:"primary"},on:{click:function(e){return t.UpdateMSOStateEqu(2)}}},[t._v("确认")]),t._v(" "),t.BJState||1!=t.MSO.State?t._e():n("saxo-button",{staticClass:"butState",attrs:{mini:"",plain:"",type:"info"},on:{click:function(e){return t.UpdateMSOStateEqu(7)}}},[t._v("报价")]),t._v(" "),n("saxo-button",{staticClass:"butState",attrs:{mini:"",plain:"",type:"primary"},on:{click:function(e){return t.SaveMemo()}}},[t._v("仅保存备注")]),t._v(" "),"备货"==t.MSO.MSOType&&2==t.MSO.State?n("saxo-button",{staticClass:"butState",attrs:{mini:"",type:"primary"},on:{click:function(e){return t.CloseBHMso()}}},[t._v("备货结单")]):t._e(),t._v(" "),t.BJState||6!=t.MSO.State?t._e():n("el-button-group",{staticClass:"butState",attrs:{size:"mini"}},[n("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(e){return t.approval(7,1)}}},[t._v("批准")]),t._v(" "),n("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){return t.approval(7,0)}}},[t._v("驳回")])],1),t._v(" "),n("el-dropdown",{staticStyle:{float:"right",margin:"13px 10px","line-height":"30px"},attrs:{trigger:"click"},on:{command:t.handleCommand}},[n("span",{staticClass:"el-dropdown-link"},[t._v("\n                宝马模板"),n("i",{staticClass:"el-icon-printer el-icon--right"})]),t._v(" "),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{attrs:{command:"1",icon:"el-icon-takeaway-box"}},[t._v("购销合同 + 报价单(展示)")]),t._v(" "),n("el-dropdown-item",{attrs:{command:"2",icon:"el-icon-takeaway-box"}},[t._v("购销合同 + 报价单(不展示)")]),t._v(" "),n("el-divider",{staticStyle:{margin:"0"}}),t._v(" "),n("el-dropdown-item",{attrs:{command:"3",icon:"el-icon-takeaway-box"}},[t._v("报价单(展示原始合计金额)")]),t._v(" "),n("el-dropdown-item",{attrs:{command:"4",icon:"el-icon-takeaway-box"}},[t._v("报价单(不展示原始合计金额)")])],1)],1),t._v(" "),n("el-dropdown",{staticStyle:{float:"right",margin:"13px 10px","line-height":"30px"},attrs:{trigger:"click"},on:{command:t.handleCommand2}},[n("span",{staticClass:"el-dropdown-link"},[t._v("\n                保时捷模板"),n("i",{staticClass:"el-icon-printer el-icon--right"})]),t._v(" "),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{attrs:{command:"5",icon:"el-icon-takeaway-box"}},[t._v("报价单.xls")]),t._v(" "),n("el-dropdown-item",{attrs:{command:"6",icon:"el-icon-takeaway-box"}},[t._v("报价单(不展示单价).xls")]),t._v(" "),n("el-dropdown-item",{attrs:{command:"7",icon:"el-icon-takeaway-box"}},[t._v("报价单(不展示优惠价).xls")]),t._v(" "),n("el-dropdown-item",{attrs:{command:"8",icon:"el-icon-takeaway-box"}},[t._v("报价单(Holding).xls")]),t._v(" "),n("el-dropdown-item",{attrs:{command:"9",icon:"el-icon-takeaway-box"}},[t._v("报价单(Holding-不展示0元).xls")]),t._v(" "),n("el-divider",{staticStyle:{margin:"0"}}),t._v(" "),n("el-dropdown-item",{attrs:{command:"1",icon:"el-icon-takeaway-box"}},[t._v("购销合同 30%")]),t._v(" "),n("el-dropdown-item",{attrs:{command:"2",icon:"el-icon-takeaway-box"}},[t._v("购销合同 100%")]),t._v(" "),n("el-divider",{staticStyle:{margin:"0"}}),t._v(" "),n("el-dropdown-item",{attrs:{command:"3",icon:"el-icon-takeaway-box"}},[t._v("Holiding集团 购销合同 30%")]),t._v(" "),n("el-dropdown-item",{attrs:{command:"4",icon:"el-icon-takeaway-box"}},[t._v("Holiding集团 购销合同 100%")])],1)],1)]},proxy:!0},{key:"content",fn:function(){return[n("router-view",{on:{refresh:t.start}}),t._v(" "),n("saxo-pop",{ref:"primary",attrs:{type:"primary",title:"修改提成人",width:"600px"},on:{close:function(e){return t.$refs.primary.start()}}},[n("el-table",{attrs:{data:t.MSO.PrizeWinnersList}},[n("el-table-column",{attrs:{label:"姓名"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-input",{attrs:{placeholder:"请输入姓名",size:"mini"},model:{value:e.row.name,callback:function(n){t.$set(e.row,"name",n)},expression:"scope.row.name"}})]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"比例"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-input",{attrs:{placeholder:"请输入比例",size:"mini",type:"number"},model:{value:e.row.value,callback:function(n){t.$set(e.row,"value",n)},expression:"scope.row.value"}})]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("saxo-button",{attrs:{type:"danger",mini:""},on:{click:function(n){return t.MSO.PrizeWinnersList.splice(e.$index,1)}}},[t._v("删除")])]}}])},[n("template",{slot:"header"},[n("saxo-button",{attrs:{type:"success",mini:""},on:{click:function(e){return t.MSO.PrizeWinnersList.push({name:"",value:""})}}},[t._v("添加")])],1)],2)],1),t._v(" "),n("br"),t._v(" "),n("p",{staticStyle:{"line-height":"30px",padding:"10px","box-sizing":"border-box"}},[n("span",{staticStyle:{color:"#e6a23c"}},[t._v("请注意！所有提成人的所占比例之和应是 100 。")]),t._v(" "),n("saxo-button",{staticClass:"fr",attrs:{mini:""},on:{click:function(e){return t.SavePrizeWinners()}}},[t._v("保存")])],1)],1),t._v(" "),n("h3",[t._v("基础信息")]),t._v(" "),t.MSO.CreateDateStr?t._e():n("el-skeleton",{attrs:{rows:6,animated:""}}),t._v(" "),t.MSO.CreateDateStr&&!t.BJState?n("el-descriptions",{staticClass:"margin-top",attrs:{column:3,size:"mini",border:""}},[n("template",{slot:"extra"}),t._v(" "),n("el-descriptions-item",[n("template",{slot:"label"},[t._v("\n                    创建时间\n                ")]),t._v("\n                "+t._s("  "+t.MSO.CreateDateStr)+"\n            ")],2),t._v(" "),n("el-descriptions-item",[n("template",{slot:"label"},[t._v("\n                    付款时间\n                ")]),t._v("\n                "+t._s("  "+t.MSO.PayDateStr)+"\n            ")],2),t._v(" "),n("el-descriptions-item",[n("template",{slot:"label"},[n("i",{staticClass:"el-icon-mobile-phone"}),t._v("\n                    订单编号\n                ")]),t._v("\n                "+t._s("  "+t.MSO.SOCode)+"\n\n            ")],2),t._v(" "),n("el-descriptions-item",[n("template",{slot:"label"},[n("i",{staticClass:"el-icon-location-outline"}),t._v("\n                    客户名称\n                ")]),t._v("\n                "+t._s("  "+t.MSO.CusFullName)+"\n\n            ")],2),t._v(" "),n("el-descriptions-item",[n("template",{slot:"label"},[n("i",{staticClass:"el-icon-tickets"}),t._v("\n                    客户类型\n                ")]),t._v("\n                "+t._s("  "+t.MSO.CusType)+"\n            ")],2),t._v(" "),n("el-descriptions-item",[n("template",{slot:"label"},[t._v("\n\n                    区域\n                ")]),t._v("\n                "+t._s("  "+t.MSO.Area)+"\n            ")],2),t._v(" "),n("el-descriptions-item",[n("template",{slot:"label"},[t._v("\n\n                    订单状态\n                ")]),t._v("\n                "+t._s("  "+t.MSO.StateStr)+"\n            ")],2),t._v(" "),n("el-descriptions-item",[n("template",{slot:"label"},[t._v("\n\n                    发票类型\n                ")]),t._v("\n                "+t._s("  "+(1==t.MSO.InvoiceType?"增值税普通发票":"增值税专用发票"))+"\n            ")],2),t._v(" "),n("el-descriptions-item",[n("template",{slot:"label"},[t._v("\n\n                    付款方式\n                ")]),t._v("\n                "+t._s("  "+(1==t.MSO.PayType?"先付款后发货":"先发货后付款"))+"\n            ")],2),t._v(" "),n("el-descriptions-item",[n("template",{slot:"label"},[t._v("\n\n                    付款状态\n                ")]),t._v("\n                "+t._s("  "+t.MSO.PayStatusStr)+"\n            ")],2),t._v(" "),n("el-descriptions-item",[n("template",{slot:"label"},[t._v("\n\n                    类别\n                ")]),t._v("\n                "+t._s("  "+t.MSO.MSOType)+"\n            ")],2),t._v(" "),n("el-descriptions-item",[n("template",{slot:"label"},[t._v("\n\n                    是否展示原始合计金额\n                ")]),t._v("\n                "+t._s("  "+(t.MSO.IsShowOriginalAmount?"展示":"不展示"))+"\n            ")],2),t._v(" "),n("el-descriptions-item",[n("template",{slot:"label"},[t._v("\n\n                    销售\n                ")]),t._v("\n                "+t._s("  "+t.MSO.SalerName)+"\n            ")],2),t._v(" "),n("el-descriptions-item",[n("template",{slot:"label"},[t._v("\n\n                    付款比例\n                ")]),t._v("\n                "+t._s("  "+t.MSO.PaymentRatio)+"\n            ")],2),t._v(" "),n("el-descriptions-item",[n("template",{slot:"label"},[t._v("\n\n                    交货期\n                ")]),t._v("\n                "+t._s("  "+t.MSO.DeliveryDate)+"\n            ")],2),t._v(" "),n("el-descriptions-item",[n("template",{slot:"label"},[t._v("\n                    提成人\n                ")]),t._v(" "),n("span",{staticStyle:{cursor:"pointer"},on:{click:t.CommissionFun}},[t._v(t._s("  "+t.MSO.PrizeWinners)+"\n                    "),9!=t.MSO.State?n("i",{staticClass:"el-icon-edit"}):t._e()])],2)],2):t._e(),t._v(" "),t.MSO.CreateDateStr&&t.BJState?n("el-descriptions",{staticClass:"margin-top",attrs:{column:3,size:"mini",border:""}},[n("template",{slot:"extra"}),t._v(" "),n("el-descriptions-item",[n("template",{slot:"label"},[t._v("\n                    创建时间\n                ")]),t._v("\n                "+t._s("  "+t.MSO.CreateDateStr)+"\n            ")],2),t._v(" "),n("el-descriptions-item",[n("template",{slot:"label"},[t._v("\n                    付款时间\n                ")]),t._v("\n                "+t._s("  "+t.MSO.PayDateStr)+"\n            ")],2),t._v(" "),n("el-descriptions-item",[n("template",{slot:"label"},[t._v("\n                    订单编号\n                ")]),t._v("\n                "+t._s("  "+t.MSO.SOCode)+"\n\n            ")],2),t._v(" "),n("el-descriptions-item",[n("template",{slot:"label"},[t._v("\n                    客户名称\n                ")]),t._v("\n                "+t._s("  "+t.MSO.CusFullName)+"\n\n            ")],2),t._v(" "),n("el-descriptions-item",[n("template",{slot:"label"},[n("i",{staticClass:"el-icon-tickets"}),t._v("\n                    客户类型\n                ")]),t._v("\n                "+t._s("  "+t.MSO.CusType)+"\n            ")],2),t._v(" "),n("el-descriptions-item",[n("template",{slot:"label"},[t._v("\n\n                    区域\n                ")]),t._v("\n                "+t._s("  "+t.MSO.Area)+"\n            ")],2),t._v(" "),n("el-descriptions-item",[n("template",{slot:"label"},[t._v("\n\n                    订单状态\n                ")]),t._v("\n                "+t._s("  "+t.MSO.StateStr)+"\n            ")],2),t._v(" "),n("el-descriptions-item",[n("template",{slot:"label"},[t._v("\n\n                    发票类型\n                ")]),t._v(" "),n("el-select",{attrs:{placeholder:"请选择",size:"mini"},model:{value:t.MSO.InvoiceType,callback:function(e){t.$set(t.MSO,"InvoiceType",e)},expression:"MSO.InvoiceType"}},t._l(t.InvoiceTypeS,function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],2),t._v(" "),n("el-descriptions-item",[n("template",{slot:"label"},[t._v("\n\n                    付款方式\n                ")]),t._v(" "),n("el-select",{attrs:{placeholder:"请选择",size:"mini"},model:{value:t.MSO.PayType,callback:function(e){t.$set(t.MSO,"PayType",e)},expression:"MSO.PayType"}},t._l(t.PayTypes,function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],2),t._v(" "),n("el-descriptions-item",[n("template",{slot:"label"},[t._v("\n\n                    付款状态\n                ")]),t._v("\n                "+t._s("  "+t.MSO.PayStatusStr)+"\n            ")],2),t._v(" "),n("el-descriptions-item",[n("template",{slot:"label"},[t._v("\n\n                    类别\n                ")]),t._v("\n                "+t._s("  "+t.MSO.MSOType)+"\n            ")],2),t._v(" "),n("el-descriptions-item",[n("template",{slot:"label"},[t._v("\n\n                    是否展示原始合计金额\n                ")]),t._v(" "),n("el-select",{attrs:{placeholder:"请选择",size:"mini"},model:{value:t.MSO.IsShowOriginalAmount,callback:function(e){t.$set(t.MSO,"IsShowOriginalAmount",e)},expression:"MSO.IsShowOriginalAmount"}},t._l(t.IsShowOriginalAmounts,function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],2),t._v(" "),n("el-descriptions-item",[n("template",{slot:"label"},[t._v("\n\n                    销售\n                ")]),t._v("\n                "+t._s("  "+t.MSO.SalerName)+"\n            ")],2),t._v(" "),n("el-descriptions-item",[n("template",{slot:"label"},[t._v("\n\n                    付款比例\n                ")]),t._v(" "),n("el-input",{staticStyle:{width:"192px"},attrs:{placeholder:"20,30,50",size:"mini"},on:{change:t.PaymentRatio100},model:{value:t.MSO.PaymentRatio,callback:function(e){t.$set(t.MSO,"PaymentRatio",e)},expression:"MSO.PaymentRatio"}})],2),t._v(" "),n("el-descriptions-item",[n("template",{slot:"label"},[t._v("\n\n                    交货期\n                ")]),t._v(" "),n("el-select",{staticStyle:{width:"192px"},attrs:{placeholder:"请选择",size:"mini"},on:{change:function(e){return t.Basic_information_modify_delivery_date()}},model:{value:t.MSO.DeliveryDate,callback:function(e){t.$set(t.MSO,"DeliveryDate",e)},expression:"MSO.DeliveryDate"}},[t._l(t.DateOfDeliverys,function(t){return n("el-option",{key:t,attrs:{label:t,value:t}})}),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.MSO.DeliveryDate,expression:"MSO.DeliveryDate"}],staticClass:"el-input__inner",staticStyle:{height:"28px","line-height":"28px","font-size":"12px"},attrs:{type:"text"},domProps:{value:t.MSO.DeliveryDate},on:{change:function(e){return t.Basic_information_modify_delivery_date(!0)},input:function(e){e.target.composing||t.$set(t.MSO,"DeliveryDate",e.target.value)}}})],2)],2),t._v(" "),n("el-descriptions-item",[n("template",{slot:"label"},[t._v("\n                    提成人\n                ")]),t._v(" "),n("span",{staticStyle:{cursor:"pointer"},on:{click:t.CommissionFun}},[t._v(t._s("  "+t.MSO.PrizeWinners)+"\n                    "),9!=t.MSO.State?n("i",{staticClass:"el-icon-edit"}):t._e()])],2)],2):t._e(),t._v(" "),n("DeviceDatabase",{attrs:{show:t.DeviceDatabaseShow,protype:"6"},on:{ShowFalse:t.ShowFalse,DataBase:t.DataBase}}),t._v(" "),n("el-drawer",{staticStyle:{width:"200%"},attrs:{visible:t.OrderTemplate,direction:"ltr",modal:!1,title:"订单模板"},on:{"update:visible":function(e){t.OrderTemplate=e}}},[n("div",{staticClass:"top_init_data",staticStyle:{marginbottom:"10px"}},[n("el-input",{staticStyle:{width:"193px"},attrs:{size:"mini",placeholder:"标题、更新人"},on:{change:function(e){return t.GetSOTemplates()}},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),t._v(" "),n("el-button",{staticStyle:{float:"right"},attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.GetSOTemplates()}}},[t._v("检索")])],1),t._v(" "),n("el-table",{ref:"multipleTable",staticStyle:{marginbottom:"10px"},attrs:{data:t.tableData3,size:"mini",height:t.$store.state.TableOptimumHeight,border:"","header-cell-style":{background:"#e1e1e1"}}},[n("el-table-column",{attrs:{prop:"CreateDate",label:"创建时间"}}),t._v(" "),n("el-table-column",{attrs:{prop:"Title",label:"模板标题"}}),t._v(" "),n("el-table-column",{attrs:{prop:"Updater",label:"最后更新人"}}),t._v(" "),n("el-table-column",{attrs:{prop:"UpdateDt",label:"最后更新日期"}}),t._v(" "),n("el-table-column",{attrs:{prop:"Memo",label:"备注","show-overflow-tooltip":!0}}),t._v(" "),n("el-table-column",{attrs:{prop:"EquCount",label:"设备合计"}}),t._v(" "),n("el-table-column",{attrs:{fixed:"right",label:"操作",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(n){return t.addTemplate(e.row)}}},[t._v("添加")])]}}])})],1),t._v(" "),n("SaxoFenYe",{attrs:{total:t.total3},on:{func:t.func3}})],1),t._v(" "),n("br"),t._v(" "),n("h3",[t._v("设备清单\n            "),n("span",{staticStyle:{"font-size":"14px",color:"#909399"}},[t._v(t._s(t.MSO.EquCount))]),t._v(" "),n("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.download()}}},[t._v("下载")]),t._v(" "),-1!=[1,6].indexOf(t.MSO.State)?n("saxo-button",{staticStyle:{float:"right"},attrs:{mini:"",type:"success"},on:{click:function(e){return t.GetSOTemplates()}}},[t._v("订单模板")]):t._e(),t._v(" "),-1!=[1,6].indexOf(t.MSO.State)?n("saxo-button",{staticStyle:{float:"right","margin-right":"10px"},attrs:{mini:"",type:"success"},on:{click:function(e){t.DeviceDatabaseShow=!0}}},[t._v("添加")]):t._e(),t._v(" "),-1!=[1,6].indexOf(t.MSO.State)?n("el-button",{staticStyle:{float:"right","margin-right":"50px"},attrs:{type:"success",size:"mini"}},[n("label",{attrs:{for:"UpExcelData"}},[t._v("上传")]),t._v(" "),n("input",{ref:"referenceUpload",staticStyle:{display:"none"},attrs:{id:"UpExcelData",type:"file",accept:".xlsx, .xls"},on:{change:function(e){return t.getFile(e)}}})]):t._e(),t._v(" "),-1!=[1,6].indexOf(t.MSO.State)?n("el-link",{staticStyle:{float:"right",margin:"6px"},attrs:{type:"primary",href:"http://erp.inchwell.com.cn/mould/document/download/整机销售发货设备上传.xlsx"},on:{click:function(e){return t.DownloadShippingList()}}},[t._v("\n                下载模板")]):t._e()],1),t._v(" "),n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.MSO.MachineSOEquDtos,"header-cell-style":t.$store.state.headerCellStyle,"cell-style":t.$store.state.cellStyle,stripe:""}},[n("el-table-column",{attrs:{label:"序号",type:"index",width:"60"}}),t._v(" "),n("el-table-column",{attrs:{prop:"ProductCode",label:"对内编码",width:"150"}}),t._v(" "),n("el-table-column",{attrs:{prop:"LongCode",label:"对外编码",width:"150"}}),t._v(" "),n("el-table-column",{attrs:{prop:"Describe2",label:"描述","show-overflow-tooltip":!0}}),t._v(" "),n("el-table-column",{attrs:{prop:"handle",width:"90"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-popover",{attrs:{placement:"top-start",width:"400",trigger:"hover",content:"采购中["+e.row.NetInventory0+"] 在途["+e.row.NetInventory1+"] 在库["+e.row.NetInventory2+"] 销售量["+e.row.NetInventory3+"] 净库存["+e.row.NetInventory4+"]"}},[n("span",{staticStyle:{cursor:"pointer"},attrs:{slot:"reference"},slot:"reference"},[t._v(t._s(e.row.NetInventory4))])])]}}])},[n("template",{slot:"header"},[t._v("\n                    净库存\n                ")])],2),t._v(" "),n("el-table-column",{attrs:{prop:"handle",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.PriceSynchronization?t._e():n("el-select",{ref:"selectAppType",staticStyle:{"max-width":"140px"},attrs:{placeholder:"请选择",size:"mini"},on:{change:function(n){return t.UpdateMSOEquPrice(e.row,1)}},model:{value:e.row.DateOfDelivery,callback:function(n){t.$set(e.row,"DateOfDelivery",n)},expression:"scope.row.DateOfDelivery"}},[t._l(t.DateOfDeliverys,function(t){return n("el-option",{key:t,attrs:{label:t,value:t}})}),t._v(" "),n("el-input",{attrs:{placeholder:"自定义发货期",size:"mini"},on:{change:function(n){return t.UpdateMSOEquPrice(e.row,98)}},model:{value:t.CustomDeliveryDate,callback:function(e){t.CustomDeliveryDate=e},expression:"CustomDeliveryDate"}})],2),t._v(" "),t.PriceSynchronization?n("span",[t._v(" "+t._s(e.row.DateOfDelivery))]):t._e()]}}])},[n("template",{slot:"header"},[n("el-select",{staticStyle:{"max-width":"140px"},attrs:{placeholder:"请选择",size:"mini"},on:{change:function(e){return t.DateOfDeliverysFun()}},model:{value:t.DateOfDeliverysIndex999,callback:function(e){t.DateOfDeliverysIndex999=e},expression:"DateOfDeliverysIndex999"}},[t._l(t.DateOfDeliverys,function(t){return n("el-option",{key:t,attrs:{label:t,value:t}})}),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.CustomDeliveryDate2,expression:"CustomDeliveryDate2"}],staticClass:"el-input__inner",staticStyle:{height:"28px","line-height":"28px","font-size":"12px"},attrs:{type:"text"},domProps:{value:t.CustomDeliveryDate2},on:{change:function(e){return t.DateOfDeliverysFun(!0)},input:function(e){e.target.composing||(t.CustomDeliveryDate2=e.target.value)}}})],2)],1)],2),t._v(" "),n("el-table-column",{attrs:{label:"原始单价","header-align":"center",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{staticStyle:{float:"right"}},[t._v(" "+t._s("￥"+e.row.OriginalPrice.toFixed(2)))])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"折扣",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.PriceSynchronization?n("span",[t._v(" "+t._s(e.row.Discount)+" +'%'")]):t._e(),t._v(" "),t.PriceSynchronization?t._e():n("el-input",{staticStyle:{"max-width":"100px"},attrs:{size:"mini",placeholder:"折扣"},on:{change:function(n){return t.UpdateMSOEquPrice(e.row,2)}},model:{value:e.row.Discount,callback:function(n){t.$set(e.row,"Discount",n)},expression:"scope.row.Discount"}},[n("i",{staticStyle:{"line-height":"30px"},attrs:{slot:"suffix"},slot:"suffix"},[t._v("%")])])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"优惠后单价","header-align":"center",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{staticStyle:{float:"right"}},[t._v(" "+t._s("￥"+e.row.DiscountPrice.toFixed(2)))])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"优惠后合计","header-align":"center",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{staticStyle:{float:"right"}},[t._v(" "+t._s("￥"+(e.row.DiscountPrice*e.row.Quantity).toFixed(2)))])]}}])}),t._v(" "),n("el-table-column",{attrs:{fixed:"right",label:"数量",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.PriceSynchronization?n("span",[t._v(" "+t._s(e.row.Quantity))]):t._e(),t._v(" "),t.PriceSynchronization?t._e():n("div",{attrs:{id:"Number_input"}},[n("div",{staticClass:"div_icon_text",on:{click:function(n){return t.UpdateMSOEquPrice(e.row,"Del")}}},[n("i",{staticClass:"el-icon-minus"})]),t._v(" "),n("div",{staticClass:"div_icon_textConter"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.row.Quantity,expression:"scope.row.Quantity"}],staticStyle:{"text-align":"center","border-style":"none",outline:"none",width:"100%"},attrs:{type:"text",name:"",id:""},domProps:{value:e.row.Quantity},on:{blur:function(n){return t.UpdateMSOEquPrice(e.row,"saxo",e.row.Quantity)},input:function(n){n.target.composing||t.$set(e.row,"Quantity",n.target.value)}}})]),t._v(" "),n("div",{staticClass:"div_icon_text",on:{click:function(n){return t.UpdateMSOEquPrice(e.row,"Add")}}},[n("i",{staticClass:"el-icon-plus"})])])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"已发量",width:"70",prop:"NoSentQuantity"}}),t._v(" "),-1!=[1,6].indexOf(t.MSO.State)?n("el-table-column",{attrs:{label:"操作",fixed:"right",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("saxo-button",{attrs:{mini:"",type:"danger"},on:{click:function(n){return t.dele(e.row)}}},[t._v("删除")])]}}],null,!1,1691880002)}):t._e()],1),t._v(" "),n("br"),t._v(" "),t.BJState?t._e():n("el-descriptions",[n("el-descriptions-item",{attrs:{label:"整体折扣"}},[t._v(t._s(t.MSO.Discount)+"%")]),t._v(" "),n("el-descriptions-item",{attrs:{label:"运输方式"}},[t._v(t._s(t.MSO.TypeOfShipping))]),t._v(" "),t.MSO.OriginalAmount?n("el-descriptions-item",{attrs:{label:"设备原始金额"}},[t._v(t._s("￥"+t.MSO.OriginalAmount.toFixed(2)))]):t._e(),t._v(" "),t.MSO.DiscountAmount?n("el-descriptions-item",{attrs:{label:"设备优惠金额"}},[t._v(t._s("￥"+t.MSO.DiscountAmount.toFixed(2))+"\n                "),-1!=[1,2,3,4,6,7].indexOf(t.MSO.State)?n("i",{staticClass:"el-icon-edit",staticStyle:{cursor:"pointer"},on:{click:function(e){t.MsoAmountRounding(t.MSO.DiscountAmount.toFixed(2))}}}):t._e()]):t._e()],1),t._v(" "),t.BJState?n("el-descriptions",[n("el-descriptions-item",{attrs:{label:"整体折扣"}},[n("el-input",{staticStyle:{width:"100px"},attrs:{size:"mini",placeholder:"整体折扣"},on:{change:t.ZTdiscount},model:{value:t.MSO.Discount,callback:function(e){t.$set(t.MSO,"Discount",e)},expression:"MSO.Discount"}},[n("i",{staticStyle:{"line-height":"30px"},attrs:{slot:"suffix"},slot:"suffix"},[t._v("%")])])],1),t._v(" "),n("el-descriptions-item",{attrs:{label:"运输方式"}},[n("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"请选择",size:"mini"},model:{value:t.MSO.TypeOfShipping,callback:function(e){t.$set(t.MSO,"TypeOfShipping",e)},expression:"MSO.TypeOfShipping"}},t._l(t.TypeOfShippings,function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),n("el-descriptions-item",{attrs:{label:"设备原始金额"}},[t._v(t._s(t.MSO.OriginalAmount.toFixed(2)))]),t._v(" "),n("el-descriptions-item",{attrs:{label:"设备优惠金额"}},[t._v(t._s("￥"+t.MSO.DiscountAmount.toFixed(2))+" ")])],1):t._e(),t._v(" "),n("h3",[t._v("客户联系人")]),t._v(" "),t.MSO.CusLinkMan&&!t.BJState?n("el-descriptions",{attrs:{column:2}},[n("el-descriptions-item",{attrs:{label:"姓 名"}},[t._v(t._s(t.MSO.CusLinkMan.ChineseName))]),t._v(" "),n("el-descriptions-item",{attrs:{label:"手 机"}},[t._v(t._s(t.MSO.CusLinkMan.MobilePhone))]),t._v(" "),n("el-descriptions-item",{attrs:{label:"EMail"}},[t._v(t._s(t.MSO.CusLinkMan.EMail))]),t._v(" "),n("el-descriptions-item",{attrs:{label:"地 址"}},[t._v(t._s(t.MSO.CusLinkMan.Address))])],1):t._e(),t._v(" "),t.MSO.CusLinkMan&&t.BJState?n("el-descriptions",{attrs:{column:2}},[n("el-descriptions-item",{attrs:{label:"姓 名"}},[n("el-input",{staticStyle:{width:"120px"},attrs:{size:"mini",placeholder:"姓名"},model:{value:t.MSO.CusLinkMan.ChineseName,callback:function(e){t.$set(t.MSO.CusLinkMan,"ChineseName",e)},expression:"MSO.CusLinkMan.ChineseName"}})],1),t._v(" "),n("el-descriptions-item",{attrs:{label:"手 机"}},[n("el-input",{staticStyle:{width:"120px"},attrs:{size:"mini",placeholder:"手机"},model:{value:t.MSO.CusLinkMan.MobilePhone,callback:function(e){t.$set(t.MSO.CusLinkMan,"MobilePhone",e)},expression:"MSO.CusLinkMan.MobilePhone"}})],1),t._v(" "),n("el-descriptions-item",{attrs:{label:"EMail"}},[n("el-input",{staticStyle:{width:"300px"},attrs:{size:"mini",placeholder:"EMail"},model:{value:t.MSO.CusLinkMan.EMail,callback:function(e){t.$set(t.MSO.CusLinkMan,"EMail",e)},expression:"MSO.CusLinkMan.EMail"}})],1),t._v(" "),n("el-descriptions-item",{attrs:{label:"地 址"}},[n("el-input",{staticStyle:{width:"300px"},attrs:{size:"mini",placeholder:"地址"},model:{value:t.MSO.CusLinkMan.Address,callback:function(e){t.$set(t.MSO.CusLinkMan,"Address",e)},expression:"MSO.CusLinkMan.Address"}})],1)],1):t._e(),t._v(" "),n("br"),t._v(" "),n("SaxoDrawer",{attrs:{show:t.SaxoDrawer,title:t.MSO.CusFullName+"(挂账款 & 不明款 & 资金池)"},on:{ShowFalse:function(e){t.SaxoDrawer=!1}}},[n("div",{staticClass:"DeawerBox"},[n("div",{staticClass:"table"},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.CapitalPoolDtos,height:"100%"}},[n("el-table-column",{attrs:{label:"类别",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return["挂帐款"==e.row.LB?n("span",[t._v(" "+t._s(e.row.LB+"("+e.row.InvoiceStateStr+")"))]):t._e(),t._v(" "),"挂帐款"!=e.row.LB?n("span",[t._v(" "+t._s(e.row.LB))]):t._e()]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"资金量",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{staticStyle:{float:"right"}},[t._v(" "+t._s(t.FinancialAmountFormat(e.row.Amount,t.FinancialAmountSymbol(e.row.BuyingCurrency))))])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"使用量",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{staticStyle:{float:"right"}},[t._v(" "+t._s(t.FinancialAmountFormat(e.row.UsageAmount,t.FinancialAmountSymbol(e.row.BuyingCurrency))))])]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"Creater",label:"创建人",width:"120"}}),t._v(" "),n("el-table-column",{attrs:{prop:"CreateDate",label:"创建时间",width:"120"}}),t._v(" "),n("el-table-column",{attrs:{prop:"StateStr",label:"状态",width:"120"}}),t._v(" "),n("el-table-column",{attrs:{label:"系统信息","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-popover",{attrs:{placement:"top-start",title:"系统信息",trigger:"hover"}},[t._l(e.row.SystemInfo2,function(e,a){return n("p",{key:a},[t._v(t._s(e))])}),t._v(" "),n("span",{attrs:{slot:"reference"},slot:"reference"},[t._v("系统信息"),n("i",{staticClass:"el-icon-warning-outline"})])],2)]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"Memo",label:"备注","show-overflow-tooltip":!0}}),t._v(" "),n("el-table-column",{attrs:{label:"使用量",fixed:"right",width:"150px"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-input",{attrs:{size:"mini",type:"number",placeholder:"请输入使用量"},model:{value:e.row.Number,callback:function(n){t.$set(e.row,"Number",n)},expression:"scope.row.Number"}})]}}])})],1)],1),t._v(" "),n("div",{staticClass:"but"},[n("div",[t._v("认款合计：￥"),n("span",[t._v(" "+t._s(t.Subscription))])]),t._v(" "),n("saxo-button",{staticClass:"butState",attrs:{mini:"",type:"primary"},on:{click:t.AddMSOPaymentFun}},[t._v("确认")])],1)])]),t._v(" "),-1!=[2,3,4,5].indexOf(t.MSO.State)?n("div",[n("h3",[t._v("认款清单\n                "),n("el-button",{staticStyle:{float:"right"},attrs:{slot:"append",size:"mini",type:"success"},on:{click:function(e){return t.GetCusCapitalPool()}},slot:"append"},[t._v("认款")])],1),t._v(" "),n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.MSO.MachineSOPayments,"header-cell-style":t.$store.state.headerCellStyle,"cell-style":t.$store.state.cellStyle,stripe:""}},[n("el-table-column",{attrs:{label:"付款金额"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                        "+t._s(t.FinancialAmountFormat(e.row.PaymentAmount))+"\n                    ")]}}],null,!1,3311205548)}),t._v(" "),n("el-table-column",{attrs:{label:"付款比例"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                        "+t._s((e.row.PaymentAmount/t.MSO.DiscountAmount*100).toFixed(2)+"%")+"\n                    ")]}}],null,!1,4174281455)}),t._v(" "),n("el-table-column",{attrs:{prop:"Confirmer",label:"确认人_财务"}}),t._v(" "),n("el-table-column",{attrs:{prop:"ConfirmDt",label:"确认日期"}}),t._v(" "),n("el-table-column",{attrs:{label:"系统信息","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-popover",{attrs:{placement:"top-start",title:"系统信息",trigger:"hover"}},[t._l(e.row.SystemInfo2,function(e,a){return n("p",{key:a},[t._v(t._s(e))])}),t._v(" "),n("span",{attrs:{slot:"reference"},slot:"reference"},[t._v("系统信息"),n("i",{staticClass:"el-icon-warning-outline"})])],2)]}}],null,!1,3639752531)})],1),t._v(" "),n("h3",[t._v("发票清单\n                "),n("el-button",{staticStyle:{float:"right"},attrs:{size:"mini",type:"success"},on:{click:function(e){return t.AddSOInvoice()}}},[t._v("申请开票")])],1),t._v(" "),n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.MSO.MachineSOInvoiceDtos,"header-cell-style":t.$store.state.headerCellStyle,"cell-style":t.$store.state.cellStyle,stripe:""}},[n("el-table-column",{attrs:{label:"创建时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(e.row.CreateDate.split("T")[0]))])]}}],null,!1,3961921737)}),t._v(" "),n("el-table-column",{attrs:{label:"发票金额",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{staticStyle:{float:"right"}},[t._v(" "+t._s(t.FinancialAmountFormat(e.row.Amount)))])]}}],null,!1,2327991445)}),t._v(" "),n("el-table-column",{attrs:{label:"发票比例",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{staticStyle:{float:"right"}},[t._v(t._s((e.row.Amount/t.MSO.DiscountAmount*100).toFixed(2)+"%"))])]}}],null,!1,4029004029)}),t._v(" "),n("el-table-column",{attrs:{prop:"Creater",label:"申请人"}}),t._v(" "),n("el-table-column",{attrs:{prop:"Confirmer",label:"财务确认人"}}),t._v(" "),n("el-table-column",{attrs:{prop:"InvoiceStateStr",label:"发票状态"}}),t._v(" "),n("el-table-column",{attrs:{prop:"ReceiverEmail",label:"收票人邮箱"}}),t._v(" "),n("el-table-column",{attrs:{prop:"Logistics",label:"物流单号"}}),t._v(" "),n("el-table-column",{attrs:{prop:"InvCode",label:"发票号"}}),t._v(" "),n("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.InvoiceState?n("saxo-button",{attrs:{mini:"",type:"danger"},on:{click:function(n){return t.DeleteInvoices(e.row)}}},[t._v("删除发票")]):t._e(),t._v(" "),2==e.row.InvoiceState?n("saxo-button",{attrs:{mini:"",type:"success"},on:{click:function(n){return t.OperationInvoice(e.row)}}},[t._v("申请操作")]):t._e()]}}],null,!1,739258268)})],1)],1):t._e(),t._v(" "),2==t.MSO.PayType||2==t.MSO.PayStatus?n("div",{attrs:{id:"commercialInvoice"}},[n("h3",[t._v("发货清单\n                "),n("saxo-button",{staticClass:"fr",attrs:{mini:"",type:"info"},on:{click:function(e){return t.ExportExcel()}}},[t._v("导出")]),t._v(" "),n("el-select",{staticStyle:{float:"right",margin:"0 10px"},attrs:{clearable:"",placeholder:"请选择待发量",size:"mini"},on:{change:t.retrievalMSO},model:{value:t.Amount_to_be_fired,callback:function(e){t.Amount_to_be_fired=e},expression:"Amount_to_be_fired"}},t._l(t.fireds,function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1),t._v(" "),n("el-input",{staticStyle:{width:"250px",float:"right"},attrs:{clearable:"",placeholder:"请输入产品编码/产品描述",size:"mini"},on:{input:t.retrievalMSO},model:{value:t.MachineSOEquDtosSeach,callback:function(e){t.MachineSOEquDtosSeach=e},expression:"MachineSOEquDtosSeach"}})],1),t._v(" "),n("el-table",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticStyle:{width:"100%"},attrs:{id:"out-table",data:t.MachineSOEquDtosFHD,"header-cell-style":t.$store.state.headerCellStyle,"cell-style":t.$store.state.cellStyle,stripe:""}},[n("el-table-column",{attrs:{label:t.MSO.CusFullName}},[n("el-table-column",{attrs:{label:"出库申请单"}},[n("el-table-column",{attrs:{prop:"ProductCode",label:"产品编码","show-overflow-tooltip":!0}}),t._v(" "),n("el-table-column",{attrs:{prop:"Describe",label:"产品描述"}}),t._v(" "),n("el-table-column",{attrs:{prop:"Quantity",label:"订单数量"}}),t._v(" "),n("el-table-column",{attrs:{label:"库位"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.LocationList,function(e){return n("p",{key:e},[t._v(" "+t._s("供应商库"!=e.split("-")[0]?e:e.split("-")[0]+"-"+e.split(",")[1]))])})}}],null,!1,934432727)}),t._v(" "),n("el-table-column",{attrs:{label:"本次申请数量"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(e.row[t.LastDeliveryTimes].split("|")[0]))])]}}],null,!1,298615017)}),t._v(" "),n("el-table-column",{attrs:{label:"本次发货数量"},scopedSlots:t._u([{key:"default",fn:function(e){return[0!=e.row[t.LastDeliveryTimes].split("|")[1]?n("span",[t._v(t._s(e.row[t.LastDeliveryTimes].split("|")[1]))]):t._e()]}}],null,!1,985738165)}),t._v(" "),n("el-table-column",{attrs:{prop:"serialNumber",label:"序号",width:"50"}})],1)],1)],1),t._v(" "),n("el-table",{staticStyle:{width:"100%","z-index":"99"},attrs:{data:t.retrievalData,"header-cell-style":t.$store.state.headerCellStyle,"cell-style":t.$store.state.cellStyle,stripe:""}},[n("el-table-column",{attrs:{prop:"serialNumber",label:"序号",width:"50"}}),t._v(" "),n("el-table-column",{attrs:{prop:"ProductCode",label:"产品编码",width:"150"}}),t._v(" "),n("el-table-column",{attrs:{prop:"Describe",label:"产品描述","show-overflow-tooltip":!0}}),t._v(" "),n("el-table-column",{attrs:{label:"采购中",width:"85",prop:"NetInventory0"}}),t._v(" "),n("el-table-column",{attrs:{label:"在途",width:"75",prop:"NetInventory1"}}),t._v(" "),n("el-table-column",{attrs:{label:"在库",width:"75",prop:"NetInventory2"}}),t._v(" "),n("el-table-column",{attrs:{label:"销售量",width:"85",prop:"NetInventory3"}}),t._v(" "),n("el-table-column",{attrs:{label:"净库存",width:"85",prop:"NetInventory4"}}),t._v(" "),n("el-table-column",{attrs:{label:"交货期",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{attrs:{id:e.row.ProductCode+"_PointingDevice"}},[t._v(" "+t._s(e.row.DateOfDelivery))])]}}],null,!1,721878859)}),t._v(" "),n("el-table-column",{attrs:{prop:"Quantity",label:"订单数量",width:"80"}}),t._v(" "),n("el-table-column",{attrs:{prop:"ThisSent",label:"已发量",width:"80"}}),t._v(" "),n("el-table-column",{attrs:{prop:"WatiSent",label:"待发量",width:"80"}}),t._v(" "),n("el-table-column",{attrs:{label:"库位",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.LocationList,function(e){return n("p",{key:e},[t._v(" "+t._s("供应商库"!=e.split("-")[0]?e:e.split("-")[0]+"-"+e.split(",")[1]))])})}}],null,!1,3883506135)}),t._v(" "),t._l(t.LogisticDtos,function(e,a){return n("el-table-column",{key:a,attrs:{width:"150",prop:"Number"+a}},[n("template",{slot:"header"},[n("p",{staticStyle:{color:"#409EFF",cursor:"pointer"},on:{click:function(e){return t.DownloadShippingList(a)}}},[t._v("\n                            "+t._s("申请|发货"+(a+1))+"\n                            "),n("i",{staticClass:"el-icon-download"}),t._v(" "),n("br"),t._v(" "),n("span",[t._v(t._s(e.ApplyDt.split(".")[0]))]),t._v(" "),n("br"),t._v(" "),n("span",[t._v(t._s(null!=e.SentDt?e.SentDt.split(".")[0]:" - - "))])])])],2)}),t._v(" "),t.MacSODispatchOrderDtosStateStr?t._e():n("el-table-column",{attrs:{label:"申请发货数量",fixed:"right",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-input",{staticStyle:{width:"110px"},attrs:{size:"mini",placeholder:"申请发货数量"},model:{value:e.row.apply,callback:function(n){t.$set(e.row,"apply",n)},expression:"scope.row.apply"}}),t._v(" "),e.row.apply>0&&e.row.apply==e.row.WatiSent?n("i",{staticClass:"el-icon-success",staticStyle:{"font-size":"14px",color:"#67C23A"}}):t._e(),t._v(" "),e.row.apply>0&&e.row.apply<e.row.WatiSent?n("i",{staticClass:"el-icon-warning",staticStyle:{"font-size":"14px",color:"#E6A23C"}}):t._e()]}}],null,!1,1439296885)}),t._v(" "),t.MacSODispatchOrderDtosStateStr?n("el-table-column",{attrs:{label:"发货数量",fixed:"right",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.LocationList,function(a,i){return n("el-input",{key:i,staticStyle:{width:"110px"},attrs:{size:"mini",placeholder:a},model:{value:e.row.Obj[a],callback:function(n){t.$set(e.row.Obj,a,n)},expression:"scope.row.Obj[item]"}})})}}],null,!1,1569335923)}):t._e()],2),t._v(" "),t.MacSODispatchOrderDtosStateStr?t._e():n("el-input",{staticStyle:{width:"300px",float:"right"},attrs:{type:"textarea",rows:2,placeholder:"请输入备注"},model:{value:t.textarea,callback:function(e){t.textarea=e},expression:"textarea"}}),t._v(" "),t.MacSODispatchOrderDtosStateStr?n("el-input",{staticStyle:{width:"300px",float:"right"},attrs:{type:"textarea",rows:2,placeholder:"请输入物流"},model:{value:t.textarea,callback:function(e){t.textarea=e},expression:"textarea"}}):t._e(),t._v(" "),n("div",{staticStyle:{width:"100%",float:"right"}}),t._v(" "),t.MacSODispatchOrderDtosStateStr?t._e():n("saxo-button",{staticStyle:{float:"right","margin-top":"13px"},attrs:{mini:"",type:"success"},on:{click:function(e){return t.applydeliverGoods()}}},[t._v("申请发货")]),t._v(" "),n("el-dialog",{attrs:{title:"选择收货人",visible:t.dialogVisible,"append-to-body":!0},on:{"update:visible":function(e){t.dialogVisible=e}}},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.receiverTableData,size:"mini"}},[n("el-table-column",{attrs:{prop:"Name",label:"姓名",width:"100"}}),t._v(" "),n("el-table-column",{attrs:{prop:"Position",label:"职位",width:"150"}}),t._v(" "),n("el-table-column",{attrs:{prop:"Mobile",label:"手机",width:"150"}}),t._v(" "),n("el-table-column",{attrs:{prop:"Email",label:"邮箱"}}),t._v(" "),n("el-table-column",{attrs:{prop:"Address",label:"地址"}}),t._v(" "),n("el-table-column",{attrs:{fixed:"right",label:"选择",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-checkbox",{on:{change:function(n){t.receiverTableData.forEach(function(t){return t.Default=!1}),e.row.Default=!0}},model:{value:e.row.Default,callback:function(n){t.$set(e.row,"Default",n)},expression:"scope.row.Default"}})]}}],null,!1,459834945)})],1),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{size:"mini"},on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),n("saxo-button",{attrs:{mini:""},on:{click:function(e){return t.DetermineTheSender()}}},[t._v("确 定")])],1)],1),t._v(" "),t.MacSODispatchOrderDtosStateStr?t._e():n("saxo-button",{staticStyle:{float:"right","margin-top":"13px","margin-right":"10px"},attrs:{mini:"",type:"success"},on:{click:function(e){return t.oneClickApplicationForShipment()}}},[t._v("一键申请发货")]),t._v(" "),t.MacSODispatchOrderDtosStateStr?n("saxo-button",{staticStyle:{float:"right","margin-top":"13px"},attrs:{mini:"",type:"primary"},on:{click:function(e){return t.deliverGoods()}}},[t._v("发货")]):t._e(),t._v(" "),t.MacSODispatchOrderDtosStateStr?n("saxo-button",{staticStyle:{float:"right","margin-top":"13px","margin-right":"10px"},attrs:{mini:"",type:"primary"},on:{click:function(e){return t.OneKeyDelivery()}}},[t._v("一键发货")]):t._e(),t._v(" "),t.MacSODispatchOrderDtosStateStr?n("div",{staticStyle:{float:"right",margin:"18px 30px 0 0"}},[n("el-radio",{attrs:{label:"0"},model:{value:t.OtherBool,callback:function(e){t.OtherBool=e},expression:"OtherBool"}},[t._v("不关闭发货申请")]),t._v(" "),n("el-radio",{attrs:{label:"1"},model:{value:t.OtherBool,callback:function(e){t.OtherBool=e},expression:"OtherBool"}},[t._v("关闭发货申请")])],1):t._e()],1):t._e(),t._v(" "),2==t.MSO.PayType||2==t.MSO.PayStatus?n("p",[n("br"),t._v(" "),n("br"),t._v(" "),n("br"),t._v(" "),n("br"),t._v(" "),n("br"),t._v(" "),n("br")]):t._e(),t._v(" "),2!=t.MSO.State&&3!=t.MSO.State&&4!=t.MSO.State&&5!=t.MSO.State||2!=t.MSO.PayType&&2!=t.MSO.PayStatus?t._e():n("div",[n("h3",[t._v("退货清单\n                "),n("saxo-button",{attrs:{mini:"",type:"success"},on:{click:function(e){return t.ReturnRefund_fun()}}},[t._v("申请退货")])],1),t._v(" "),n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.MSO.MsoReturnDtos,"header-cell-style":t.$store.state.headerCellStyle,"cell-style":t.$store.state.cellStyle,stripe:""}},[n("el-table-column",{attrs:{label:"创建时间","header-align":"center",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(" "+t._s(e.row.CreateDate.split("T")[0]))])]}}],null,!1,338188898)}),t._v(" "),n("el-table-column",{attrs:{label:"金额","header-align":"center",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{staticStyle:{float:"right"}},[t._v(" "+t._s(t.FinancialAmountFormat(e.row.TotalAmount)))])]}}],null,!1,4119309815)}),t._v(" "),n("el-table-column",{attrs:{label:"挂账款","header-align":"center",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{staticStyle:{float:"right"}},[t._v(" "+t._s(t.FinancialAmountFormat(e.row.BuyerBuyingOnCreditAmount)))])]}}],null,!1,1224542542)}),t._v(" "),n("el-table-column",{attrs:{prop:"Creater",label:"申请人"}}),t._v(" "),n("el-table-column",{attrs:{prop:"PayStateStr",label:"付款状态"}}),t._v(" "),n("el-table-column",{attrs:{prop:"ReturnStateStr",label:"任务状态"}}),t._v(" "),n("el-table-column",{attrs:{label:"操作","header-align":"center",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"info",size:"mini"},on:{click:function(n){return t.LookReturnRefund_fun(e.row)}}},[t._v("查看")])]}}],null,!1,2526433405)})],1),t._v(" "),n("h3",[t._v("设备变更清单\n                "),n("saxo-button",{attrs:{mini:"",type:"success"},on:{click:function(e){return t.ReplaceEquipment()}}},[t._v("申请变更设备")])],1),t._v(" "),n("br"),t._v(" "),n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.MSO.MsoEquChangeDtos,"header-cell-style":t.$store.state.headerCellStyle,"cell-style":t.$store.state.cellStyle,stripe:""}},[n("el-table-column",{attrs:{label:"创建时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(" "+t._s(e.row.CreateDate.split("T")[0]))])]}}],null,!1,338188898)}),t._v(" "),n("el-table-column",{attrs:{label:"类别"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(e.row.Type))])]}}],null,!1,1730832542)}),t._v(" "),n("el-table-column",{attrs:{prop:"StateStr",label:"状态"}}),t._v(" "),n("el-table-column",{attrs:{label:"差额",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{staticStyle:{float:"right"}},[t._v(" "+t._s(t.FinancialAmountFormat(e.row.ChaAmount)))])]}}],null,!1,1768404031)}),t._v(" "),n("el-table-column",{attrs:{label:"系统信息",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-popover",{attrs:{placement:"top-start",title:"系统信息",trigger:"hover"}},[t._l(e.row.SystemInfo.split("@"),function(e,a){return n("p",{key:a},[t._v(t._s(e))])}),t._v(" "),n("span",{attrs:{slot:"reference"},slot:"reference"},[t._v("系统信息"),n("i",{staticClass:"el-icon-warning-outline"})])],2)]}}],null,!1,3627510684)}),t._v(" "),n("el-table-column",{attrs:{label:"详情",fixed:"right",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-link",{staticStyle:{"font-size":"12px"},attrs:{type:"primary",underline:!1},on:{click:function(n){return t.SeeApplyEquipment(e.row)}}},[t._v("详情")])]}}],null,!1,3825900256)})],1)],1),t._v(" "),n("h3",[t._v("备注")]),t._v(" "),n("el-input",{staticStyle:{width:"500px"},attrs:{type:"textarea",autosize:{minRows:5,maxRows:10},placeholder:"请输入内容"},model:{value:t.Remarks,callback:function(e){t.Remarks=e},expression:"Remarks"}})]},proxy:!0}])})},staticRenderFns:[]};var m=n("VU/8")(d,h,!1,function(t){n("5B3w")},"data-v-09672982",null);e.default=m.exports}});