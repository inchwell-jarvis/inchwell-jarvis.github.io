webpackJsonp([24],{"7BJP":function(t,e){},SDV4:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=o("bOdI"),a=o.n(s),i=o("t4zo"),l=o.n(i),r=o("uXZL"),n=o.n(r),c={data:function(){var t;return t={search:"",state:"",pagesize:100,pageNum:1,value1:["",""],select:"",options:[{label:"全部",value:"",index:1},{label:"申请中",value:1,index:2},{label:"已借出",value:2,index:3},{label:"已归还",value:3,index:4}],data:[],DataShow:[],DataShowTool:[],DataShowTool1:[]},a()(t,"pageNum",1),a()(t,"pagesize",10),a()(t,"total",0),a()(t,"pagesize",10),a()(t,"dialogTableVisible",!1),a()(t,"CusToolRecDto_BorrowListDtos",[]),a()(t,"begin",""),a()(t,"end",""),t},created:function(){this.pagesize=this.$store.state.DisplayNumber,this.init()},methods:{exportrecord:function(){var t=this,e={data:{cusId:this.$store.state.CusId,search:this.search,state:this.state,pageNum:1,numPerPage:1e4,orderField:"",orderDirection:"",begin:this.begin,end:this.end},api:"get",url:this.$store.state.http+"CusTool/GetCusToolRecs"};this.$https(e).then(function(e){console.log(e.Data.DataBars),t.total=e.Data.DataBars,t.DataShow=e.Data.Dtos;for(var o=0;o<t.DataShow.length;o++)t.DataShow[o].ApplyTime=t.DataShow[o].ApplyTime.split("T")[0],null===t.DataShow[o].LendTime?t.DataShow[o].LendTime=" -  -":t.DataShow[o].LendTime=t.DataShow[o].LendTime.split("T")[0],null===t.DataShow[o].ReturnTime?t.DataShow[o].ReturnTime=" -  -":t.DataShow[o].ReturnTime=t.DataShow[o].ReturnTime.split("T")[0];setTimeout(function(){t.exportExcel("#Table_one","借用记录")},1e3)})},exportTool:function(t){var e=this,o={data:{type:t,begin:this.begin,end:this.end},api:"get",url:this.$store.state.http+"CusTool/StatCusToolRec"};this.$https(o).then(function(o){1==t?(e.DataShowTool=o.Data,setTimeout(function(){e.exportExcel("#Table_Tool","从借用人纬度统计")},1e3)):(e.DataShowTool1=o.Data,setTimeout(function(){e.exportExcel("#Table_Tool1","从工具纬度统计")},1e3))})},exportExcel:function(t,e){var o=n.a.utils.table_to_book(document.querySelector(t),{raw:!0}),s=n.a.write(o,{bookType:"xlsx",bookSST:!0,type:"array"});try{l.a.saveAs(new Blob([s],{type:"application/octet-stream"}),e+".xlsx")}catch(t){"undefined"!=typeof console&&console.log(t,s)}return s},tableRowClassName:function(t){var e=t.row;return 1==e.State?"code1":2===e.State?"code2":3===e.State?"code3":""},pick:function(t){console.log(t),null==t?(this.begin="",this.end=""):(this.begin=t[0],this.end=t[1]),this.initdata()},initShutter:function(t){this.state=t,this.init()},init:function(){var t=this,e={data:{cusId:this.$store.state.CusId,search:this.search,state:this.state,pageNum:this.pageNum,numPerPage:this.pagesize,orderField:"",orderDirection:"",begin:this.begin,end:this.end},api:"get",url:this.$store.state.http+"CusTool/GetCusToolRecs"};this.$https(e).then(function(e){console.log(e.Data.DataBars),t.total=e.Data.DataBars,t.data=e.Data.Dtos;for(var o=0;o<t.data.length;o++)t.data[o].ApplyTime=t.data[o].ApplyTime.split("T")[0],null===t.data[o].LendTime?t.data[o].LendTime=" -  -":t.data[o].LendTime=t.data[o].LendTime.split("T")[0],null===t.data[o].ReturnTime?t.data[o].ReturnTime=" -  -":t.data[o].ReturnTime=t.data[o].ReturnTime.split("T")[0]})},edit:function(t){var e=this;console.log(t);var o={data:{Id:t.Id},api:"get",url:this.$store.state.http+"CusTool/GetCusToolRec"};this.$https(o).then(function(t){console.log(t.Data),e.CusToolRecDto_BorrowListDtos=t.Data}),this.dialogTableVisible=!0},func:function(t,e){this.pagesize=t,this.pageNum=e,this.init()},handleClose:function(t){var e=this;this.$confirm("确认关闭？").then(function(o){t(),e.deleteadddata()}).catch(function(t){})},addtrue:function(){var t=this,e=this.CusToolRecDto_BorrowListDtos.CusToolRecDto;if(3==e.State)return this.dialogTableVisible=!1,!1;var o={data:{BorrowRecId:e.Id,State:e.State+1},api:"post",url:this.$store.state.http+"CusTool/UpdateBorrowRecState"};this.$https(o).then(function(e){t.dialogTableVisible=!1,t.init()})},urlAddlist:function(){this.$router.push({path:"/create-borrowing-list"})}}},u={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"box"},[o("router-view",{on:{refresh:t.init}}),t._v(" "),o("div",{staticClass:"TopSerch"},[o("el-input",{staticStyle:{width:"193px"},attrs:{size:"mini",placeholder:"请输入记录编号、借用人"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),t._v(" "),o("el-select",{staticStyle:{width:"100px"},attrs:{size:"mini",placeholder:"请选择"},on:{change:function(e){return t.initShutter(t.select)}},model:{value:t.select,callback:function(e){t.select=e},expression:"select"}},t._l(t.options,function(t){return o("el-option",{key:t.index,attrs:{label:t.label,value:t.value}})}),1),t._v(" "),o("el-date-picker",{attrs:{type:"datetimerange",size:"mini","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd","default-time":["12:00:00"]},on:{change:t.pick},model:{value:t.value1,callback:function(e){t.value1=e},expression:"value1"}}),t._v(" "),o("el-button",{attrs:{type:"primary",loading:this.$store.state.Vuex.loading,size:"mini"},on:{click:function(e){return t.init()}}},[t._v("检索")]),t._v(" "),o("el-button",{staticStyle:{float:"right"},attrs:{type:"success",size:"mini"},on:{click:function(e){return t.urlAddlist()}}},[t._v("添加")]),t._v(" "),o("el-button",{staticStyle:{float:"right"},attrs:{type:"info",size:"mini"},on:{click:function(e){return t.exportrecord()}}},[t._v("导出借用记录")]),t._v(" "),o("el-button",{staticStyle:{float:"right"},attrs:{type:"info",size:"mini"},on:{click:function(e){return t.exportTool(2)}}},[t._v("从工具纬度统计")]),t._v(" "),o("el-button",{staticStyle:{float:"right"},attrs:{type:"info",size:"mini"},on:{click:function(e){return t.exportTool(1)}}},[t._v("从借用人纬度统计")])],1),t._v(" "),t.CusToolRecDto_BorrowListDtos.CusToolRecDto?o("el-dialog",{attrs:{title:"审核信息",visible:t.dialogTableVisible,"before-close":t.handleClose},on:{"update:visible":function(e){t.dialogTableVisible=e}}},[o("div",{staticClass:"dial",staticStyle:{width:"100%",height:"500px"}},[o("div",{staticClass:"msg"},[t._v("基础信息")]),t._v(" "),o("div",{staticClass:"msgul"},[o("div",{staticClass:"lefts"},[o("p",[t._v("借用人：")]),t._v("\n          "+t._s(t.CusToolRecDto_BorrowListDtos.CusToolRecDto.Borrower)+"\n        ")]),t._v(" "),o("div",{staticClass:"lefts"},[o("p",[t._v("记录编号：")]),t._v("\n          "+t._s(t.CusToolRecDto_BorrowListDtos.CusToolRecDto.BorrowRecoreCode)+"\n        ")]),t._v(" "),o("div",{staticClass:"lefts"},[o("p",[t._v("状态：")]),t._v("\n          "+t._s(t.CusToolRecDto_BorrowListDtos.CusToolRecDto.StateStr)+"\n        ")]),t._v(" "),o("div",{staticClass:"lefts"},[o("p",[t._v("申请时间：")]),t._v("\n          "+t._s(t.CusToolRecDto_BorrowListDtos.CusToolRecDto.ApplyTime)+"\n        ")]),t._v(" "),o("div",{staticClass:"lefts"},[o("p",[t._v("借出时间：")]),t._v("\n          "+t._s(t.CusToolRecDto_BorrowListDtos.CusToolRecDto.LendTime||"-- --")+"\n        ")]),t._v(" "),o("div",{staticClass:"lefts"},[o("p",[t._v("归还时间：")]),t._v("\n          "+t._s(t.CusToolRecDto_BorrowListDtos.CusToolRecDto.ReturnTime||"-- --")+"\n        ")])]),t._v(" "),o("div",{staticClass:"msg"},[t._v("工具信息("+t._s(t.CusToolRecDto_BorrowListDtos.BorrowListDtos.length)+")")]),t._v(" "),o("div",{staticClass:"gonhgju msgul"},t._l(t.CusToolRecDto_BorrowListDtos.BorrowListDtos,function(e,s){return o("div",{key:s,staticClass:"gjli"},[o("div",{staticClass:"title"},[t._v("工具"+t._s(s+1)+" ---- "+t._s(t.CusToolRecDto_BorrowListDtos.BorrowListDtos[s].ProductCode))]),t._v(" "),o("div",{staticClass:"lefts"},[o("p",[t._v("库位：")]),t._v("\n            "+t._s(t.CusToolRecDto_BorrowListDtos.BorrowListDtos[s].Storehouse)+"\n          ")]),t._v(" "),o("div",{staticClass:"lefts"},[o("p",[t._v("单价：")]),t._v("\n            "+t._s(t.CusToolRecDto_BorrowListDtos.BorrowListDtos[s].Unit)+"\n          ")]),t._v(" "),o("div",{staticClass:"lefts"},[o("p",[t._v("标签：")]),t._v("\n            "+t._s(t.CusToolRecDto_BorrowListDtos.BorrowListDtos[s].ToolLabel)+"\n          ")]),t._v(" "),o("div",{staticClass:"wei"},[t._v("说明："+t._s(t.CusToolRecDto_BorrowListDtos.BorrowListDtos[s].ProductDesc))]),t._v(" "),o("div",{staticClass:"divimage"},[o("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{"preview-src-list":["http://icms.inchwell.com.cn/File/CusTool/"+t.CusToolRecDto_BorrowListDtos.BorrowListDtos[s].ImageUrl],src:"http://icms.inchwell.com.cn/File/CusTool/"+t.CusToolRecDto_BorrowListDtos.BorrowListDtos[s].ImageUrl,fit:"fill"}})],1)])}),0)]),t._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(e){t.dialogTableVisible=!1}}},[t._v("取 消")]),t._v(" "),1==t.CusToolRecDto_BorrowListDtos.CusToolRecDto.State?o("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addtrue()}}},[t._v("借 出")]):t._e(),t._v(" "),2==t.CusToolRecDto_BorrowListDtos.CusToolRecDto.State?o("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addtrue()}}},[t._v("归 还")]):t._e(),t._v(" "),3==t.CusToolRecDto_BorrowListDtos.CusToolRecDto.State?o("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addtrue()}}},[t._v("确 定")]):t._e()],1)]):t._e(),t._v(" "),o("div",{staticClass:"content"},[o("el-table",{staticStyle:{width:"100%"},attrs:{data:t.data,size:"mini",height:this.$store.state.TableOptimumHeight,"highlight-current-row":"",border:"",id:"out-table","row-class-name":t.tableRowClassName,"header-cell-style":{background:"#e1e1e1"}}},[o("el-table-column",{attrs:{prop:"UserName",label:"借用人",width:"120"}}),t._v(" "),o("el-table-column",{attrs:{prop:"BorrowRecoreCode",label:"记录编号",width:"150"}}),t._v(" "),o("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"StateStr",label:"状态"}}),t._v(" "),o("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"ApplyTime",label:"申请时间"}}),t._v(" "),o("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"LendTime",label:"借出时间"}}),t._v(" "),o("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"ReturnTime",label:"归还时间"}}),t._v(" "),o("el-table-column",{attrs:{width:"200px",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button-group",[1==e.row.State?o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(o){return t.edit(e.row)}}},[t._v("借出")]):t._e(),t._v(" "),2==e.row.State?o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(o){return t.edit(e.row)}}},[t._v("归还")]):t._e(),t._v(" "),3==e.row.State?o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(o){return t.edit(e.row)}}},[t._v("查看")]):t._e()],1)]}}])})],1)],1),t._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"content"},[o("el-table",{staticStyle:{width:"100%"},attrs:{data:t.DataShow,size:"mini",height:this.$store.state.TableOptimumHeight,"highlight-current-row":"",border:"",id:"Table_one","row-class-name":t.tableRowClassName,"header-cell-style":{background:"#e1e1e1"}}},[o("el-table-column",{attrs:{prop:"UserName",label:"借用人",width:"120"}}),t._v(" "),o("el-table-column",{attrs:{prop:"BorrowRecoreCode",label:"记录编号",width:"150"}}),t._v(" "),o("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"StateStr",label:"状态"}}),t._v(" "),o("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"ApplyTime",label:"申请时间"}}),t._v(" "),o("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"LendTime",label:"借出时间"}}),t._v(" "),o("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"ReturnTime",label:"归还时间"}})],1)],1),t._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"content"},[o("el-table",{staticStyle:{width:"100%"},attrs:{data:t.DataShowTool,size:"mini",height:this.$store.state.TableOptimumHeight,"highlight-current-row":"",border:"",id:"Table_Tool","row-class-name":t.tableRowClassName,"header-cell-style":{background:"#e1e1e1"}}},[o("el-table-column",{attrs:{prop:"Count",label:"次数",width:"120"}}),t._v(" "),o("el-table-column",{attrs:{prop:"Key",label:"工程师",width:"150"}})],1)],1),t._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"content"},[o("el-table",{staticStyle:{width:"100%"},attrs:{data:t.DataShowTool1,size:"mini",height:this.$store.state.TableOptimumHeight,"highlight-current-row":"",border:"",id:"Table_Tool1","row-class-name":t.tableRowClassName,"header-cell-style":{background:"#e1e1e1"}}},[o("el-table-column",{attrs:{prop:"Count",label:"次数",width:"120"}}),t._v(" "),o("el-table-column",{attrs:{prop:"Key",label:"工具编码",width:"150"}}),t._v(" "),o("el-table-column",{attrs:{prop:"Key2",label:"详细编码",width:"150"}}),t._v(" "),o("el-table-column",{attrs:{prop:"Key3",label:"工具描述",width:"150"}})],1)],1),t._v(" "),o("SaxoFenYe",{attrs:{total:t.total},on:{func:t.func}})],1)},staticRenderFns:[]};var d=o("VU/8")(c,u,!1,function(t){o("7BJP"),o("thbt")},"data-v-29e92fbe",null);e.default=d.exports},thbt:function(t,e){}});