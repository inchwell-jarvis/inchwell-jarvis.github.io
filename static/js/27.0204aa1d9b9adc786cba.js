webpackJsonp([27],{"/z9v":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("Gu7T"),i=a.n(n),o=a("mvHQ"),s=a.n(o),l=a("bOdI"),r=a.n(l),c=a("t4zo"),u=a.n(c),d=a("uXZL"),p=a.n(d),h={data:function(){return{tableData:[],total:0,retrieval:{location:"",proCode:"",desc:"",brand:"",longCode:"",kufang:1,havekucun:1,pageNum:1,numPerPage:this.$store.state.NewDisplayNumber,orderField:"",orderDirection:""},havekucunList:[{label:"全部",value:-1},{label:"空库位",value:1},{label:"非空库位",value:2}],kufangList:[{label:"全部",value:-1},{label:"大仓",value:1},{label:"三楼库房",value:2}]}},computed:{retrievalJT:function(){return s()(this.retrieval)}},watch:{retrievalJT:function(t,e){this.WatchFenYe(t,e)?this.$refs.SaxoFenYe.ReviseConNumber1():this.start()}},methods:{start:function(){var t=this;this.API_GET("StorageRoom/StorageLocations",this.retrieval).then(function(e){console.log(e),t.tableData=e.Dtos,t.total=e.DataBars})},func:function(t,e){this.retrieval.numPerPage=t,this.retrieval.pageNum=e,this.start()},querySearch:function(t,e){if(void 0==t)return t="",e(this.Optios),!1;if(""==t)return e(this.Optios),!1;for(var a=t,n=this.Optios,i=[],o=(a.split("")[0],0);o<n.length;o++){var s=n[o];-1!=s.value.indexOf(a)&&i.push(s)}e(i)},Manufacturer:function(){var t=this;this.API_GET("System/GetBrand").then(function(e){t.Optios=e;for(var a=0;a<t.Optios.length;a++)t.Optios[a].value=t.Optios[a].Value;console.log(t.Optios)})}},created:function(){this.Manufacturer(),this.start()},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},v={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"KuWeiGuanLi"},[a("router-view",{on:{refresh:t.start}}),t._v(" "),a("div",{staticClass:"retrieve"},[a("div",{staticClass:"ConView"},[a("div",{staticClass:"department"},[a("span",[t._v("库位")]),t._v(" "),a("el-input",{attrs:{placeholder:"库位",size:"mini"},model:{value:t.retrieval.location,callback:function(e){t.$set(t.retrieval,"location",e)},expression:"retrieval.location"}})],1),t._v(" "),a("div",{staticClass:"department",staticStyle:{width:"270px"}},[a("span",{staticStyle:{width:"120px"}},[t._v("对内编码/产品编码")]),t._v(" "),a("el-input",{attrs:{placeholder:"对内编码/产品编码",size:"mini"},model:{value:t.retrieval.proCode,callback:function(e){t.$set(t.retrieval,"proCode",e)},expression:"retrieval.proCode"}})],1),t._v(" "),a("div",{staticClass:"department",staticStyle:{width:"270px"}},[a("span",{staticStyle:{width:"120px"}},[t._v("对外编码/内部编码")]),t._v(" "),a("el-input",{attrs:{placeholder:"对外编码/内部编码",size:"mini"},model:{value:t.retrieval.longCode,callback:function(e){t.$set(t.retrieval,"longCode",e)},expression:"retrieval.longCode"}})],1),t._v(" "),a("div",{staticClass:"department",staticStyle:{width:"270px"}},[a("span",{staticStyle:{width:"120px"}},[t._v("对内描述/产品描述")]),t._v(" "),a("el-input",{attrs:{placeholder:"对内描述/产品描述",size:"mini"},model:{value:t.retrieval.desc,callback:function(e){t.$set(t.retrieval,"desc",e)},expression:"retrieval.desc"}})],1),t._v(" "),a("div",{staticClass:"department"},[a("span",[t._v("品牌")]),t._v(" "),a("el-autocomplete",{staticClass:"inline-input",attrs:{id:"autocomplete",size:"mini","show-overflow-tooltip":!0,"fetch-suggestions":t.querySearch,placeholder:"请选择品牌",clearable:""},model:{value:t.retrieval.brand,callback:function(e){t.$set(t.retrieval,"brand",e)},expression:"retrieval.brand"}})],1),t._v(" "),a("div",{staticClass:"department"},[a("span",[t._v("库房")]),t._v(" "),a("el-select",{attrs:{placeholder:"请选择库房",size:"mini"},model:{value:t.retrieval.kufang,callback:function(e){t.$set(t.retrieval,"kufang",e)},expression:"retrieval.kufang"}},t._l(t.kufangList,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),a("div",{staticClass:"department"},[a("span",[t._v("库存类型")]),t._v(" "),a("el-select",{attrs:{placeholder:"请选择库存类型",size:"mini"},model:{value:t.retrieval.havekucun,callback:function(e){t.$set(t.retrieval,"havekucun",e)},expression:"retrieval.havekucun"}},t._l(t.havekucunList,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1)]),t._v(" "),a("saxo-button",{staticStyle:{float:"right","margin-top":"13px","margin-right":"13px"},attrs:{mini:"",type:"primary"},on:{click:function(e){return t.start()}}},[t._v("搜 索")])],1),t._v(" "),a("div",{staticClass:"content2"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,"header-cell-style":t.$store.state.headerCellStyle,"cell-style":t.$store.state.cellStyle,stripe:"",height:"100%"}},[a("el-table-column",{attrs:{prop:"Location",label:"库位",width:"150","show-overflow-tooltip":!0}}),t._v(" "),a("el-table-column",{attrs:{prop:"ProductCode",label:"产品编码",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Describe",label:" 产品描述","show-overflow-tooltip":!0}}),t._v(" "),a("el-table-column",{attrs:{prop:"Brand",label:"品牌",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Number",label:"库存",width:"180"}})],1)],1),t._v(" "),a("SaxoFenYe",{ref:"SaxoFenYe",attrs:{total:t.total},on:{func:t.func}})],1)},staticRenderFns:[]};var m={components:{StorageLocations:a("VU/8")(h,v,!1,function(t){a("LAlr")},"data-v-b7b8f604",null).exports},data:function(){var t,e;return{SaxoDrawerBool:!1,dialogVisible:!1,dialogVisibleList:[],DeviceDatabaseShow:!1,StoreRoomindex:0,StoreRoom22:"请选择",DateOfDeliverys:["入公司库","入供应商库"],headerCellStyle:(t={background:"#f7f8fd",fontSize:"12px",fontWeight:400,fontStyle:"normal"},r()(t,"fontSize","11px"),r()(t,"padding","5px"),r()(t,"paddingLeft","0px"),t),headerCellStyle2:(e={background:"#f7f8fd",fontSize:"12px",fontWeight:400,fontStyle:"normal"},r()(e,"fontSize","11px"),r()(e,"padding","5px"),r()(e,"paddingLeft","0px"),r()(e,"textAlign","center"),e),cellStyle:{height:"48px",fontSize:"12px"},Id:"",MPO:{},MachinePOFiles:[],edit:!1,BelongCompanyList:["技术公司","服务公司"],PayTypeList:[{label:"付全款",value:1},{label:"分期付款",value:2},{label:"先发货后付款",value:3}],PaymentAmount:"",PaymentAmountBFB:"",drawer2:!1,options:[{value:-1,label:"全部"},{value:1,label:"制作中"},{value:2,label:"已确认"},{value:3,label:"部分发货"},{value:4,label:"全部发货"},{value:5,label:"已结单"},{value:9,label:"已撤单"}],Typeofcustomer:[{label:"全部"},{label:"宝马"},{label:"保时捷"},{label:"奥迪"},{label:"奔驰"},{label:"劳斯莱斯"},{label:"路虎"},{label:"自由市场"},{label:"其他"}],DrawerSearch:"",DrawerSaler:"",state:-1,area:"",cusType:"",tableData:[],pageNum2:1,numPerPage2:20,total2:0,MachineSOEquDtos:[],MachineSOEquDtos2:[],drawer3:!1,SeacrhEqu:"",brand:"",brands:[],DocumentIdentification:"",options2:[],received:"",CurrencySign:"",Memo:"",MacPODispatchOrderDtosClone:[],ReceiptInformationRetrievalIndex:0,column:{},dialogVisible2:!1,columnIndex:0,ShippingRemarks:"",MachinePOPayDtosHJ:0,MachinePOInvoiceDtosHJ:0,RequestRefundDialog:!1,RequestRefundData:{PayId:"",RefundAmount:0,RefundTo:"网银",Other:"",Amount:0},SaxoDrawer:!1,Subscription:0,CapitalPoolDtos:[]}},computed:{newCapitalPoolDtos:function(){return JSON.parse(s()(this.CapitalPoolDtos))}},watch:{radio:function(t){"1"==t&&(this.radio2="1")},PaymentAmountBFB:function(t){console.log(t),this.PaymentAmount=null!=t&&""!=t?(this.MPO.TotalAmount*(t/100)).toFixed(2):""},newCapitalPoolDtos:function(t){var e=this;this.Subscription=0,t.forEach(function(t){t.Number>0&&(e.Subscription+=Number(t.Number))})}},methods:{deleteOrder:function(){var t=this;this.$confirm("此操作将永久删除该订单, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.API_POST("MachineSO/DelMpo",{id:t.Id}).then(function(e){t.$message.success("删除成功！"),t.$router.push({path:"/MachinePurchase"}),t.$emit("refresh")})}).catch(function(){t.$message.info("已取消删除")})},DwFileUrl:function(t,e){saveAs("http://icms.inchwell.com.cn"+t,e)},SubmitRedInv:function(t){var e=this;console.log(t),this.$confirm("提交冲红发票?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.API_POST("Finance/SubmitRedInv",{Id:t.ID}).then(function(t){e.$message.success("操作成功！"),e.start()})})},OperationInvoice:function(t){var e=this;this.$prompt("请输入内容","操作发票",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(a){var n=a.value;e.API_POST("Finance/ApplyHandleInvoice",{ID:t.ID,Str:n}).then(function(t){e.$message.success("操作成功"),e.start()})}).catch(function(){e.$message("取消操作发票")})},AddMSOPaymentFun:function(){var t=this;console.log(this.CapitalPoolDtos);for(var e=[],a=0;a<this.CapitalPoolDtos.length;a++){var n=this.CapitalPoolDtos[a];isNaN(parseFloat(n.Number))||e.push({ID:n.ID,SellingPrice:Number(n.Number)})}if(0==e.length)return this.$message.error("请输入使用量");console.log(e),this.API_POST("MachineSO/MpoApplyPayByBBOC",{Id:this.MPO.ID,Other:this.Subscription,Euqs:e}).then(function(e){t.$message.success("申请成功！"),t.SaxoDrawer=!1,t.start()})},applyToUseAccounts:function(){console.log("11111"),this.GetCusCapitalPool(),this.SaxoDrawer=!0},GetCusCapitalPool:function(t){var e=this;this.SaxoDrawer=!0;var a={api:"get",url:this.$store.state.http+"CRM/GetCusCapitalPool",data:{cusId:this.MPO.CusId,onlyPart:!0,includebboc:!0,includebuming:!1}};this.$https(a).then(function(t){e.CapitalPoolDtos=[];var a=t.Data,n=a.BBOCDtos,i=a.CapitalPoolDtos;null!=n&&t.Data.BBOCDtos.forEach(function(t){t.LB="挂帐款",t.CreateDate=t.CreateDate.split("T")[0],e.$set(t,"Number",""),""!=t.SystemInfo&&null!=t.SystemInfo?t.SystemInfo2=t.SystemInfo.split("@"):element.SystemInfo2=[],e.CapitalPoolDtos.push(t)}),null!=i&&i.forEach(function(t){t.LB=t.Type,t.CreateDate=t.CreateDate.split("T")[0],e.$set(t,"Number",""),""!=t.SystemInfo&&null!=t.SystemInfo?t.SystemInfo2=t.SystemInfo.split("@"):element.SystemInfo2=[],e.CapitalPoolDtos.push(t)}),console.log(e.CapitalPoolDtos)})},RequestRefundPrimary:function(){var t=this;if(0==this.RequestRefundData.RefundAmount)return this.$message.warning("请输入退款金额！");this.API_POST("MachineSO/MpoRefundApply",this.RequestRefundData).then(function(e){t.$message.success("申请成功！"),t.RequestRefundDialog=!1,t.start()})},RequestRefund:function(t){console.log(t),this.RequestRefundDialog=!0,this.RequestRefundData.RefundAmount=0,this.RequestRefundData.RefundTo="网银",this.RequestRefundData.Other="",this.RequestRefundData.Amount=t.Amount,this.RequestRefundData.PayId=t.ID},SeeApplyEquipment:function(t){console.log(t),this.$router.push({path:"apply-to-change-equipment-see-mpo",query:{ID:t.ID}})},ApplyToChangeEquipment:function(){this.$router.push({path:"/apply-to-change-equipment-mpo",query:{Id:this.Id,From:3,EquDtos:this.MPO.MachinePOEquDtos,BuyingCurrency:this.MPO.BuyingCurrency}})},ReturnRefund_fun:function(){console.log(this.MPO.MachinePOEquDtos),this.$router.push({path:"/ReturnRefund3",query:{Id:this.Id,From:3,EquDtos:this.MPO.MachinePOEquDtos}})},LookKuWei:function(){this.SaxoDrawerBool=!0},ModifyMemo:function(t){var e=this;if(void 0==t)var a=this.column;else a=t;var n={data:{Id:a.ID,UnitPrice:a.UnitPrice,POQuantity:a.POQuantity,NoSentQuantity:a.NoSentQuantity,Memo:a.Memo,StoreRoom:"入公司库"==a.StoreRoom2?1:0},api:"post",url:this.$store.state.http+"MachineSO/UpdateMPOEquPrice"};console.log(n),this.$https(n).then(function(a){e.dialogVisible2=!1,void 0==t?(e.$message({showClose:!0,message:"修改成功！",type:"success"}),e.start()):(e.columnIndex-=1,0==e.columnIndex&&(e.$message({showClose:!0,message:"批量修改备注成功！",type:"success"}),e.start()))})},CellClick:function(t,e,a,n){"备注"==e.label&&(this.column=JSON.parse(s()(t)),this.dialogVisible2=!0)},ReceiptInformationRetrieval:function(t){console.log(t),console.log(this.ReceiptInformationRetrievalIndex);var e=this.MacPODispatchOrderDtosClone[this.ReceiptInformationRetrievalIndex].MacPODispatchOrderGoodDtos;console.log(e);var a=[];e.forEach(function(e){-1!=(String(e.ProductCode)+String(e.Describe)).indexOf(t)&&a.push(e)}),this.MPO.MacPODispatchOrderDtos[this.ReceiptInformationRetrievalIndex].MacPODispatchOrderGoodDtos=a},DownloadTheStorageOrder:function(t,e){console.log(t,e);for(var a=this.MPO.CusFullName+"_"+this.MPO.POCode+"_"+(e+1)+"_入库单",n="height:40px;line-height:40px;font-size:20px;font-weight: bold;",i="height:40px;line-height:40px;font-size:20px;text-align: left;",o="text-align: left;font-size:18px;",s="text-align: center;font-size:18px;",l=new Date,r="",c=0;c<t.MacPODispatchOrderGoodDtos.length;c++){for(var u=t.MacPODispatchOrderGoodDtos[c],d="",p=0;p<u.LocationInfo2.length;p++){var h=u.LocationInfo2[p];0!=p&&(d+="\n                            <tr>\n                                <td style='"+s+"'>"+h.split(",")[1]+"</td>\n                                <td style='"+s+"'>"+h.split(",")[0].split("[")[1]+"</td>\n                            </tr>\n                            ")}r+="\n                    <tr>\n                        <td rowspan='"+u.LocationInfo2.length+"' style='"+s+"'>"+(c+1)+"</td>\n                        <td rowspan='"+u.LocationInfo2.length+"' style='"+o+"'>"+u.ProductCode+"</td>\n                        <td rowspan='"+u.LocationInfo2.length+"' style='"+o+"'>"+u.Describe+"</td>\n                        <td rowspan='"+u.LocationInfo2.length+"' style='"+o+"'>"+u.Locations+"</td>\n                        <td rowspan='"+u.LocationInfo2.length+"' style='"+s+"'>"+u.DeliverQuantity+"</td>\n                        <td style='"+s+"'>"+(u.LocationInfo2.length>0?u.LocationInfo2[0].split(",")[1]:"")+"</td>\n                        <td style='"+s+"'>"+(u.LocationInfo2.length>0?u.LocationInfo2[0].split(",")[0].split("[")[1]:"")+"</td>\n                    </tr>\n\n                    ",r+=d}var v='\n\n            <html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">\n                <head>\n                <meta charset="utf-8">\n                </head>\n                <body>\n                <table border=1 style="font-family: "宋体";padding:10px">\n\n                    <tr>\n                       <th colspan=\'7\' style=\'font-size:60px;line-height:100px;height:100px;color:rgb(20,25,244)\'>\n                        北京英之杰天祥入库单</th>\n                    </tr>\n\n                    <tr>\n                       <td colspan=\'2\' style=\''+n+"'>客户名称</td>\n                       <td colspan='5' style='"+i+"'>"+this.MPO.CusFullName+"</td>\n                    </tr>\n                    <tr>\n                       <td colspan='2' style='"+n+"'>订单编号</td>\n                       <td colspan='5' style='"+i+"'>"+this.MPO.POCode+"</td>\n                    </tr>\n                    <tr>\n                       <td colspan='2' style='"+n+"'>当前日期</td>\n                       <td colspan='5' style='"+i+"'>"+l.getFullYear()+"/"+(l.getMonth()+1)+"/"+l.getDate()+" "+l.getHours()+" : "+l.getMinutes()+" </td>\n                    </tr>\n\n                    <tr style='height:60px;line-height:60px;font-size:25px;margin:0 20px'>\n                       <th>序号</th>\n                       <th>产品编码</th>\n                       <th>描述</th>\n                       <th>库存库位</th>\n                       <th>发货数量</th>\n                       <th>收货数量</th>\n                       <th>收货库位</th>\n                    </tr>\n                    "+r+"\n                </table>\n                </body>\n                </html>",m=document.createElement("a");m.download=a+".xls",m.href="data:application/vnd.ms-excel;base64,"+window.btoa(unescape(encodeURIComponent(v))),document.body.appendChild(m),m.click(),document.body.removeChild(m)},ShowFalse:function(t){this.DeviceDatabaseShow=t},DataBase:function(t){var e=this;console.log(t);for(var a=[],n=0;n<t.length;n++){var i=t[n];a.push({ProductId:i.ID,Number:i.Quantity})}var o={api:"post",url:this.$store.state.http+"MachineSO/AddMPOEqus",data:{Id:this.Id,Euqs:a}};this.$https(o).then(function(t){e.$message({showClose:!0,message:"添加成功!",type:"success"}),e.drawer3=!1,e.start()})},InvoiceReceived:function(){var t=this;if(console.log(this.received),""==this.received||0==this.received)return this.$message.error("请输入正确的数值！"),!1;var e={api:"post",url:this.$store.state.http+"MachineSO/AddMPOInvoice",data:{id:this.Id,Str:Number(this.received),Memo:this.MPO.Memo}};this.$https(e).then(function(e){t.$message({showClose:!0,message:"创建成功!",type:"success"}),t.start()})},deleteFun:function(t){var e=this;console.log(t);var a={api:"post",url:this.$store.state.http+"MachineSO/DeleteMPOAtt",data:{id:t.ID}};this.$https(a).then(function(t){e.$message({showClose:!0,message:"删除成功!",type:"success"}),e.start()})},receive:function(t){var e=this;console.log(t);var a={api:"post",url:this.$store.state.http+"MachineSO/UploadMPOAtt",data:{id:this.Id,FileName:t.name,FileStr:t.Base64}};this.$https(a).then(function(t){e.$message({showClose:!0,message:"上传成功!",type:"success"}),e.start()})},Manufacturer:function(){var t=this,e={url:this.$store.state.http+"System/GetBrand",api:"get"};this.$https(e).then(function(e){t.options2=e.Data;for(var a=0;a<t.options2.length;a++)t.options2[a].value=t.options2[a].Value})},Statement:function(){var t=this,e={api:"post",url:this.$store.state.http+"MachineSO/MPOClose",data:{Id:this.Id}};this.$https(e).then(function(e){t.$message({showClose:!0,message:"结单成功!",type:"success"}),t.start()})},exportData:function(t,e){var a=this,n=new FileReader;FileReader.prototype.readAsBinaryString=function(t){var n,i,o="",s=new FileReader;s.onload=function(t){for(var l=new Uint8Array(s.result),r=l.byteLength,c=0;c<r;c++)o+=String.fromCharCode(l[c]);n=p.a.read(o,{type:"binary"}),i=p.a.utils.sheet_to_json(n.Sheets[n.SheetNames[0]]),a.fillIn(i,e)},s.readAsArrayBuffer(t)},n.readAsBinaryString(t)},ChinesetoEnglish:function(t){},fillIn:function(t,e){var a=this,n=e.split("-")[0];console.log(n);var o=e.split("-")[1];if(console.log(t,n,o),3==n){var l=this.MPO.MacPODispatchOrderDtos[Number(o)].MacPODispatchOrderGoodDtos;console.log(l);for(var r=0;r<l.length;r++){l[r].RuKu=[{ku:"",num:""}]}for(var c=0;c<t.length;c++)for(var u=t[c],d=0;d<l.length;d++){var p=l[d];console.log(p),p.ProductCode==u["产品编码"]&&(""==p.RuKu[0].ku&&(p.RuKu=[]),p.RuKu.push({ku:u["库位"],num:u["收货数量"]}))}return!1}if(3==n){var h=this.MPO.MacPODispatchOrderDtos[Number(o)].MacPODispatchOrderGoodDtos;console.log(h),console.log(y);for(var v=0;v<h.length;v++){h[v].RuKu=[{ku:"",num:""}]}for(var m=0;m<y.length;m++)for(var f=y[m],_=0;_<h.length;_++){var b=h[_];console.log(b),b.ProductCode==f["设备编码"]&&(""==b.RuKu[0].ku&&(b.RuKu=[]),b.RuKu.push({ku:f["库位"],num:f["物流收货"]}))}}if(0==t.length)return this.$message.error("表格没有数据"),!1;if(5==n){console.log(t);for(var y=[],g=0;g<t.length;g++){var S=t[g];void 0!=S["产品编码"]&&void 0!=S["数量"]&&void 0!=S["采购单价"]&&(console.log(S),y.push({ProName:S["产品编码"],Number:S["数量"],SellingPrice:S["采购单价"],Other:S["备注"]}))}return 0==y.length?(this.$message.error("有效数据0条"),!1):(this.API_POST("MachineSO/AddMPOEqus2",{Id:this.Id,Euqs:y}).then(function(t){a.$message({message:"添加成功",type:"success"}),a.start()}),!1)}if(1==Number(n)){y=[];for(var P=0;P<t.length;P++){var O=t[P];void 0!=O["编码"]&&void 0!=O["数量"]&&y.push({ProductCode:O["编码"],FHQuantity:O["数量"]})}console.log(y);var M=this.MPO.MachinePOEquDtos,w=M.map(function(t){return t.ProductCode}).filter(function(t,e,a){return a.indexOf(t)!==e});return console.log("重复的ProductCode:",w),this.dialogVisibleList=[],y.forEach(function(t){var e=!0;M.forEach(function(a){w.includes(a.ProductCode)?e=!1:w.includes(a.ProductCode)||t.ProductCode!=a.ProductCode||(a.FHQuantity=t.FHQuantity,e=!1)}),e&&a.dialogVisibleList.push(t.ProductCode)}),this.dialogVisibleList.length>0&&this.dialogVisibleList.unshift("未查询到："),w.length>0&&(this.dialogVisibleList=[].concat(i()(w),i()(this.dialogVisibleList)),this.dialogVisibleList.unshift("重复项：")),this.dialogVisibleList.length>0?this.dialogVisible=!0:this.$message.success("数据填充完成！"),!1}if(4==Number(n)){console.log("修改备注文件");var C=[];return t.forEach(function(t){var e=t["产品编码"];a.MPO.MachinePOEquDtos.forEach(function(a){if(a.ProductCode==e){var n=JSON.parse(s()(a));n.Memo=t["备注"],C.push(n)}})}),0==C.length?(this.$message.error("未查询到匹配的产品编码"),!1):(console.log(C),this.columnIndex=C.length,C.forEach(function(t){a.ModifyMemo(t)}),!1)}},getFile:function(t,e,a){var n=t.target.files[0];console.log(e,a);var i=e+"-"+a;console.log(i),this.exportData(n,i),t.target.value=""},ExcelUP:function(){},DownloadStorageFile:function(t){var e=p.a.utils.table_to_book(document.querySelector(t),{raw:!0});console.log(e);var a=p.a.write(e,{bookType:"xlsx",bookSST:!0,type:"array"});try{u.a.saveAs(new Blob([a],{type:"application/octet-stream"}),"入库文件.xlsx")}catch(t){"undefined"!=typeof console&&console.log(t,a)}return a},download:function(t){window.open("http://erp.inchwell.com.cn/mould/document/download/"+t+".xls")},SeacrhEquFun:function(){var t=this;if(""===this.SeacrhEqu&&""===this.brand)return this.MachineSOEquDtos=this.MachineSOEquDtos2,!1;var e=[];this.MachineSOEquDtos2.map(function(a){if(""!=t.brand&&(console.log(t.brand,a.Brand),a.Brand!=t.brand))return!1;if((console.log(t.brand),""!=t.SeacrhEqu)&&-1==(a.ProductCode+a.LongCode+a.Describe).indexOf(t.SeacrhEqu))return!1;e.push(a)}),this.MachineSOEquDtos=e},AddToCheck:function(){for(var t=this,e=[],a=this.$refs.HeTong2.selection,n=0;n<a.length;n++){var i=a[n];e.push({ProductId:i.ProductId,Number:i.Quantity})}var o={api:"post",url:this.$store.state.http+"MachineSO/AddMPOEqus",data:{Id:this.Id,Euqs:e}};this.$https(o).then(function(e){t.$message({showClose:!0,message:"添加成功!",type:"success"}),t.drawer3=!1,t.start()})},AddTo:function(t){var e=this;console.log(t);var a={api:"post",url:this.$store.state.http+"MachineSO/AddMPOEqus",data:{Id:this.Id,Euqs:[{ProductId:t.ProductId,Number:t.Quantity}]}};this.$https(a).then(function(t){e.$message({showClose:!0,message:"添加成功!",type:"success"}),e.drawer3=!1,e.start()})},Check:function(t){var e=this,a={data:{msoId:t.ID},api:"get",url:this.$store.state.http+"MachineSO/GetMSO"};this.$https(a).then(function(t){e.MachineSOEquDtos=t.Data.MSO.MachineSOEquDtos,e.MachineSOEquDtos2=t.Data.MSO.MachineSOEquDtos,console.log(e.MachineSOEquDtos),e.drawer3=!0,e.brands=[];for(var a=0;a<e.MachineSOEquDtos.length;a++){for(var n=e.MachineSOEquDtos[a].Brand,i=!0,o=0;o<e.brands.length;o++){e.brands[o].label==n&&(i=!1)}i&&e.brands.push({value:n,label:n})}console.log(e.brands)})},pageFun:function(t,e){this.numPerPage2=t,this.pageNum2=e,this.DrawerSearchFun()},DrawerSearchFun:function(){var t=this;if(""==this.cusType||"全部"==this.cusType)var e="";else e=this.cusType;var a={data:{search:this.DrawerSearch,area:this.area,state:this.state||-1,cusType:e,saler:this.DrawerSaler,pageNum:this.pageNum2,numPerPage:this.numPerPage2,orderField:"",orderDirection:""},api:"get",url:this.$store.state.http+"MachineSO/GetMSOs"};this.$https(a).then(function(e){console.log(e),t.tableData=e.Data.Dtos,t.total2=e.Data.DataBars})},ReceiveQuantityFun:function(t){var e=this;console.log(t);for(var a=[],n=0;n<t.length;n++)for(var i=t[n],o=0;o<i.RuKu.length;o++){var s=i.RuKu[o];s.num&&s.ku&&a.push({Id:i.ID,Number:Number(s.num),Other:s.ku})}var l={};if(l.Id=t[0].MacPODispatchOrderId,l.Euqs=a,0==l.Euqs.length)return this.$message.error("请输入入库的数量与库位!");this.API_POST("MachineSO/MPOReceiveGoods",l).then(function(t){e.$message.success("入库成功!"),e.start()})},ConfirmQuantityFun:function(t){var e=this;console.log(t);for(var a=[],n=0;n<t.length;n++){var i=t[n];a.push({Id:i.ID,Number:Number(i.ConfirmQuantity)})}var o={data:{Id:t[0].MacPODispatchOrderId,Euqs:a},api:"post",url:this.$store.state.http+"MachineSO/MPOConfirmGoods"};this.$https(o).then(function(t){e.$message({showClose:!0,message:"修改成功!",type:"success"}),e.start()})},Ship:function(){var t=this;console.log(this.MPO.MachinePOEquDtos);for(var e=[],a=0;a<this.MPO.MachinePOEquDtos.length;a++){var n=this.MPO.MachinePOEquDtos[a];""!=n.FHQuantity&&(console.log(n),e.push(n))}if(0==e.length)return this.$message({showClose:!0,message:"请输入正确的数量!",type:"warning"}),!1;for(var i=[],o=0;o<e.length;o++){var s=e[o];console.log(s),i.push({Id:s.ID,Number:Number(s.FHQuantity)})}var l={data:{Id:this.Id,Euqs:i,other:this.ShippingRemarks},api:"post",url:this.$store.state.http+"MachineSO/MPODeliverGoods"};this.$https(l).then(function(e){t.ShippingRemarks="",t.$message({showClose:!0,message:"发货成功！",type:"success"}),t.start()})},PaymentAmountClick:function(){var t=this;if(console.log(this.PaymentAmount),""===this.PaymentAmount.trim())this.$message({showClose:!0,message:"请输入正确的金额!",type:"warning"});else{var e={data:{Id:this.Id,Other:this.MPO.Memo,Str:this.PaymentAmount},api:"post",url:this.$store.state.http+"MachineSO/AddMPOPay"};this.$https(e).then(function(e){t.$message({showClose:!0,message:"已申请！",type:"success"}),t.start()})}},MPOApproval:function(t){var e=this,a={data:{Id:this.Id,Other:this.MPO.Memo,Str:t},api:"post",url:this.$store.state.http+"MachineSO/MPOApproval"};this.$https(a).then(function(t){e.start()})},MPOSubmitForManager:function(t){var e=this,a={data:{Id:this.Id,Other:this.MPO.Memo,Str:t},api:"post",url:this.$store.state.http+"MachineSO/MPOSubmitForManager"};this.$https(a).then(function(t){e.start()})},MPOSubmitForVerify:function(){var t=this,e={data:{Id:this.Id,Other:this.MPO.Memo},api:"post",url:this.$store.state.http+"MachineSO/MPOSubmitForVerify"};this.$https(e).then(function(e){t.start()})},editFun:function(t){var e=this;if(this.edit=!this.edit,t){var a={Id:this.Id,BelongCompany:this.MPO.BelongCompany,PayType:this.MPO.PayType,StorageCost:this.MPO.StorageCost,LogisticsCost:this.MPO.LogisticsCost,RebateCost:this.MPO.RebateCost,Memo:this.MPO.Memo,CusLinkMan:this.MPO.CusLinkMan,POCode:this.MPO.POCode};this.API_POST("MachineSO/SaveMPOEqu",a).then(function(t){e.$message.success("保存成功！"),e.start()})}else this.start()},DeleteStorageLocation:function(t,e,a){for(var n=this.MPO.MacPODispatchOrderDtos[t].MacPODispatchOrderGoodDtos,i=0;i<n.length;i++){var o=n[i];o.ID==e&&o.RuKu.splice(a,1)}},AddStorageLocation:function(t,e){for(var a=this.MPO.MacPODispatchOrderDtos[t].MacPODispatchOrderGoodDtos,n=0;n<a.length;n++){var i=a[n];i.ID==e&&i.RuKu.push({num:"",ku:""})}},UpdateMPOEquPriceFun:function(){this.StoreRoomindex=0;for(var t=0;t<this.MPO.MachinePOEquDtos.length;t++){this.MPO.MachinePOEquDtos[t].StoreRoom2=this.StoreRoom22}for(var e=0;e<this.MPO.MachinePOEquDtos.length;e++){var a=this.MPO.MachinePOEquDtos[e];this.UpdateMPOEquPrice(a,99)}},UpdateMPOEquPrice:function(t,e,a){var n=this,i=t.POQuantity;"Del"==e&&(i-=1),"Add"==e&&(i+=1),"saxo"==e&&(i=a);var o={data:{Id:t.ID,UnitPrice:t.UnitPrice,POQuantity:i,NoSentQuantity:t.NoSentQuantity,Memo:t.Memo,StoreRoom:"入公司库"==t.StoreRoom2?1:0},api:"post",url:this.$store.state.http+"MachineSO/UpdateMPOEquPrice"};console.log(o),this.$https(o).then(function(t){if(99==e)return n.StoreRoomindex+=1,n.StoreRoomindex==n.MPO.MachinePOEquDtos.length&&n.$message({showClose:!0,message:"修改成功！",type:"success"}),n.start(),!1;n.$message({showClose:!0,message:"修改成功！",type:"success"}),n.start()})},UpdateNoSentQuantity:function(t,e,a){var n=this,i=t.NoSentQuantity;"Del"==e&&(i-=1),"Add"==e&&(i+=1),"saxo"==e&&(i=a);var o={data:{Id:t.ID,UnitPrice:t.UnitPrice,NoSentQuantity:i,POQuantity:t.POQuantity,Memo:t.Memo,StoreRoom:"入公司库"==t.StoreRoom2?1:0},api:"post",url:this.$store.state.http+"MachineSO/UpdateMPOEquPrice"};console.log(o),this.$https(o).then(function(t){if(99==e)return n.StoreRoomindex+=1,n.StoreRoomindex==n.MPO.MachinePOEquDtos.length&&n.$message({showClose:!0,message:"修改成功！",type:"success"}),n.start(),!1;n.$message({showClose:!0,message:"修改成功！",type:"success"}),n.start()})},start:function(){var t=this,e={data:{mpoId:this.Id},api:"get",url:this.$store.state.http+"MachineSO/GetMPO"};this.$https(e).then(function(e){console.log(e.Data),t.MachinePOFiles=e.Data.MachinePOFiles,console.log(t.MachinePOFiles),t.MPO=e.Data.MPO;t.CurrencySign="¥",[{abbreviation:"RMB",sign:"¥"},{abbreviation:"USD",sign:"$"},{abbreviation:"EUR",sign:"€"},{abbreviation:"GBP",sign:"￡"},{abbreviation:"JPY",sign:"J¥"}].forEach(function(e){t.MPO.BuyingCurrency==e.abbreviation&&(t.CurrencySign=e.sign+" ")});for(var a=0;a<t.MPO.MachinePOEquDtos.length;a++){var n=t.MPO.MachinePOEquDtos[a];t.$set(n,"FHQuantity",""),t.$set(n,"BuyingCurrency",t.MPO.BuyingCurrency),n.StoreRoom2=1==n.StoreRoom?"入公司库":"入供应商库"}for(var i=0;i<t.MPO.MacPODispatchOrderDtos.length;i++){var o=t.MPO.MacPODispatchOrderDtos[i];t.$set(o,"NumberOfSpecies",o.MacPODispatchOrderGoodDtos.length),t.$set(o,"number99",0),t.$set(o,"numberCai",0),t.$set(o,"numberKu",0),t.$set(o,"Search","");for(var l=0;l<o.MacPODispatchOrderGoodDtos.length;l++){var r=o.MacPODispatchOrderGoodDtos[l];t.$set(r,"RuKu",[{num:"",ku:""}]),o.number99+=r.DeliverQuantity,o.numberCai+=r.ConfirmQuantity,o.numberKu+=r.ReceiveQuantity,t.$set(r,"LocationInfo2",(r.LocationInfo||"").split("]").slice(0,-1))}}console.log(t.MPO.MacPODispatchOrderDtos),t.MacPODispatchOrderDtosClone=JSON.parse(s()(t.MPO.MacPODispatchOrderDtos)),t.MachinePOPayDtosHJ=0;for(var c=0;c<t.MPO.MachinePOPayDtos.length;c++){var u=t.MPO.MachinePOPayDtos[c];console.log(u),"已驳回"!=u.PayStateStr&&(t.MachinePOPayDtosHJ+=u.Amount),u.AuditorA&&(u.AuditorA=u.AuditorA.split("/")[0].slice(0,u.AuditorA.split("/")[0].length-4)),u.AuditorB&&(u.AuditorB=u.AuditorB.split("/")[0].slice(0,u.AuditorB.split("/")[0].length-4)),u.AuditorC&&(u.AuditorC=u.AuditorC.split("/")[0].slice(0,u.AuditorC.split("/")[0].length-4)),u.AuditorD&&(u.AuditorD=u.AuditorD.split("/")[0].slice(0,u.AuditorD.split("/")[0].length-4))}t.MachinePOInvoiceDtosHJ=0;for(var d=0;d<t.MPO.MachinePOInvoiceDtos.length;d++){var p=t.MPO.MachinePOInvoiceDtos[d];"发票已作废"!=p.InvoiceStateStr&&(t.MachinePOInvoiceDtosHJ+=p.Amount)}console.log(t.MachinePOInvoiceDtosHJ),console.log(t.MPO)})},dele:function(t){var e=this;console.log(t);var a={api:"post",url:this.$store.state.http+"MachineSO/DelMPOEqu",data:{Id:t.ID}};this.$https(a).then(function(t){e.$message({message:"删除成功",type:"success"}),e.start()})}},created:function(){this.Id=this.$route.query.Id,this.pagesize3=this.$store.state.DisplayNumber,this.start(),this.Manufacturer()},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){this.$emit("refresh")},destroyed:function(){},activated:function(){}},f={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"box_s"},[a("router-view",{on:{refresh:t.start}}),t._v(" "),a("div",{staticClass:"retrieve"},[a("span",{staticClass:"leftSpan"},[t._v("编辑整机采购")]),t._v(" "),1!=t.MPO.State&&2!=t.MPO.State||t.edit?t._e():a("saxo-button",{staticClass:"butState",attrs:{mini:"",type:"primary"},on:{click:function(e){t.edit=!t.edit}}},[t._v("编辑")]),t._v(" "),1!=t.MPO.State&&2!=t.MPO.State||!t.edit?t._e():a("saxo-button",{staticClass:"butState",attrs:{mini:"",type:"success"},on:{click:function(e){return t.editFun(!0)}}},[t._v("保存")]),t._v(" "),1!=t.MPO.State&&2!=t.MPO.State||!t.edit?t._e():a("saxo-button",{staticClass:"butState",attrs:{mini:"",type:"danger"},on:{click:function(e){return t.editFun(!1)}}},[t._v("放弃")]),t._v(" "),1==t.MPO.State?a("saxo-button",{staticClass:"butState",attrs:{mini:"",plain:"",type:"info"},on:{click:function(e){return t.MPOSubmitForVerify()}}},[t._v("提交预审批")]):t._e(),t._v(" "),2==t.MPO.State?a("saxo-button",{staticClass:"butState",attrs:{mini:"",plain:"",type:"primary"},on:{click:function(e){return t.MPOApproval(1)}}},[t._v("总经理批准采购")]):t._e(),t._v(" "),2==t.MPO.State?a("saxo-button",{staticClass:"butState",attrs:{mini:"",plain:"",type:"danger"},on:{click:function(e){return t.MPOApproval(0)}}},[t._v("总经理驳回采购")]):t._e(),t._v(" "),8==t.MPO.State?a("saxo-button",{staticClass:"butState",attrs:{mini:"",plain:"",type:"primary"},on:{click:function(e){return t.MPOSubmitForManager(1)}}},[t._v("部门经理批准采购")]):t._e(),t._v(" "),8==t.MPO.State?a("saxo-button",{staticClass:"butState",attrs:{mini:"",plain:"",type:"danger"},on:{click:function(e){return t.MPOSubmitForManager(0)}}},[t._v("部门经理驳回采购")]):t._e(),t._v(" "),t.MPO.AllowClose?a("saxo-button",{staticClass:"butState",attrs:{mini:"",type:"primary"},on:{click:function(e){return t.Statement()}}},[t._v("结单")]):t._e(),t._v(" "),1==t.MPO.State?a("saxo-button",{staticClass:"butState",attrs:{mini:"",type:"danger"},on:{click:function(e){return t.deleteOrder()}}},[t._v("删除")]):t._e()],1),t._v(" "),a("div",{staticClass:"Con"},[t.MPO.CreateDateStr?t._e():a("div",{staticClass:"el-descriptions__title"},[t._v("基础信息")]),t._v(" "),t.MPO.CreateDateStr?t._e():a("br"),t._v(" "),t.MPO.CreateDateStr?t._e():a("el-skeleton",{attrs:{rows:6,animated:""}}),t._v(" "),a("el-descriptions",{staticClass:"margin-top",attrs:{title:"基础信息",column:3,size:"mini",border:""}},[a("template",{slot:"extra"}),t._v(" "),a("el-descriptions-item",[a("template",{slot:"label"},[t._v("\n                       创建时间\n                   ")]),t._v("\n                   "+t._s("  "+t.MPO.CreateDateStr)+"\n               ")],2),t._v(" "),a("el-descriptions-item",[a("template",{slot:"label"},[a("i",{staticClass:"el-icon-mobile-phone"}),t._v("\n                       采购单编号\n                   ")]),t._v(" "),t.edit?t._e():a("span",[t._v(t._s("  "+t.MPO.POCode))]),t._v(" "),t.edit?a("el-input",{staticStyle:{width:"192px"},attrs:{size:"mini",placeholder:"请输入内容"},model:{value:t.MPO.POCode,callback:function(e){t.$set(t.MPO,"POCode",e)},expression:"MPO.POCode"}}):t._e()],2),t._v(" "),a("el-descriptions-item",[a("template",{slot:"label"},[a("i",{staticClass:"el-icon-location-outline"}),t._v("\n                       供应商\n                   ")]),t._v("\n                   "+t._s("  "+t.MPO.CusFullName)+"\n\n               ")],2),t._v(" "),a("el-descriptions-item",[a("template",{slot:"label"},[a("i",{staticClass:"el-icon-tickets"}),t._v("\n                       采购员\n                   ")]),t._v("\n                   "+t._s("  "+t.MPO.Buyer)+"\n               ")],2),t._v(" "),t.edit?t._e():a("el-descriptions-item",[a("template",{slot:"label"},[a("i",{staticClass:"el-icon-office-building"}),t._v("\n                       隶属公司\n                   ")]),t._v("\n                   "+t._s("  "+t.MPO.BelongCompany)+"\n               ")],2),t._v(" "),t.edit?a("el-descriptions-item",[a("template",{slot:"label"},[a("i",{staticClass:"el-icon-office-building"}),t._v("\n                       隶属公司\n                   ")]),t._v(" "),a("el-select",{attrs:{placeholder:"请选择",size:"mini"},model:{value:t.MPO.BelongCompany,callback:function(e){t.$set(t.MPO,"BelongCompany",e)},expression:"MPO.BelongCompany"}},t._l(t.BelongCompanyList,function(t){return a("el-option",{key:t,attrs:{label:t,value:t}})}),1)],2):t._e(),t._v(" "),t.edit?t._e():a("el-descriptions-item",[a("template",{slot:"label"},[a("i",{staticClass:"el-icon-office-building"}),t._v("\n                       付款方式\n                   ")]),t._v(" "),1==t.MPO.PayType?a("span",[t._v("  付全款")]):t._e(),t._v(" "),2==t.MPO.PayType?a("span",[t._v("  分期付款")]):t._e(),t._v(" "),3==t.MPO.PayType?a("span",[t._v("  先发货后付款")]):t._e()],2),t._v(" "),t.edit?a("el-descriptions-item",[a("template",{slot:"label"},[a("i",{staticClass:"el-icon-office-building"}),t._v("\n                       付款方式\n                   ")]),t._v(" "),a("el-select",{attrs:{placeholder:"请选择",size:"mini"},model:{value:t.MPO.PayType,callback:function(e){t.$set(t.MPO,"PayType",e)},expression:"MPO.PayType"}},t._l(t.PayTypeList,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],2):t._e(),t._v(" "),a("el-descriptions-item",[a("template",{slot:"label"},[a("i",{staticClass:"el-icon-office-building"}),t._v("\n                       付款状态\n                   ")]),t._v("\n                   "+t._s("  "+t.MPO.PayStateStr)+"\n               ")],2),t._v(" "),a("el-descriptions-item",[a("template",{slot:"label"},[a("i",{staticClass:"el-icon-office-building"}),t._v("\n                       状态\n                   ")]),t._v("\n                   "+t._s("  "+t.MPO.StateStr)+"\n               ")],2)],2),t._v(" "),a("br"),t._v(" "),a("div",{staticClass:"el-descriptions__title"},[t._v("设备清单\n               "),a("span",{staticStyle:{"font-size":"14px",color:"#909399"}},[t._v(t._s(t.MPO.EquCount))]),t._v(" "),t.MPO.State<3?a("saxo-button",{staticStyle:{float:"right","margin-right":"10px"},attrs:{mini:"",type:"success"},on:{click:function(e){t.drawer2=!0,t.DrawerSearchFun()}}},[t._v("从整机销售合同中添加")]):t._e(),t._v(" "),t.MPO.State<3?a("saxo-button",{staticStyle:{float:"right","margin-right":"10px"},attrs:{mini:"",type:"success"},on:{click:function(e){return t.ShowFalse(!0)}}},[t._v("添加")]):t._e(),t._v(" "),-1!=[3,4,5,6].indexOf(t.MPO.State)?a("saxo-button",{staticStyle:{float:"right","margin-right":"10px"},attrs:{slot:"append",mini:"",type:"success"},on:{click:function(e){return t.Ship()}},slot:"append"},[t._v("供应商发货")]):t._e(),t._v(" "),-1!=[3,4,5,6].indexOf(t.MPO.State)?a("el-input",{staticStyle:{width:"400px",float:"right"},attrs:{placeholder:"请输入发货备注  非必填",size:"mini"},model:{value:t.ShippingRemarks,callback:function(e){t.ShippingRemarks=e},expression:"ShippingRemarks"}}):t._e(),t._v(" "),-1!=[3,4,5,6].indexOf(t.MPO.State)?a("el-button",{staticStyle:{float:"right",background:"#01000000",border:"none",color:"#67C23A",cursor:"default"},attrs:{type:"success",size:"mini"}},[a("label",{attrs:{for:"int"}},[a("i",{staticClass:"el-icon-upload2"}),t._v("\n                       上传发货表\n                   ")]),t._v(" "),a("input",{ref:"referenceUpload",staticStyle:{"margin-left":"70px",display:"none"},attrs:{id:"int",type:"file",accept:".xlsx, .xls"},on:{change:function(e){return t.getFile(e,1)}}})]):t._e(),t._v(" "),-1!=[3,4,5,6].indexOf(t.MPO.State)?a("el-link",{staticStyle:{float:"right","font-size":"12px","line-height":"28px"},attrs:{href:"http://erp.inchwell.com.cn/mould/document/download/整机采购设备清单发货上传表.xlsx",type:"primary",underline:!1}},[a("i",{staticClass:"el-icon-download"}),t._v("\n                   下载发货模板表\n               ")]):t._e(),t._v(" "),1==t.MPO.State||2==t.MPO.State?a("el-button",{staticStyle:{float:"right",background:"#01000000",border:"none",color:"#67C23A",cursor:"default"},attrs:{type:"success",size:"mini"}},[a("label",{attrs:{for:"int2"}},[a("i",{staticClass:"el-icon-upload2"}),t._v("\n                       上传备注表\n                   ")]),t._v(" "),a("input",{ref:"referenceUpload",staticStyle:{"margin-left":"70px",display:"none"},attrs:{id:"int2",type:"file",accept:".xlsx, .xls"},on:{change:function(e){return t.getFile(e,4)}}})]):t._e(),t._v(" "),1==t.MPO.State||2==t.MPO.State?a("el-link",{staticStyle:{float:"right","font-size":"12px","line-height":"28px"},attrs:{href:"http://erp.inchwell.com.cn/mould/document/download/整机采购批量修改设备备注模板.xlsx",type:"primary",underline:!1}},[a("i",{staticClass:"el-icon-download"}),t._v("\n                   下载修改备注表\n               ")]):t._e(),t._v(" "),1==t.MPO.State||2==t.MPO.State?a("el-button",{staticStyle:{float:"right",background:"#01000000",border:"none",color:"#67C23A",cursor:"default"},attrs:{type:"success",size:"mini"}},[a("label",{attrs:{for:"int3"}},[a("i",{staticClass:"el-icon-upload2"}),t._v("\n                       上传批量导入设备表\n                   ")]),t._v(" "),a("input",{ref:"referenceUpload",staticStyle:{"margin-left":"70px",display:"none"},attrs:{id:"int3",type:"file",accept:".xlsx, .xls"},on:{change:function(e){return t.getFile(e,5)}}})]):t._e(),t._v(" "),1==t.MPO.State||2==t.MPO.State?a("el-link",{staticStyle:{float:"right","font-size":"12px","line-height":"28px"},attrs:{href:"http://erp.inchwell.com.cn/mould/document/download/采购批量导入设备.xlsx",type:"primary",underline:!1}},[a("i",{staticClass:"el-icon-download"}),t._v("\n                   下载批量导入设备表\n               ")]):t._e()],1),t._v(" "),a("DeviceDatabase",{attrs:{show:t.DeviceDatabaseShow,protype:"6"},on:{ShowFalse:t.ShowFalse,DataBase:t.DataBase}}),t._v(" "),a("br"),t._v(" "),t.edit?t._e():a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.MPO.MachinePOEquDtos,"header-cell-style":t.headerCellStyle2,"cell-style":t.cellStyle,stripe:""}},[a("el-table-column",{attrs:{label:"序号",type:"index",width:"50"}}),t._v(" "),a("el-table-column",{attrs:{prop:"ProductCode",label:"产品编码","show-overflow-tooltip":!0,width:"150"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Describe",label:"描述"}}),t._v(" "),a("el-table-column",{attrs:{label:"净库存",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                       "+t._s(e.row.NetInventory.split("*")[4])+"\n                   ")]}}],null,!1,960072557)}),t._v(" "),a("el-table-column",{attrs:{label:"采购单价",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{float:"right"}},[t._v(t._s(t.CurrencySign+e.row.UnitPrice.toFixed(2)))])]}}],null,!1,2427540817)}),t._v(" "),a("el-table-column",{attrs:{label:"数量",width:"50"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticStyle:{"text-align":"center"}},[t._v(t._s(e.row.POQuantity))])]}}],null,!1,496730816)}),t._v(" "),a("el-table-column",{attrs:{label:"累计发货",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticStyle:{"text-align":"center"}},[t._v(t._s(e.row.DeliverQuantity))])]}}],null,!1,1637156218)}),t._v(" "),a("el-table-column",{attrs:{label:"不发货量",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticStyle:{"text-align":"center"}},[t._v(t._s(e.row.NoSentQuantity))])]}}],null,!1,1272038066)}),t._v(" "),a("el-table-column",{attrs:{label:"备注",width:"150","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                       "+t._s(e.row.Memo||"无")+"\n                   ")]}}],null,!1,2602325367)}),t._v(" "),-1!=[3,4,5,6].indexOf(t.MPO.State)?a("el-table-column",{attrs:{label:"发货数量",fixed:"right",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{attrs:{size:"mini",placeholder:"发货"},model:{value:e.row.FHQuantity,callback:function(a){t.$set(e.row,"FHQuantity",a)},expression:"scope.row.FHQuantity"}})]}}],null,!1,3013784659)}):t._e()],1),t._v(" "),t.edit?a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.MPO.MachinePOEquDtos,"header-cell-style":t.headerCellStyle2,"cell-style":t.cellStyle,stripe:""},on:{"cell-click":t.CellClick}},[a("el-table-column",{attrs:{label:"序号",type:"index",width:"50"}}),t._v(" "),a("el-table-column",{attrs:{prop:"ProductCode",label:"产品编码","show-overflow-tooltip":!0,width:"150"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Describe",label:"描述"}}),t._v(" "),a("el-table-column",{attrs:{label:"净库存",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                       "+t._s(e.row.NetInventory.split("*")[4])+"\n                   ")]}}],null,!1,960072557)}),t._v(" "),a("el-table-column",{attrs:{label:"采购单价",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{staticStyle:{width:"100%"},attrs:{size:"mini",placeholder:"申请发货数量"},on:{change:function(a){return t.UpdateMPOEquPrice(e.row)}},model:{value:e.row.UnitPrice,callback:function(a){t.$set(e.row,"UnitPrice",a)},expression:"scope.row.UnitPrice"}})]}}],null,!1,1389815467)}),t._v(" "),a("el-table-column",{attrs:{label:"数量",width:"130"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{attrs:{id:"Number_input"}},[a("div",{staticClass:"div_icon_text",on:{click:function(a){return t.UpdateMPOEquPrice(e.row,"Del")}}},[a("i",{staticClass:"el-icon-minus"})]),t._v(" "),a("div",{staticClass:"div_icon_textConter"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.row.POQuantity,expression:"scope.row.POQuantity"}],staticStyle:{"text-align":"center","border-style":"none",outline:"none",width:"100%"},attrs:{type:"text",name:"",id:""},domProps:{value:e.row.POQuantity},on:{blur:function(a){return t.UpdateMPOEquPrice(e.row,"saxo",e.row.POQuantity)},input:function(a){a.target.composing||t.$set(e.row,"POQuantity",a.target.value)}}})]),t._v(" "),a("div",{staticClass:"div_icon_text",on:{click:function(a){return t.UpdateMPOEquPrice(e.row,"Add")}}},[a("i",{staticClass:"el-icon-plus"})])])]}}],null,!1,2812734178)}),t._v(" "),a("el-table-column",{attrs:{label:"不发货量",width:"130"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{attrs:{id:"Number_input"}},[a("div",{staticClass:"div_icon_text",on:{click:function(a){return t.UpdateNoSentQuantity(e.row,"Del")}}},[a("i",{staticClass:"el-icon-minus"})]),t._v(" "),a("div",{staticClass:"div_icon_textConter"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.row.NoSentQuantity,expression:"scope.row.NoSentQuantity"}],staticStyle:{"text-align":"center","border-style":"none",outline:"none",width:"100%"},attrs:{type:"text",name:"",id:""},domProps:{value:e.row.NoSentQuantity},on:{blur:function(a){return t.UpdateNoSentQuantity(e.row,"saxo",e.row.NoSentQuantity)},input:function(a){a.target.composing||t.$set(e.row,"NoSentQuantity",a.target.value)}}})]),t._v(" "),a("div",{staticClass:"div_icon_text",on:{click:function(a){return t.UpdateNoSentQuantity(e.row,"Add")}}},[a("i",{staticClass:"el-icon-plus"})])])]}}],null,!1,1729286808)}),t._v(" "),a("el-table-column",{attrs:{label:"备注",width:"150","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{color:"#409EFF"}},[t._v(t._s(e.row.Memo||"无")+" ")])]}}],null,!1,2039781666)}),t._v(" "),a("el-table-column",{attrs:{label:"操作",fixed:"right",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("saxo-button",{attrs:{mini:"",type:"danger"},on:{click:function(a){return t.dele(e.row)}}},[t._v("删除")])]}}],null,!1,1691880002)})],1):t._e(),t._v(" "),a("br"),t._v(" "),t.edit?t._e():a("el-descriptions",[void 0!=t.MPO.StorageCost?a("el-descriptions-item",{attrs:{label:"仓储费用"}},[t._v(t._s(t.CurrencySign+t.MPO.StorageCost.toFixed(2)))]):t._e(),t._v(" "),void 0!=t.MPO.LogisticsCost?a("el-descriptions-item",{attrs:{label:"物流费用"}},[t._v(t._s(t.CurrencySign+t.MPO.LogisticsCost.toFixed(2)))]):t._e(),t._v(" "),void 0!=t.MPO.RebateCost?a("el-descriptions-item",{attrs:{label:"返利金额"}},[t._v(t._s(t.CurrencySign+t.MPO.RebateCost.toFixed(2)))]):t._e(),t._v(" "),void 0!=t.MPO.TotalAmount?a("el-descriptions-item",{attrs:{label:"合计金额"}},[t._v(t._s(t.CurrencySign+t.MPO.TotalAmount.toFixed(2)))]):t._e(),t._v(" "),void 0!=t.MPO.TotalAmountRMB?a("el-descriptions-item",{attrs:{label:"人民币合计"}},[t._v(t._s(t.CurrencySign+t.MPO.TotalAmountRMB.toFixed(2)))]):t._e()],1),t._v(" "),t.edit?a("el-descriptions",[a("el-descriptions-item",{attrs:{label:"仓储费用"}},[a("el-input",{staticStyle:{width:"100px"},attrs:{size:"mini",placeholder:"仓储费用"},model:{value:t.MPO.StorageCost,callback:function(e){t.$set(t.MPO,"StorageCost",e)},expression:"MPO.StorageCost"}})],1),t._v(" "),a("el-descriptions-item",{attrs:{label:"物流费用"}},[a("el-input",{staticStyle:{width:"100px"},attrs:{size:"mini",placeholder:"物流费用"},model:{value:t.MPO.LogisticsCost,callback:function(e){t.$set(t.MPO,"LogisticsCost",e)},expression:"MPO.LogisticsCost"}})],1),t._v(" "),a("el-descriptions-item",{attrs:{label:"返利金额"}},[a("el-input",{staticStyle:{width:"100px"},attrs:{size:"mini",placeholder:"返利金额"},model:{value:t.MPO.RebateCost,callback:function(e){t.$set(t.MPO,"RebateCost",e)},expression:"MPO.RebateCost"}})],1),t._v(" "),void 0!=t.MPO.TotalAmount?a("el-descriptions-item",{attrs:{label:"合计金额"}},[t._v(t._s(t.CurrencySign+t.MPO.TotalAmount.toFixed(2)))]):t._e(),t._v(" "),void 0!=t.MPO.TotalAmountRMB?a("el-descriptions-item",{attrs:{label:"人民币合计"}},[t._v(t._s(t.CurrencySign+t.MPO.TotalAmountRMB.toFixed(2)))]):t._e()],1):t._e(),t._v(" "),a("br"),t._v(" "),-1!=[3,4,5,6].indexOf(t.MPO.State)?a("div",{staticClass:"el-descriptions__title"},[t._v("收货清单\n\n               "),t._v(" "),a("el-link",{staticStyle:{float:"right","margin-right":"20px"},attrs:{type:"primary"},on:{click:function(e){return t.LookKuWei()}}},[t._v("\n                   查看库位\n                   "),a("i",{staticClass:"el-icon-search"})])],1):t._e(),t._v(" "),a("br"),t._v(" "),a("el-collapse",t._l(t.MPO.MacPODispatchOrderDtos,function(e,n){return a("el-collapse-item",{key:n,attrs:{title:"第 "+(n+1)+" 次发货       共"+e.NumberOfSpecies+"种       共"+e.number99+"件       确认到货"+e.numberCai+"       物流收货"+e.numberKu+"      "+e.CreateDate.split("T")[0],name:n}},[a("template",{slot:"title"},[a("div",[a("span",{staticClass:"linkSpan"},[t._v("第"+t._s(n+1)+" 次发货")]),t._v(" \n                           "),a("span",{staticClass:"linkSpan"},[t._v("共"+t._s(e.NumberOfSpecies)+"种")]),t._v(" \n                           "),a("span",{staticClass:"linkSpan"},[t._v("共"+t._s(e.number99)+"件")]),t._v(" \n                           "),a("span",{staticClass:"linkSpan"},[t._v("物流收货"+t._s(e.numberKu))]),t._v(" \n                           "),a("span",{staticClass:"linkSpan"},[t._v(t._s(e.CreateDate.split("T")[0]))]),t._v(" \n                           "),a("span",{staticClass:"linkSpan",staticStyle:{width:"150px"}},[t._v("货物价值 "+t._s(t.FinancialAmountFormat(e.GoodsValue,t.CurrencySign)))]),t._v(" \n\n                           "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.Memo||"无",placement:"top-start"}},[a("span",{staticClass:"linkSpan",staticStyle:{width:"150px",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"}},[t._v(" 备注："+t._s(e.Memo||"无"))]),t._v(" \n                           ")]),t._v(" "),a("el-link",{staticClass:"linkSpan",attrs:{type:"primary"},on:{click:function(a){return a.stopPropagation(),t.DownloadTheStorageOrder(e,n)}}},[t._v("下载入库单")]),t._v(" "),a("el-input",{staticStyle:{width:"200px","margin-left":"50px"},attrs:{placeholder:"请输入检索项",size:"mini",clearable:""},on:{focus:function(e){t.ReceiptInformationRetrievalIndex=n},input:t.ReceiptInformationRetrieval},nativeOn:{click:function(t){t.stopPropagation()}},model:{value:e.Search,callback:function(a){t.$set(e,"Search",a)},expression:"item.Search"}})],1)]),t._v(" "),a("div",{staticClass:"ShippingDetails"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.MacPODispatchOrderGoodDtos,size:"mini"}},[a("el-table-column",{attrs:{prop:"ProductCode",label:"产品编码",width:"150"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Describe",label:"描述","show-overflow-tooltip":!0}}),t._v(" "),a("el-table-column",{attrs:{prop:"Locations",label:"库存库位",width:"200"}}),t._v(" "),a("el-table-column",{attrs:{width:"350"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.LocationInfo2,function(e,n){return a("div",{key:n,staticStyle:{float:"left","min-width":"100px"}},[t._v(" "+t._s(e+"]")+" ")])})}}],null,!0)},[a("template",{slot:"header"},[a("p",[t._v(t._s("入库信息"))])])],2),t._v(" "),a("el-table-column",{attrs:{prop:"DeliverQuantity",label:"发货数量",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{label:"物流收货",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.RuKu,function(i,o){return a("div",{key:o,staticClass:"ShippingDetails_scope"},[a("el-input",{staticStyle:{width:"60px",float:"left"},attrs:{size:"mini",placeholder:"数量"},model:{value:i.num,callback:function(e){t.$set(i,"num",e)},expression:"RuKuItem.num"}}),t._v(" "),a("el-input",{staticStyle:{width:"90px",float:"left"},attrs:{size:"mini",placeholder:"库位"},model:{value:i.ku,callback:function(e){t.$set(i,"ku",e)},expression:"RuKuItem.ku"}}),t._v(" "),0==o?a("span",{staticClass:"span3"},[a("i",{staticClass:"el-icon-circle-plus",staticStyle:{fontSize:"17px",color:"#67C23A",marginTop:"5px"},on:{click:function(a){return t.AddStorageLocation(n,e.row.ID)}}})]):t._e(),t._v(" "),0!=o?a("span",{staticClass:"span3"},[a("i",{staticClass:"el-icon-remove",staticStyle:{fontSize:"17px",color:"#F56C6C",marginTop:"5px"},on:{click:function(a){return t.DeleteStorageLocation(n,e.row.ID,o)}}})]):t._e()],1)})}}],null,!0)})],1),t._v(" "),a("el-table",{staticStyle:{display:"none"},attrs:{data:e.MacPODispatchOrderGoodDtos,id:"out-table-"+n,size:"mini"}},[a("el-table-column",{attrs:{prop:"Describe",label:"描述","show-overflow-tooltip":!0}}),t._v(" "),a("el-table-column",{attrs:{prop:"ProductCode",label:"产品编码",width:"150"}}),t._v(" "),a("el-table-column",{attrs:{width:"350"}},[a("template",{slot:"header"},[a("p",[t._v(t._s("收货数量"))])])],2),t._v(" "),a("el-table-column",{attrs:{width:"350"}},[a("template",{slot:"header"},[a("p",[t._v(t._s("库位"))])])],2)],1),t._v(" "),a("div",{staticClass:"ShippingDetails_primary"},[a("saxo-button",{staticStyle:{float:"right",margin:"0 5px"},attrs:{mini:"",type:"primary"},on:{click:function(a){return t.ReceiveQuantityFun(e.MacPODispatchOrderGoodDtos)}}},[t._v("保存物流数量")]),t._v(" "),a("el-button",{staticStyle:{float:"right",background:"#01000000",border:"none",color:"#67C23A",cursor:"default"},attrs:{type:"success",size:"mini"}},[a("label",{attrs:{for:n+"2"}},[a("i",{staticClass:"el-icon-upload"}),t._v("\n                                   上传入库文件\n                               ")]),t._v(" "),a("input",{ref:"referenceUpload",refInFor:!0,staticStyle:{"margin-left":"70px",display:"none"},attrs:{id:n+"2",type:"file",accept:".xlsx, .xls"},on:{change:function(e){return t.getFile(e,3,n)}}})]),t._v(" "),a("el-button",{staticStyle:{float:"right",background:"#01000000",border:"none",color:"#5e72e4",cursor:"default"},attrs:{type:"success",size:"mini"},on:{click:function(e){return t.DownloadStorageFile("#out-table-"+n)}}},[a("i",{staticClass:"el-icon-upload"}),t._v("\n                               下载入库文件\n                           ")])],1)],1)],2)}),1),t._v(" "),a("br"),t._v(" "),-1!=[3,4,5,6].indexOf(t.MPO.State)?a("div",[a("div",{staticClass:"el-descriptions__title"},[t._v("设备变更清单\n                   "),t._v(" "),a("saxo-button",{staticStyle:{float:"right"},attrs:{mini:"",type:"success"},on:{click:function(e){return t.ApplyToChangeEquipment()}}},[t._v("申请变更设备")])],1),t._v(" "),a("br"),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.MPO.MpoReturnDtos,"header-cell-style":t.headerCellStyle,"cell-style":t.cellStyle,stripe:""}},[a("el-table-column",{attrs:{label:"创建时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(" "+t._s(e.row.CreateDate.split("T")[0]))])]}}],null,!1,338188898)}),t._v(" "),a("el-table-column",{attrs:{label:"类别"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.Type))])]}}],null,!1,1730832542)}),t._v(" "),a("el-table-column",{attrs:{prop:"StateStr",label:"状态"}}),t._v(" "),a("el-table-column",{attrs:{label:"差额",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{float:"right"}},[t._v(" "+t._s(t.FinancialAmountFormat(e.row.ChaAmount)))])]}}],null,!1,1768404031)}),t._v(" "),a("el-table-column",{attrs:{label:"系统信息",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-popover",{attrs:{placement:"top-start",title:"系统信息",trigger:"hover"}},[t._l(e.row.SystemInfo.split("@"),function(e,n){return a("p",{key:n},[t._v(t._s(e))])}),t._v(" "),a("span",{attrs:{slot:"reference"},slot:"reference"},[t._v("系统信息"),a("i",{staticClass:"el-icon-warning-outline"})])],2)]}}],null,!1,3627510684)}),t._v(" "),a("el-table-column",{attrs:{label:"详情",fixed:"right",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-link",{staticStyle:{"font-size":"12px"},attrs:{type:"primary",underline:!1},on:{click:function(a){return t.SeeApplyEquipment(e.row)}}},[t._v("详情")])]}}],null,!1,3825900256)})],1)],1):t._e(),t._v(" "),a("br"),t._v(" "),a("SaxoDrawer",{attrs:{show:t.SaxoDrawer,title:t.MPO.CusFullName+"(挂账款 & 不明款 & 资金池)"},on:{ShowFalse:function(e){t.SaxoDrawer=!1}}},[a("div",{staticClass:"DeawerBox"},[a("div",{staticClass:"table"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.CapitalPoolDtos,height:"100%"}},[a("el-table-column",{attrs:{label:"类别",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return["挂帐款"==e.row.LB?a("span",[t._v(" "+t._s(e.row.LB+"("+e.row.InvoiceStateStr+")"))]):t._e(),t._v(" "),"挂帐款"!=e.row.LB?a("span",[t._v(" "+t._s(e.row.LB))]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"资金量",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{float:"right"}},[t._v(" "+t._s(t.FinancialAmountFormat(e.row.Amount,t.FinancialAmountSymbol(e.row.BuyingCurrency))))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"使用量",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{float:"right"}},[t._v(" "+t._s(t.FinancialAmountFormat(e.row.UsageAmount,t.FinancialAmountSymbol(e.row.BuyingCurrency))))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"Creater",label:"创建人",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"CreateDate",label:"创建时间",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"StateStr",label:"状态",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{label:"系统信息","show-overflow-tooltip":!0,width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-popover",{attrs:{placement:"top-start",title:"系统信息",trigger:"hover"}},[t._l(e.row.SystemInfo2,function(e,n){return a("p",{key:n},[t._v(t._s(e))])}),t._v(" "),a("span",{attrs:{slot:"reference"},slot:"reference"},[t._v("系统信息"),a("i",{staticClass:"el-icon-warning-outline"})])],2)]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"Memo",label:"备注"}}),t._v(" "),a("el-table-column",{attrs:{label:"使用量",fixed:"right",width:"150px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{attrs:{size:"mini",type:"number",placeholder:"请输入使用量"},model:{value:e.row.Number,callback:function(a){t.$set(e.row,"Number",a)},expression:"scope.row.Number"}})]}}])})],1)],1),t._v(" "),a("div",{staticClass:"but"},[a("div",[t._v("认款合计：￥"),a("span",[t._v(" "+t._s(t.Subscription))])]),t._v(" "),a("saxo-button",{staticClass:"butState",attrs:{mini:"",type:"primary"},on:{click:t.AddMSOPaymentFun}},[t._v("确认")])],1)])]),t._v(" "),-1!=[3,4,5,6].indexOf(t.MPO.State)?a("div",[a("div",{staticClass:"el-descriptions__title"},[t._v("付款清单\n\n                   "),t.MachinePOPayDtosHJ<t.MPO.TotalAmount?a("saxo-button",{staticStyle:{float:"right","margin-left":"100px"},attrs:{mini:"",type:"success"},on:{click:function(e){return t.applyToUseAccounts()}}},[t._v("申请使用挂账款")]):t._e(),t._v(" "),t.MachinePOPayDtosHJ<t.MPO.TotalAmount?a("el-input",{staticStyle:{width:"250px",float:"right"},attrs:{placeholder:"请输入金额",size:"mini"},model:{value:t.PaymentAmount,callback:function(e){t.PaymentAmount=e},expression:"PaymentAmount"}},[t.MachinePOPayDtosHJ<t.MPO.TotalAmount?a("el-button",{attrs:{slot:"append",type:"success",id:"success_s"},on:{click:t.PaymentAmountClick},slot:"append"},[t._v("申请网银付款")]):t._e()],1):t._e(),t._v(" "),t.MachinePOPayDtosHJ<t.MPO.TotalAmount?a("el-input",{staticStyle:{width:"130px",float:"right"},attrs:{placeholder:"百分比",size:"mini"},model:{value:t.PaymentAmountBFB,callback:function(e){t.PaymentAmountBFB=e},expression:"PaymentAmountBFB"}},[a("template",{slot:"append"},[t._v("%")])],2):t._e()],1),t._v(" "),a("br"),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.MPO.MachinePOPayDtos,"header-cell-style":t.headerCellStyle,"cell-style":t.cellStyle,stripe:""}},[a("el-table-column",{attrs:{label:"创建时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.CreateDate.split("T")[0]))])]}}],null,!1,3961921737)}),t._v(" "),a("el-table-column",{attrs:{label:"付款金额",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{float:"right"}},[t._v(" "+t._s(t.FinancialAmountFormat(e.row.Amount,t.CurrencySign)))])]}}],null,!1,169498669)}),t._v(" "),a("el-table-column",{attrs:{label:"付款比例",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{float:"right"}},[t._v(" "+t._s((e.row.Amount/t.MPO.TotalAmount*100).toFixed(2)+"%"))])]}}],null,!1,802417290)}),t._v(" "),a("el-table-column",{attrs:{label:"付款与退款",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{float:"right"}},[t._v(" "+t._s(t.FinancialAmountFormat(e.row.PayBy||e.row.RefundTo)))])]}}],null,!1,275525151)}),t._v(" "),a("el-table-column",{attrs:{prop:"Creater",label:"申请人"}}),t._v(" "),a("el-table-column",{attrs:{prop:"AuditorA",label:"请款"}}),t._v(" "),a("el-table-column",{attrs:{prop:"AuditorB",label:"审核请款"}}),t._v(" "),a("el-table-column",{attrs:{prop:"AuditorC",label:"批准采购"}}),t._v(" "),a("el-table-column",{attrs:{prop:"PayStateStr",label:"付款状态"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Memo",label:"备注","show-overflow-tooltip":!0}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.Amount>0&&"已付款"==e.row.PayStateStr?a("saxo-button",{attrs:{mini:"",type:"danger"},on:{click:function(a){return t.RequestRefund(e.row)}}},[t._v("申请退款")]):t._e()]}}],null,!1,837958280)})],1),t._v(" "),a("br")],1):t._e(),t._v(" "),a("el-dialog",{attrs:{title:"申请退款",visible:t.RequestRefundDialog,width:"800px","append-to-body":!0},on:{"update:visible":function(e){t.RequestRefundDialog=e}}},[a("el-form",{attrs:{"label-width":"80px",model:t.RequestRefundData,size:"mini"}},[a("el-form-item",{attrs:{label:"付款金额"}},[a("span",{domProps:{textContent:t._s(t.FinancialAmountFormat(t.RequestRefundData.Amount,t.FinancialAmountSymbol(t.MPO.BuyingCurrency)))}})]),t._v(" "),a("el-form-item",{attrs:{label:"退款金额"}},[a("el-input-number",{attrs:{"controls-position":"right",min:0,max:t.RequestRefundData.Amount},model:{value:t.RequestRefundData.RefundAmount,callback:function(e){t.$set(t.RequestRefundData,"RefundAmount",e)},expression:"RequestRefundData.RefundAmount"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"资金去向"}},[a("el-radio-group",{model:{value:t.RequestRefundData.RefundTo,callback:function(e){t.$set(t.RequestRefundData,"RefundTo",e)},expression:"RequestRefundData.RefundTo"}},[a("el-radio",{attrs:{label:"网银"}},[t._v("网银")]),t._v(" "),a("el-radio",{attrs:{label:"已开票挂账"}},[t._v("已开票挂账")]),t._v(" "),"RMB"==t.MPO.BuyingCurrency?a("el-radio",{attrs:{label:"未开票挂账"}},[t._v("未开票挂账")]):t._e()],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:4}},model:{value:t.RequestRefundData.Other,callback:function(e){t.$set(t.RequestRefundData,"Other",e)},expression:"RequestRefundData.Other"}})],1)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("saxo-button",{attrs:{mini:"",type:"info"},on:{click:function(e){t.RequestRefundDialog=!1}}},[t._v("取消")]),t._v(" "),a("saxo-button",{attrs:{mini:"",type:"primary"},on:{click:function(e){return t.RequestRefundPrimary()}}},[t._v("确认")])],1)],1),t._v(" "),-1!=[3,4,5,6].indexOf(t.MPO.State)?a("div",[a("div",{staticClass:"el-descriptions__title"},[t._v("发票清单\n                   "),t.MachinePOInvoiceDtosHJ<t.MPO.TotalAmount?a("el-input",{staticStyle:{width:"250px",float:"right"},attrs:{placeholder:"请输入金额",size:"mini"},model:{value:t.received,callback:function(e){t.received=e},expression:"received"}},[a("el-button",{attrs:{slot:"append",type:"success",id:"success_s"},on:{click:t.InvoiceReceived},slot:"append"},[t._v("收到发票")])],1):t._e()],1),t._v(" "),a("br"),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.MPO.MachinePOInvoiceDtos,"header-cell-style":t.headerCellStyle,"cell-style":t.cellStyle,stripe:""}},[a("el-table-column",{attrs:{label:"创建时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.CreateDate.split("T")[0]))])]}}],null,!1,3961921737)}),t._v(" "),a("el-table-column",{attrs:{label:"发票金额",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{float:"right"}},[t._v(" "+t._s(t.FinancialAmountFormat(e.row.Amount,t.CurrencySign)))])]}}],null,!1,169498669)}),t._v(" "),a("el-table-column",{attrs:{label:"发票比例",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{float:"right"}},[t._v(t._s((e.row.Amount/t.MPO.TotalAmount*100).toFixed(2)+"%"))])]}}],null,!1,535793889)}),t._v(" "),a("el-table-column",{attrs:{prop:"Creater",label:"申请人"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Confirmer",label:"财务确认人"}}),t._v(" "),a("el-table-column",{attrs:{prop:"POCode",label:"采购单编号"}}),t._v(" "),a("el-table-column",{attrs:{prop:"CusFullName",label:"供应商名称"}}),t._v(" "),a("el-table-column",{attrs:{prop:"InvoiceStateStr",label:"发票状态"}}),t._v(" "),a("el-table-column",{attrs:{prop:"ReceiverEmail",label:"收票人邮箱"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Logistics",label:"物流单号"}}),t._v(" "),a("el-table-column",{attrs:{prop:"InvCode",label:"发票号"}}),t._v(" "),a("el-table-column",{attrs:{label:"附件",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.InvFiles,function(e,n){return a("p",{key:n},[a("el-link",{attrs:{target:"_blank",type:"primary",href:"http://icms.inchwell.com.cn"+e.FileUrl}},[t._v(t._s(e.FileName))]),t._v("  \n                               "),a("span",{staticStyle:{color:"#409EFF",cursor:"pointer"},on:{click:function(a){return t.DwFileUrl(e.FileUrl,e.FileName)}}},[t._v("下载")])],1)})}}],null,!1,2529443027)}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"130"},scopedSlots:t._u([{key:"default",fn:function(e){return[2==e.row.InvoiceState?a("saxo-button",{attrs:{mini:"",type:"success"},on:{click:function(a){return t.OperationInvoice(e.row)}}},[t._v("申请操作")]):t._e(),t._v(" "),10==e.row.InvoiceState?a("saxo-button",{attrs:{mini:"",type:"success"},on:{click:function(a){return t.SubmitRedInv(e.row)}}},[t._v("提交冲红发票")]):t._e()]}}],null,!1,669846297)})],1),t._v(" "),a("br")],1):t._e(),t._v(" "),a("div",{staticClass:"el-descriptions__title"},[t._v("附件")]),t._v(" "),a("br"),t._v(" "),a("uploadFile",{attrs:{FileData:t.MachinePOFiles},on:{receive:t.receive,deleteFun:t.deleteFun}}),t._v(" "),a("br"),t._v(" "),a("div",{staticClass:"el-descriptions__title"},[t._v("备注")]),t._v(" "),a("br"),t._v(" "),a("el-input",{staticStyle:{width:"500px"},attrs:{type:"textarea",autosize:{minRows:5,maxRows:10},placeholder:"请输入内容"},model:{value:t.MPO.Memo,callback:function(e){t.$set(t.MPO,"Memo",e)},expression:"MPO.Memo"}}),t._v(" "),a("br"),t._v(" "),a("br"),t._v(" "),a("br"),t._v(" "),a("br"),t._v(" "),a("br"),t._v(" "),a("el-drawer",{attrs:{visible:t.drawer2,direction:"ltr",modal:!1,"with-header":!1,size:"70%"},on:{"update:visible":function(e){t.drawer2=e}}},[a("div",{staticClass:"DrawerHeader"},[t._v("整机销售合同")]),t._v(" "),a("div",{staticClass:"DrawerSearch"},[a("div",{staticClass:"DrawerSearchLeft"},[a("div",{staticClass:"department"},[a("span",[t._v("客户名称、单号")]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入客户名称、单号",size:"mini"},model:{value:t.DrawerSearch,callback:function(e){t.DrawerSearch=e},expression:"DrawerSearch"}})],1),t._v(" "),a("div",{staticClass:"department"},[a("span",[t._v("区域：")]),t._v(" "),a("el-select",{attrs:{size:"mini",clearable:"",placeholder:"请选择区域"},model:{value:t.area,callback:function(e){t.area=e},expression:"area"}},t._l(t.$store.state.Vuex.Area,function(t){return a("el-option",{key:t.Value,attrs:{label:t.Value,value:t.Value}})}),1)],1),t._v(" "),a("div",{staticClass:"department"},[a("span",[t._v("客户类型：")]),t._v(" "),a("el-select",{attrs:{placeholder:"请选择客户类型",size:"mini",clearable:""},model:{value:t.cusType,callback:function(e){t.cusType=e},expression:"cusType"}},t._l(t.Typeofcustomer,function(t,e){return a("el-option",{key:e,attrs:{label:t.label,value:t.label}})}),1)],1),t._v(" "),a("div",{staticClass:"department"},[a("span",[t._v("选择状态：")]),t._v(" "),a("el-select",{attrs:{placeholder:"请选择状态",size:"mini",clearable:""},model:{value:t.state,callback:function(e){t.state=e},expression:"state"}},t._l(t.options,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),a("div",{staticClass:"department"},[a("span",[t._v("销售员")]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入销售员",size:"mini"},model:{value:t.DrawerSaler,callback:function(e){t.DrawerSaler=e},expression:"DrawerSaler"}})],1)]),t._v(" "),a("div",{staticClass:"DrawerSearchRight"},[a("saxo-button",{attrs:{mini:"",type:"primary"},on:{click:function(e){return t.DrawerSearchFun()}}},[t._v("搜索")])],1)]),t._v(" "),a("div",{staticClass:"DrawerContent"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,height:"100%",size:"mini"}},[a("el-table-column",{attrs:{prop:"CusFullName",label:"客户名称","show-overflow-tooltip":!0}}),t._v(" "),a("el-table-column",{attrs:{prop:"SOCode",label:"订单编号"}}),t._v(" "),a("el-table-column",{attrs:{prop:"StateStr",label:"订单状态",width:"100px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"PayStatusStr",label:"付款状态",width:"100px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"DiscountAmount",label:"优惠后金额",width:"100px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"CreateDateStr",label:"创建时间",width:"150px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"SalerName",label:"销售",width:"100px"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("saxo-button",{attrs:{mini:"",type:"primary"},on:{click:function(a){return t.Check(e.row)}}},[t._v("查看")])]}}])})],1)],1),t._v(" "),a("div",{staticClass:"DrawerTail"},[a("SaxoFenYe",{attrs:{total:t.total2},on:{func:t.pageFun}})],1),t._v(" "),a("el-drawer",{attrs:{visible:t.drawer3,direction:"ltr",modal:!1,"with-header":!1,size:"60%"},on:{"update:visible":function(e){t.drawer3=e}}},[a("div",{staticClass:"DrawerHeader"},[t._v("整机销售合同设备")]),t._v(" "),a("div",{staticClass:"DrawerSearch"},[a("div",{staticClass:"DrawerSearchLeft"},[a("div",{staticClass:"department"},[a("span",[t._v("检索")]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},on:{input:function(e){return t.SeacrhEquFun()}},model:{value:t.SeacrhEqu,callback:function(e){t.SeacrhEqu=e},expression:"SeacrhEqu"}})],1),t._v(" "),a("div",{staticClass:"department"},[a("span",[t._v("品牌")]),t._v(" "),a("el-select",{attrs:{filterable:"",placeholder:"请选择",size:"mini",clearable:""},on:{change:function(e){return t.SeacrhEquFun()}},model:{value:t.brand,callback:function(e){t.brand=e},expression:"brand"}},t._l(t.brands,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1)]),t._v(" "),a("div",{staticClass:"DrawerSearchRight"})]),t._v(" "),a("div",{staticClass:"DrawerContent"},[a("el-table",{ref:"HeTong2",staticStyle:{width:"100%"},attrs:{data:t.MachineSOEquDtos,height:"100%",size:"mini","empty-text":"此合同未查询到设备"}},[a("el-table-column",{attrs:{prop:"ProductCode",label:"产品编码","show-overflow-tooltip":!0,width:"150"}}),t._v(" "),a("el-table-column",{attrs:{prop:"LongCode",label:"内部编码",width:"150"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Describe",label:"描述"}}),t._v(" "),a("el-table-column",{attrs:{label:"数量",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{attrs:{id:"Number_input"}},[a("div",{staticClass:"div_icon_text",on:{click:function(t){e.row.Quantity>1&&(e.row.Quantity=Number(e.row.Quantity)-1)}}},[a("i",{staticClass:"el-icon-minus"})]),t._v(" "),a("div",{staticClass:"div_icon_textConter"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.row.Quantity,expression:"scope.row.Quantity"}],staticStyle:{"text-align":"center","border-style":"none",outline:"none",width:"100%"},attrs:{type:"text"},domProps:{value:e.row.Quantity},on:{input:function(a){a.target.composing||t.$set(e.row,"Quantity",a.target.value)}}})]),t._v(" "),a("div",{staticClass:"div_icon_text",on:{click:function(t){e.row.Quantity=Number(e.row.Quantity)+1}}},[a("i",{staticClass:"el-icon-plus"})])])]}}])}),t._v(" "),a("el-table-column",{attrs:{type:"selection",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("saxo-button",{attrs:{mini:"",type:"primary"},on:{click:function(a){return t.AddTo(e.row)}}},[t._v("添加")])]}}])})],1)],1),t._v(" "),a("div",{staticClass:"DrawerTail"},[a("saxo-button",{staticStyle:{marginTop:"10px",float:"right",marginRight:"10px"},attrs:{mini:"",type:"primary"},on:{click:function(e){return t.AddToCheck()}}},[t._v("添加选择")])],1)])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"错误项 产品编码",visible:t.dialogVisible,width:"30%","append-to-body":!0},on:{"update:visible":function(e){t.dialogVisible=e}}},[t._l(t.dialogVisibleList,function(e,n){return a("span",{key:n+"dialogVisibleList"},[t._v(t._s(e)+" "),a("br")])}),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini"},on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){t.dialogVisible=!1}}},[t._v("确 定")])],1)],2),t._v(" "),a("el-dialog",{attrs:{title:"修改设备"+t.column.ProductCode+"的备注",visible:t.dialogVisible2,width:"30%","append-to-body":!0},on:{"update:visible":function(e){t.dialogVisible2=e}}},[a("el-input",{attrs:{type:"textarea",rows:4,placeholder:"请输入内容"},model:{value:t.column.Memo,callback:function(e){t.$set(t.column,"Memo",e)},expression:"column.Memo"}}),t._v(" "),a("span",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini"},on:{click:function(e){t.dialogVisible2=!1}}},[t._v("取 消")]),t._v(" "),a("saxo-button",{attrs:{mini:"",type:"primary"},on:{click:function(e){return t.ModifyMemo()}}},[t._v("确 认")])],1)],1),t._v(" "),a("SaxoDrawer",{attrs:{show:t.SaxoDrawerBool,title:"查看库位"},on:{ShowFalse:function(e){t.SaxoDrawerBool=!1}}},[a("StorageLocations")],1)],1)},staticRenderFns:[]};var _=a("VU/8")(m,f,!1,function(t){a("778V")},"data-v-03492acc",null);e.default=_.exports},"778V":function(t,e){},LAlr:function(t,e){}});