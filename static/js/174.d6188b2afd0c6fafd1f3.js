webpackJsonp([174],{"6Aky":function(t,e){},"IjF+":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=o("pFYg"),l=o.n(a),n=o("gSQJ"),i=o("t4zo"),s=o.n(i),r=o("uXZL"),c=o.n(r),u={data:function(){return{checked:!1,EngineerList:[],tableData:[],IDShow:"",drawer:!1,RightViewData:{},chooseQ:!1,dialogVisible:!1,year:""}},components:{jdSelect:n.a},computed:{},watch:{},methods:{chooseQX:function(t){t||(this.tableData=[]);for(var e=0;e<this.EngineerList.length;e++){this.EngineerList[e].show=t}this.chooseQ=t;for(var o=0;o<this.EngineerList.length;o++){var a=this.EngineerList[o];a.show&&this.EngineerSOQuarterBonus(a)}},handleClick:function(t){console.log(t),this.drawer=!0,this.RightViewData=t},handleClose:function(t){this.$confirm("确认关闭？").then(function(e){t()}).catch(function(t){})},GetEmployeeMini:function(){var t=this,e={api:"get",url:this.$store.state.http+"System/GetEmployeeMini",data:{type:9}};this.$https(e).then(function(e){console.log(e.Data),t.EngineerList=e.Data;for(var o=0;o<t.EngineerList.length;o++){var a=t.EngineerList[o];t.$set(a,"show",!1)}})},choose:function(t){this.EngineerList[t].show=!0},AtTime:function(t){for(var e=[],o=0;o<this.EngineerList.length;o++){var a=this.EngineerList[o];a.show&&e.push(a)}console.log(e),this.check(e)},check:function(t){var e=this;if(0==this.tableData.length)this.EngineerSOQuarterBonus(t[0]),console.log("第一种情况 初始表格没数据");else if(0==t.length)console.log("格已有数据  但传来了空集合"),this.tableData=[];else{console.log("格已有数据  传来了数据");for(var o=0;o<t.length;o++){var a=t[o];-1==this.IDShow.indexOf(a.EmployeeId)?(this.EngineerSOQuarterBonus(a),console.log("添加"+a.ChineseName)):console.log("已有"+a.ChineseName)}for(var n=function(o){var a=e.tableData[o];if(s=!0,t.forEach(function(t){t.UserName==a.UserName&&(console.log("没有删除"),s=!1)}),s){e.tableData.splice(o,1),e.IDShow="";for(var l=0;l<t.length;l++)e.IDShow+=String(t[l].EmployeeId)+"-";return console.log(e.IDShow),{v:!1}}},i=0;i<this.tableData.length;i++){var s,r=n(i);if("object"===(void 0===r?"undefined":l()(r)))return r.v}}this.IDShow="";for(var c=0;c<t.length;c++)this.IDShow+=String(t[c].EmployeeId)+"-";console.log(this.IDShow)},EngineerSOQuarterBonus:function(t){var e=this,o={api:"get",url:this.$store.state.http+"Finance/BMWMCYearBonus",data:{username:t.UserName,year:this.year}};this.$https(o).then(function(o){var a=o.Data;if(a.otherMCSales=t.otherMCSales,a.OtherSOSales=t.OtherSOSales,a.UserName=t.UserName,a.AsSales=a.Bonus.AsSales,a.SoSales=a.Bonus.SoSales,a.Area=a.EmployeeInfo.Area,a.Proportion=a.Bonus.Proportion,a.BonusAmount=a.Bonus.BonusAmount,a.BeforeSoSales=a.Bonus.BeforeSoSales,a.ChineseName=a.EmployeeInfo.ChineseName,a.PersonalSoSales=a.Bonus.PersonalSoSales,console.log(a),e.tableData.push(o.Data),console.log(e.tableData),0!=e.tableData.length){var l={};e.tableData=e.tableData.reduce(function(t,e){return!l[e.UserName]&&(l[e.UserName]=t.push(e)),t},[])}})},exportExcelTo:function(t){var e=c.a.utils.table_to_book(document.querySelector(t),{raw:!0}),o=c.a.write(e,{bookType:"xlsx",bookSST:!0,type:"array"});try{s.a.saveAs(new Blob([o],{type:"application/octet-stream"}),"未命名.xlsx")}catch(t){"undefined"!=typeof console&&console.log(t,o)}return o}},created:function(){this.GetEmployeeMini();var t=new Date;this.year=String(t.getFullYear())},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},h={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"box_s"},[o("div",{staticClass:"Left"},[o("el-date-picker",{staticStyle:{width:"100%",marginBottom:"20px"},attrs:{type:"year",size:"mini",placeholder:"选择年","value-format":"yyyy"},model:{value:t.year,callback:function(e){t.year=e},expression:"year"}}),t._v(" "),o("el-checkbox",{on:{change:t.chooseQX},model:{value:t.chooseQ,callback:function(e){t.chooseQ=e},expression:"chooseQ"}},[o("span",{staticStyle:{color:"#409EFF","font-weight":"bold"}},[t._v("全选")])]),t._v(" "),t._l(t.EngineerList,function(e,a){return o("el-checkbox",{key:a,on:{click:function(e){return t.choose(a)},change:t.AtTime},model:{value:e.show,callback:function(o){t.$set(e,"show",o)},expression:"item.show"}},[o("div",{staticStyle:{width:"80px",float:"left"}},[t._v(t._s(e.Area)+" ")]),t._v("\n      "+t._s(e.Name)+"\n    ")])})],2),t._v(" "),o("div",{staticClass:"Right"},[o("el-button",{staticStyle:{float:"right"},attrs:{type:"info",size:"mini"},on:{click:function(e){return t.exportExcelTo("#out-table")}}},[t._v("打 印")]),t._v(" "),o("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,size:"mini",id:"out-table","default-sort":{prop:"Area",order:"descending"}}},[o("el-table-column",{attrs:{label:"",width:"70px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.$index+1)+"\n        ")]}}])}),t._v(" "),o("el-table-column",{attrs:{sortable:"",prop:"ChineseName",label:"姓名",width:"180"}}),t._v(" "),o("el-table-column",{attrs:{sortable:"",prop:"Area",label:"区域",width:"180"}}),t._v(" "),o("el-table-column",{attrs:{sortable:"",prop:"PersonalSoSales",label:"宝马保养销售额",width:"180"}}),t._v(" "),o("el-table-column",{attrs:{sortable:"",prop:"otherMCSales",label:"自由市场保养销售额",width:"180"}}),t._v(" "),o("el-table-column",{attrs:{sortable:"",prop:"BonusAmount",label:"最终奖金"}}),t._v(" "),o("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(o){return t.handleClick(e.row)}}},[t._v("明细")])]}}])})],1)],1),t._v(" "),o("el-drawer",{attrs:{visible:t.drawer,"with-header":!1,"modal-append-to-body":!1,size:"50%"},on:{"update:visible":function(e){t.drawer=e}}},[o("div",{staticClass:"rightView"},[o("h2",[t._v(t._s(t.RightViewData.ChineseName)+" "),o("span",{staticStyle:{fontSize:"12px"}},[t._v(t._s(t.RightViewData.Area))])]),t._v(" "),o("br"),t._v(" "),o("p",[t._v("宝马保养销售额 "+t._s(t.RightViewData.PersonalSoSales))]),t._v(" "),o("el-button",{staticStyle:{float:"right"},attrs:{type:"info",size:"mini"},on:{click:function(e){return t.exportExcelTo("#out-table2")}}},[t._v("打 印")]),t._v(" "),o("el-table",{staticStyle:{width:"100%"},attrs:{data:t.RightViewData.PersonalSOSalesDtos,size:"mini",id:"out-table2"}},[o("el-table-column",{attrs:{prop:"CusFullName",label:"客户","show-overflow-tooltip":!0}}),t._v(" "),o("el-table-column",{attrs:{prop:"ContractCode",label:"报价单号",width:"200"}}),t._v(" "),o("el-table-column",{attrs:{prop:"DiscountAmount",label:"优惠总金额",width:"100"}}),t._v(" "),o("el-table-column",{attrs:{prop:"ReturnedPurchaseAmount",label:"退货金额",width:"100"}}),t._v(" "),o("el-table-column",{attrs:{prop:"RebateAmount",label:"返点金额",width:"100"}}),t._v(" "),o("el-table-column",{attrs:{prop:"Sales",label:"销售",width:"100"}})],1),o("br"),t._v(" "),o("p",[t._v("自由市场保养销售额 "+t._s(t.RightViewData.OtherSOSales))]),t._v(" "),o("el-button",{staticStyle:{float:"right"},attrs:{type:"info",size:"mini"},on:{click:function(e){return t.exportExcelTo("#out-table4")}}},[t._v("打 印")]),t._v(" "),o("el-table",{staticStyle:{width:"100%"},attrs:{data:t.RightViewData.OtherSOSalesDtos,size:"mini",id:"out-table4"}},[o("el-table-column",{attrs:{prop:"CusFullName",label:"客户","show-overflow-tooltip":!0}}),t._v(" "),o("el-table-column",{attrs:{prop:"ContractCode",label:"报价单号",width:"200"}}),t._v(" "),o("el-table-column",{attrs:{prop:"DiscountAmount",label:"优惠总金额",width:"80"}}),t._v(" "),o("el-table-column",{attrs:{prop:"ReturnedPurchaseAmount",label:"退货金额",width:"80"}}),t._v(" "),o("el-table-column",{attrs:{prop:"RebateAmount",label:"返点金额",width:"80"}}),t._v(" "),o("el-table-column",{attrs:{prop:"Area",label:"区域",width:"80"}}),t._v(" "),o("el-table-column",{attrs:{prop:"Proportion",label:"比例",width:"80"}}),t._v(" "),o("el-table-column",{attrs:{label:"占比",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n            "+t._s(parseInt(100/e.row.OtherInt)+"%")+"\n          ")]}}])}),t._v(" "),o("el-table-column",{attrs:{prop:"Sales",label:"销售",width:"100"}})],1),o("br"),t._v(" "),o("p",[t._v("奖金比例配置 ")]),t._v(" "),o("el-button",{staticStyle:{float:"right"},attrs:{type:"info",size:"mini"},on:{click:function(e){return t.exportExcelTo("#out-table6")}}},[t._v("打 印")]),t._v(" "),o("el-table",{staticStyle:{width:"100%"},attrs:{data:t.RightViewData.BonusConfigDtos,size:"mini",id:"out-table6"}},[o("el-table-column",{attrs:{label:"到达档位"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.Selectd?o("i",{staticClass:"el-icon-check",staticStyle:{color:"#67C23A",fontWeight:"bold"}}):t._e()]}}])}),t._v(" "),o("el-table-column",{attrs:{prop:"Proportion",label:"比例"}}),t._v(" "),o("el-table-column",{attrs:{prop:"Price",label:"金额"}}),t._v(" "),o("el-table-column",{attrs:{prop:"BonusDate",label:"年份"}}),t._v(" "),o("el-table-column",{attrs:{prop:"ConfigType",label:"名称"}})],1),o("br")],1)])],1)},staticRenderFns:[]};var p=o("VU/8")(u,h,!1,function(t){o("6Aky")},"data-v-17cb0aba",null);e.default=p.exports}});