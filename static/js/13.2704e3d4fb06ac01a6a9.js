webpackJsonp([13],{mSZ1:function(t,e){},z6aA:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l={data:function(){return{Data:{},Other:"",MCSupplieStatDtos:[],gridData:[],MCEquSupplieData:[],DetailDtos:[],GoosDtos:{},LInKman:{}}},created:function(){this.Id=this.$route.query.Id,this.start()},mounted:function(){},methods:{start:function(){var t=this;this.API_GET("Maintain/GetMSSO",{Id:this.Id}).then(function(e){console.log(e),t.Data=e.Dto,t.LInKman=e.Dto.LinkMan;for(var a=0;a<t.Data.GoosDtos.length;a++){var l=t.Data.GoosDtos[a];if(t.$set(l,"radio",""),l.SentDate2=t.formatDate(l.SentDate),""!=l.SentDate&&null!=l.SentDate){console.log(t.GoosDtos);var o=l.SentDate.split("T")[0],n=!0;for(var s in t.GoosDtos)s=="F"+o&&(t.GoosDtos[s].push(l),n=!1);n&&(t.GoosDtos["F"+o]=[l])}}console.log(t.GoosDtos),t.GetMCSupplieStat(t.Data.ContractId),t.GetMCEquSupplie(t.Data.ContractId)})},cellStyle:function(t){if(t.row.OrderCode==this.Data.OrderCode)return"color:red;"},GetMCSupplieStat:function(t){var e=this;this.API_GET("Maintain/GetMCSupplieStat",{Id:t}).then(function(t){console.log(t.MCSupplieStatDtos),e.MCSupplieStatDtos=t.MCSupplieStatDtos})},GetMCEquSupplie:function(t){var e=this;this.API_GET("Maintain/GetMCEquSupplie",{Id:t}).then(function(t){console.log(t),e.MCEquSupplieData=t.Dtos,e.DetailDtos=t.DetailDtos})},look:function(t){var e=this;this.gridData=[],this.API_GET("Maintain/GetMSSO",{Id:t.MSSOId}).then(function(t){console.log(t.Dto),e.gridData=t.Dto.GoosDtos})},deliverGoods:function(){var t=this,e=[];console.log(this.Data.GoosDtos);for(var a=0;a<this.Data.GoosDtos.length;a++){var l=this.Data.GoosDtos[a];""!=l.radio&&e.push({id:l.Id,Other:l.radio.split(",")[0]})}if(0==e.length)return this.$message.warning("请选择发货库位"),!1;var o={ID:this.Id,Other:this.Other,Euqs:e};this.API_POST("Maintain/SendMSSO",o).then(function(e){t.$message.success("发货成功！"),t.start()})},closeOrder:function(){var t=this;this.API_POST("Maintain/CloseMSSO",{Id:this.Id}).then(function(e){t.$message.success("结单成功！"),t.$router.push({path:"/MaintenanceTasks"}),t.$emit("refresh")})},DownloadShippingList:function(t,e){console.log(t);for(var a=this.Data.CusFullName+"_"+this.Data.ContractCode+"_发货单_"+(Number(e)+1),l="height:40px;line-height:40px;font-size:20px;font-weight: bold;",o="height:40px;line-height:40px;font-size:20px;text-align: left;",n="text-align: left;font-size:18px;",s="text-align: center;font-size:18px;",i=new Date,r="",c=0;c<t.length;c++){var d=t[c];r+="<tr>\n                    <td style='"+s+"'>"+Number(c+1)+"</td>\n                    <td style='"+n+"'>"+d.ProductCode+"</td>\n                    <td style='"+n+"'>"+d.ProDesc+"</td>\n                    <td style='"+n+"'>"+d.SendKuwei+"</td>\n                    <td style='"+s+"'>"+d.Quantity+"</td>\n                </tr>\n                "}var p='\n\n            <html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">\n                <head>\n                <meta charset="utf-8">\n                </head>\n                <body>\n                <table border=1 style="font-family: "宋体";padding:10px">\n\n                    <tr>\n                       <th colspan=\'5\' style=\'font-size:40px;line-height:100px;height:100px;color:rgb(20,25,244)'+"'>北京英之杰天祥发货单</th>\n                    </tr>\n\n                    <tr>\n                       <td colspan='2' style='"+l+"'>客户名称</td>\n                       <td colspan='3' style='"+o+"'>"+this.Data.CusFullName+"</td>\n                    </tr>\n                    <tr>\n                       <td colspan='2' style='"+l+"'>订单编号</td>\n                       <td colspan='3' style='"+o+"'>"+this.Data.ContractCode+"</td>\n                    </tr>\n                    <tr>\n                       <td colspan='2' style='"+l+"'>联系人</td>\n                       <td colspan='3' style='"+o+"'>"+this.LInKman.ChineseName+"</td>\n                    </tr>\n                    <tr>\n                       <td colspan='2' style='"+l+"'>手 机</td>\n                       <td colspan='3' style='"+o+"'>"+this.LInKman.MobilePhone+"</td>\n                    </tr>\n                    <tr>\n                       <td colspan='2' style='"+l+"'>地 址</td>\n                       <td colspan='3' style='"+o+"'>"+this.LInKman.Address+"</td>\n                    </tr>\n                    <tr>\n                       <td colspan='2' style='"+l+"'>当前日期</td>\n                       <td colspan='3' style='"+o+"'>"+i.getFullYear()+"/"+(i.getMonth()+1)+"/"+i.getDate()+" "+i.getHours()+" : "+i.getMinutes()+" </td>\n                    </tr>\n\n                    <tr style='height:60px;line-height:60px;font-size:25px;margin:0 20px'>\n                       <th>序号</th>\n                       <th>产品编码</th>\n                       <th>描述</th>\n                       <th>库位</th>\n                       <th>发货数量</th>\n                    </tr>\n                    "+r+"\n                </table>\n                </body>\n                </html>",u=document.createElement("a");u.download=a+".xls",u.href="data:application/vnd.ms-excel;base64,"+window.btoa(unescape(encodeURIComponent(p))),document.body.appendChild(u),u.click(),document.body.removeChild(u)}},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("SaxoPage",{scopedSlots:t._u([{key:"title",fn:function(){return[4==t.Data.MSSOState?a("saxo-button",{attrs:{mini:"",type:"danger"},on:{click:function(e){return t.closeOrder()}}},[t._v("结束订单")]):t._e()]},proxy:!0},{key:"content",fn:function(){return[a("h3",[t._v("保养所需耗材")]),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.MCEquSupplieData,size:"mini"}},[a("el-table-column",{attrs:{label:"产品编码 ",prop:"ProdcutCode",width:"200"}}),t._v(" "),a("el-table-column",{attrs:{label:"长编码",prop:"LongCode",width:"200"}}),t._v(" "),a("el-table-column",{attrs:{label:"描述",prop:"Desc"}}),t._v(" "),a("el-table-column",{attrs:{label:"数量",prop:"Numner",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{label:"单位",prop:"Unit",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{label:"合计",prop:"Total",width:"100"}})],1),t._v(" "),a("div",{staticStyle:{width:"95%","margin-left":"5%"}},[a("el-collapse",[a("el-collapse-item",{attrs:{title:"保养设备内容 点击查看"}},[a("el-table",{attrs:{data:t.DetailDtos}},[a("el-table-column",{attrs:{prop:"ProType",label:"名称",width:"300","show-overflow-tooltip":!0}}),t._v(" "),a("el-table-column",{attrs:{prop:"ProductCode",label:"编号",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"ProductDesc",label:"描述","show-overflow-tooltip":!0}}),t._v(" "),a("el-table-column",{attrs:{prop:"Numner",label:"数量",width:"100"}})],1)],1)],1)],1),t._v(" "),a("h3",[t._v("保养记录")]),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.MCSupplieStatDtos,size:"mini","cell-style":t.cellStyle}},[a("el-table-column",{attrs:{label:"任务编号",prop:"OrderCode",width:"140"}}),t._v(" "),a("el-table-column",{attrs:{label:"状态",prop:"StateStr",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{label:"预计日期",prop:"EstimatedTime"}}),t._v(" "),a("el-table-column",{attrs:{label:"开始日期",prop:"ActualTime"}}),t._v(" "),a("el-table-column",{attrs:{label:"完成日期",prop:"EndTime"}}),t._v(" "),a("el-table-column",{attrs:{label:"耗材状态",prop:"MSSOStateStr"}}),t._v(" "),a("el-table-column",{attrs:{label:"发货日期",prop:"SentDate"}}),t._v(" "),a("el-table-column",{attrs:{label:"查看"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-popover",{attrs:{placement:"left",trigger:"click"}},[a("el-table",{attrs:{data:t.gridData}},[a("el-table-column",{attrs:{prop:"ProDesc",label:" 产品描述",width:"500","show-overflow-tooltip":!0}}),t._v(" "),a("el-table-column",{attrs:{prop:"Brand",label:"品牌",width:"100","show-overflow-tooltip":!0}}),t._v(" "),a("el-table-column",{attrs:{prop:"Quantity",label:"数量",width:"60"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Delivered",label:"已发货",width:"100"}})],1),t._v(" "),null!=e.row.MSSOId?a("el-link",{attrs:{slot:"reference",type:"primary",underline:!1},on:{click:function(a){return t.look(e.row)}},slot:"reference"},[t._v("查看")]):t._e()],1)]}}])})],1),t._v(" "),a("h3",[t._v("基础信息")]),t._v(" "),a("el-descriptions",{staticClass:"margin-top",attrs:{column:3,size:"mini",border:""}},[a("el-descriptions-item",[a("template",{slot:"label"},[t._v(" 客户名称 ")]),t._v("\n                "+t._s(" "+t.Data.CusFullName)+"\n            ")],2),t._v(" "),a("el-descriptions-item",[a("template",{slot:"label"},[t._v(" 合同号 ")]),t._v("\n                "+t._s(" "+t.Data.ContractCode)+"\n            ")],2),t._v(" "),a("el-descriptions-item",[a("template",{slot:"label"},[t._v(" 状态 ")]),t._v("\n                "+t._s(" "+t.Data.MSSOStateStr)+"\n            ")],2),t._v(" "),a("el-descriptions-item",[a("template",{slot:"label"},[t._v(" 地区 ")]),t._v("\n                "+t._s(" "+t.Data.Area)+"\n            ")],2),t._v(" "),a("el-descriptions-item",[a("template",{slot:"label"},[t._v(" 单号 ")]),t._v("\n                "+t._s(" "+t.Data.OrderCode)+"\n            ")],2),t._v(" "),a("el-descriptions-item",[a("template",{slot:"label"},[t._v(" 申请时间 ")]),t._v("\n                "+t._s(" "+t.formatDate(t.Data.CreateDate))+"\n            ")],2),t._v(" "),a("el-descriptions-item",[a("template",{slot:"label"},[t._v(" 申请人 ")]),t._v("\n                "+t._s(" "+t.Data.Creater)+"\n            ")],2),t._v(" "),a("el-descriptions-item",[a("template",{slot:"label"},[t._v(" 发货日期 ")]),t._v("\n                "+t._s(" "+t.formatDate(t.Data.SentDate))+"\n            ")],2)],1),t._v(" "),a("h3",[t._v("联系人")]),t._v(" "),a("p",{staticClass:"from"},[a("span",{staticClass:"Name2"},[t._v("姓名")]),t._v(" "),a("span",[t._v(t._s(t.LInKman.ChineseName||" - - "))])]),t._v(" "),a("p",{staticClass:"from"},[a("span",{staticClass:"Name2"},[t._v("手机")]),t._v(" "),a("span",[t._v(t._s(t.LInKman.MobilePhone||" - - "))])]),t._v(" "),a("p",{staticClass:"from"},[a("span",{staticClass:"Name2"},[t._v("邮箱")]),t._v(" "),a("span",[t._v(t._s(t.LInKman.EMail||" - - "))])]),t._v(" "),a("p",{staticClass:"from"},[a("span",{staticClass:"Name2"},[t._v("地址")]),t._v(" "),a("span",[t._v(t._s(t.LInKman.Address||" - - "))])]),t._v(" "),a("h3",[t._v("备注")]),t._v(" "),a("el-input",{staticStyle:{width:"500px"},attrs:{type:"textarea",placeholder:"请输入备注","show-word-limit":"",autosize:{minRows:4,maxRows:4}},model:{value:t.Other,callback:function(e){t.Other=e},expression:"Other"}}),t._v(" "),a("h3",[t._v("\n            耗材发货清单\n\n            "),a("saxo-button",{attrs:{mini:""},on:{click:t.deliverGoods}},[t._v("发货")]),t._v(" "),t._l(t.GoosDtos,function(e,l,o){return a("span",{key:o,staticClass:"FHD",on:{click:function(a){return t.DownloadShippingList(e,o)}}},[t._v(t._s(l.split("F")[1])+" "),a("i",{staticClass:"el-icon-download"})])})],2),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.Data.GoosDtos,"header-cell-style":t.$store.state.headerCellStyle,"cell-style":t.$store.state.cellStyle,stripe:""}},[a("el-table-column",{attrs:{prop:"ProDesc",label:" 产品描述","show-overflow-tooltip":!0}}),t._v(" "),a("el-table-column",{attrs:{prop:"Brand",label:"品牌",width:"130","show-overflow-tooltip":!0}}),t._v(" "),a("el-table-column",{attrs:{prop:"Quantity",label:"数量",width:"60"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Delivered",label:"已发货",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"SentDate2",label:"发货日期",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-radio-group",{attrs:{disabled:Boolean(e.row.SentDate)},model:{value:e.row.radio,callback:function(a){t.$set(e.row,"radio",a)},expression:"scope.row.radio"}},t._l(null!=e.row.Locations?e.row.Locations.split(";"):[],function(e,l){return a("el-radio",{key:l,attrs:{label:e}},[t._v(t._s(e)+" ")])}),1)]}}])})],1)]},proxy:!0}])})},staticRenderFns:[]};var n=a("VU/8")(l,o,!1,function(t){a("mSZ1")},"data-v-0b232294",null);e.default=n.exports}});