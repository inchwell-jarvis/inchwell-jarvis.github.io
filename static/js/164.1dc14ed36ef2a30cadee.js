webpackJsonp([164],{ESGQ:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i={data:function(){return{UData:{},mdata:[],active:0,data:{}}},created:function(){this.UData=this.$route.query.row,this.start(),console.log("汉字".length)},mounted:function(){},computed:{},watch:{},methods:{start:function(){var t=this,a=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.API_GET("Finance/GetPOPayMerge",{Id:this.UData.MergeId}).then(function(e){console.log(e),t.data=e,null==e.AuditorA?t.active=0:null==e.AuditorB?t.active=1:null==e.AuditorC?t.active=2:null==e.AuditorD?t.active=3:null!=e.AuditorD&&(t.active=4),"已驳回"==e.PayStateStr&&(t.active-=1),a&&e.PayIds.forEach(function(a){t.mdata=[],t.GetFinanceMPOPays(a)})})},GetFinanceMPOPays:function(t){var a=this,e={id:t,search:"",buyer:"",paystate:-1,invoicestate:-1,auditstate:-1,pageNum:1,numPerPage:30,memo:"",orderField:"",orderDirection:""};this.API_GET("MachineSO/GetFinanceMPOPays",e).then(function(t){console.log(t),a.mdata.push({Files:t.MachinePOFiles,Data:t.MachinePOPayDtos[0]}),console.log(a.mdata),console.log(a.active)})},MPOPayAudit:function(t){var a=this,e="";0==this.active&&(e="POPayMergeAuditA"),1==this.active&&(e="POPayMergeAuditB"),2==this.active&&(e="POPayMergeAuditC");var i={ID:this.UData.MergeId,Str:t};this.API_POST("Finance/"+e,i,!1).then(function(t){a.$message.success("操作成功！"),a.start(!1)})},RevokePOPayMerge:function(){var t=this;this.API_POST("Finance/RevokePOPayMerge",{id:this.UData.MergeId}).then(function(a){t.$message.success("操作成功！"),t.$router.push({path:"/purchasec-ollection"})})}},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},destroyed:function(){},activated:function(){},beforeDestroy:function(){this.$emit("refresh")}},n={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("SaxoPage",{scopedSlots:t._u([{key:"title",fn:function(){return[0==t.active&&"已驳回"!=t.data.PayStateStr?e("saxo-button",{attrs:{type:"danger",mini:""},on:{click:function(a){return t.RevokePOPayMerge()}}},[t._v("撤回合并付款")]):t._e()]},proxy:!0},{key:"content",fn:function(){return[e("div",{staticClass:"header"},[e("h3",[t._v(t._s(t.UData.CusFullName))]),t._v(" "),e("p",{staticClass:"lumpSum"},[t._v("总金额 "),e("span",[t._v(t._s(t.FinancialAmountFormat(t.data.PayAmount,t.FinancialAmountSymbol(t.data.BuyingCurrency))))])]),t._v(" "),e("el-steps",{attrs:{active:t.active,"align-center":""}},[e("el-step",{attrs:{title:"财务 付款"}},[e("template",{slot:"description"},[e("div",{staticClass:"downloadList"},["已驳回"!=t.data.PayStateStr?e("span",[t._v(t._s(t.data.AuditorA))]):t._e(),t._v(" "),"已驳回"==t.data.PayStateStr&&0==t.active?e("span",{staticStyle:{color:"red"}},[t._v(t._s("已驳回:"+t.data.AuditorA))]):t._e(),t._v(" "),0==t.active&&"已驳回"!=t.data.PayStateStr?e("saxo-button",{attrs:{mini:"",type:"danger"},on:{click:function(a){return t.MPOPayAudit(0)}}},[t._v("驳回")]):t._e(),t._v(" "),0==t.active&&"已驳回"!=t.data.PayStateStr?e("saxo-button",{attrs:{mini:"",type:"primary"},on:{click:function(a){return t.MPOPayAudit(1)}}},[t._v("同意")]):t._e()],1)])],2),t._v(" "),e("el-step",{attrs:{title:"财务经理 审核付款"}},[e("template",{slot:"description"},[e("div",{staticClass:"downloadList"},["已驳回"!=t.data.PayStateStr?e("span",[t._v(t._s(t.data.AuditorB))]):t._e(),t._v(" "),"已驳回"==t.data.PayStateStr&&1==t.active?e("span",{staticStyle:{color:"red"}},[t._v(t._s("已驳回:"+t.data.AuditorB))]):t._e(),t._v(" "),1==t.active&&"已驳回"!=t.data.PayStateStr?e("saxo-button",{attrs:{mini:"",type:"danger"},on:{click:function(a){return t.MPOPayAudit(0)}}},[t._v("驳回")]):t._e(),t._v(" "),1==t.active&&"已驳回"!=t.data.PayStateStr?e("saxo-button",{attrs:{mini:"",type:"primary"},on:{click:function(a){return t.MPOPayAudit(1)}}},[t._v("同意")]):t._e()],1)])],2),t._v(" "),e("el-step",{attrs:{title:"总经理 批准付款"}},[e("template",{slot:"description"},[e("div",{staticClass:"downloadList"},["已驳回"!=t.data.PayStateStr?e("span",[t._v(t._s(t.data.AuditorC))]):t._e(),t._v(" "),"已驳回"==t.data.PayStateStr&&2==t.active?e("span",{staticStyle:{color:"red"}},[t._v(t._s("已驳回:"+t.data.AuditorC))]):t._e(),t._v(" "),2==t.active&&"已驳回"!=t.data.PayStateStr?e("saxo-button",{attrs:{mini:"",type:"danger"},on:{click:function(a){return t.MPOPayAudit(0)}}},[t._v("驳回")]):t._e(),t._v(" "),2==t.active&&"已驳回"!=t.data.PayStateStr?e("saxo-button",{attrs:{mini:"",type:"primary"},on:{click:function(a){return t.MPOPayAudit(1)}}},[t._v("同意")]):t._e()],1)])],2)],1)],1),t._v(" "),e("div",{staticClass:"collectionOfContracts"},[e("div",{staticClass:"collectionOfContracts_header"},[e("h3",[t._v("合并付款申请 （"+t._s(t.mdata.length)+"）")])]),t._v(" "),e("div",{staticClass:"collectionOfContracts_content"},t._l(t.mdata,function(a,i){return e("div",{key:i,staticClass:"content_li"},[e("h3",[t._v(t._s(a.Data.POCode))]),t._v(" "),e("el-descriptions",{attrs:{column:1,colon:!1,labelStyle:{width:"130px"},contentStyle:{width:"270px"}}},[e("el-descriptions-item",{attrs:{label:"申请人"}},[t._v(t._s(a.Data.Creater))]),t._v(" "),e("el-descriptions-item",{attrs:{label:"创建时间"}},[t._v(t._s(a.Data.CreateDate.split("T")[0]))]),t._v(" "),e("el-descriptions-item",{attrs:{label:"金额"}},[e("span",{staticStyle:{color:"red"}},[t._v(t._s(t.FinancialAmountFormat(a.Data.Amount,t.FinancialAmountSymbol(a.Data.BuyingCurrency)))+"\n                                ("+t._s((a.Data.Amount/a.Data.ContractAmount*100).toFixed(2)+"%")+" No."+t._s(a.Data.Number)+")")])]),t._v(" "),e("el-descriptions-item",{attrs:{label:"备注"}},[e("el-popover",{attrs:{placement:"top-start",title:"备注",width:"400",trigger:"hover",content:a.Data.Memo}},[e("div",{staticClass:"meno",attrs:{slot:"reference"},slot:"reference"},[t._v(t._s(a.Data.Memo))])])],1)],1),t._v(" "),e("uploadFile",{attrs:{FileData:a.Files,ShowUpload:!1}})],1)}),0)])]},proxy:!0}])})},staticRenderFns:[]};var o=e("VU/8")(i,n,!1,function(t){e("uDUe")},"data-v-21ab9861",null);a.default=o.exports},uDUe:function(t,a){}});