webpackJsonp([89],{NuzR:function(t,e){},cCZY:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r={data:function(){return{options:[{value:"6",label:"半年"},{value:"12",label:"一年"},{value:"18",label:"一年半"},{value:"24",label:"两年"}],optionss:[],Product:{Recovery:!1,ProductCode:"",ProductionYear:"",GuaranteePeriodMonths:"",Characteristics:"",MaintainContent:"",KitFlag:!1,MinInventoryAlert:"",MaxInventoryAlert:"",OptimalInventory:"",Unit:"",UnitPrice:"",AssemblyUnitPriceTime:"",AssemblyUnitPrice:"",BuyingUnitPrice:"",BuyingCurrency:"RMB",Barcode:"",BarcodeMemo:"",RepairCharge:"",ReapirChargeEUR:"",MaintainPrice:"",MaintainHours:"",BMBSJ:"35",Manufacturer:""},state1:"",restaurants:[],dialogVisibleMainGraph:!1,imageUrlList:[],imageUrl:{type:"",url:""},uploadFileUrlapp:"https://httpbin.org/post",imgVideoBase64List:[],UpFileDataLength:0,UpImgVideoId:"",loading:!1,IdStr:"",UpimgNumber:0}},mounted:function(){this.Manufacturer(),console.log(this.$route.query.Id),this.IdStr=this.$route.query.Id,this.start()},methods:{deleteImg:function(t){var e=this,i={api:"post",url:this.$store.state.http+"Product/DelProductPhoto",data:{Id:t}};this.$https(i).then(function(t){console.log(t),e.$message.success("图片删除成功！"),e.start()})},beforeuploadMainGraph:function(t){var e=(t.size/1024/1024).toFixed(3);if(console.log(e+"MB"),console.log(t),e>10&&"video/mp4"==t.type)return this.$message.warning("视频文件大小不得超过10MB"),!1;var i=this,r=new FileReader;r.readAsDataURL(t),r.onload=function(e){var a=r.result;i.imgVideoBase64List.push({uid:t.uid,base64:a}),console.log(i.imgVideoBase64List)}},handleSuccessMainGraph:function(t,e,i){console.log("0000000"),this.imageUrlList=i},handlePreviewMainGraph:function(t){this.imageUrl.type=t.raw.type,this.imageUrl.url=t.url,console.log(t),this.$refs.primary.start()},beforeremoveMainGraph:function(t,e){},handleRemoveMainGraph:function(t,e){console.log(t.uid);for(var i=0;i<this.imgVideoBase64List.length;i++){this.imgVideoBase64List[i].uid===t.uid&&this.imgVideoBase64List.splice(i,1)}console.log(this.imgVideoBase64List)},UpImg:function(){if(0==this.imgVideoBase64List.length)return this.$message.warning("请选择图片！"),!1;this.UpimgNumber=this.imgVideoBase64List.length;for(var t=0;t<this.imgVideoBase64List.length;t++){var e=this.imgVideoBase64List[t];this.dealImage(e.base64)}},dealImage:function(t){var e,i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e5,a=(document.getElementById("uploadimg"),new Image),o=.6;a.src=t,a.setAttribute("crossOrigin","Anonymous");var s=this;a.onload=function(){e=this.width,i=this.height;var t=document.createElement("canvas"),a=t.getContext("2d");Math.max(e,i)>r?e>i?(t.width=r,t.height=r*i/e):(t.height=r,t.width=r*e/i):(t.width=e,t.height=i,o=.6),a.clearRect(0,0,t.width,t.height),a.drawImage(this,0,0,t.width,t.height);var n=t.toDataURL("image/jpeg",o);n="data:image/jpeg;base64,"+(n=n.split(",")[1]),console.log(n),console.log(n.length),s.UploadProductPhoto(n)}},UploadProductPhoto:function(t){var e=this,i={api:"post",url:this.$store.state.http+"Product/UploadProductPhoto",data:{Id:this.IdStr,FileStr:t,Type:1}};this.$https(i).then(function(t){console.log(t),e.UpimgNumber-=1,0==e.UpimgNumber&&(console.log("上传完成！"),e.imgVideoBase64List=[],e.imageUrlList=[],e.start())})},start:function(){var t=this,e={api:"get",url:this.$store.state.http+"Product/GetProduct",data:{Id:this.IdStr}};this.$https(e).then(function(e){console.log(e.Data),t.Product=e.Data,t.Product.ManufacturerAddress=e.Data.ManufacturerId,t.Product.BMBSJ="35",""==t.Product.AssemblyUnitPrice&&(t.Product.AssemblyUnitPrice=0)})},Manufacturer:function(){var t=this,e={api:"get",url:this.$store.state.http+"Product/GetManufacturer"};this.$https(e).then(function(e){t.optionss=e.Data,t.restaurants=[];for(var i=0;i<e.Data.length;i++)t.restaurants.push({value:e.Data[i].Name,address:e.Data[i].ID})})},querySearch:function(t,e){var i=this.restaurants;e(t?i.filter(this.createFilter(t)):i)},createFilter:function(t){return function(e){return 0===e.value.toLowerCase().indexOf(t.toLowerCase())}},BuyingUnitPrice:function(){console.log(9*this.Product.ReapirChargeEUR*1.06),this.Product.RepairCharge=(9*this.Product.ReapirChargeEUR*1.06).toFixed(2)},AssemblyUnitPriceTimeMN:function(t){this.Product.AssemblyUnitPrice=(14*this.Product.AssemblyUnitPriceTime*1.17).toFixed(2)},MaintainPrice:function(){this.Product.MaintainPrice=(this.Product.MaintainHours*this.Product.BMBSJ).toFixed(2)},handleSelect:function(t){console.log(t.address),this.Product.ManufacturerAddress=t.address},GetUnitPriceByPO:function(){var t=this;if(this.Product.Manufacturer&&this.Product.BuyingCurrency&&this.Product.BuyingUnitPrice){var e={proType:1,brand:this.Product.Manufacturer,currency:this.Product.BuyingCurrency,bup:Number(this.Product.BuyingUnitPrice)};console.log(e),this.API_GET("Product/GetUnitPriceByPO",e).then(function(e){console.log(e.Value),t.Product.UnitPrice=e.Value})}},create:function(){var t=this;if(""==this.Product.ProductCode)return this.$message.warning("请输入产品编号！");if(""==this.Product.BarcodeMemo)return this.$message.warning("请输入内部编码！");if(""==this.Product.Manufacturer)return this.$message.warning("请输入品牌！");if(""==this.Product.BuyingUnitPrice)return this.$message.warning("请输入采购单价！");if(""==this.Product.Characteristics)return this.$message.warning("请输入产品描述！");var e={api:"post",url:this.$store.state.http+"Product/UpdateProduct",data:{ID:this.Product.ID,ProductCode:this.Product.ProductCode,ProductionYear:Number(this.Product.ProductionYear),GuaranteePeriodMonths:this.Product.GuaranteePeriodMonths,Characteristics:this.Product.Characteristics,MaintainContent:this.Product.MaintainContent,proType:1,KitFlag:!0,MinInventoryAlert:Number(this.Product.MinInventoryAlert),MaxInventoryAlert:Number(this.Product.MaxInventoryAlert),OptimalInventory:Number(this.Product.OptimalInventory),Unit:this.Product.Unit,UnitPrice:Number(this.Product.UnitPrice),AssemblyUnitPrice:Number(this.Product.AssemblyUnitPrice),BuyingUnitPrice:Number(this.Product.BuyingUnitPrice),BuyingCurrency:this.Product.BuyingCurrency,Barcode:this.Product.Barcode,BarcodeMemo:this.Product.BarcodeMemo,RepairCharge:Number(this.Product.RepairCharge),ReapirChargeEUR:Number(this.Product.ReapirChargeEUR),MaintainPrice:Number(this.Product.MaintainPrice),MaintainHours:Number(this.Product.MaintainHours),Manufacturer:this.Product.Manufacturer,Recovery:this.Product.Recovery}};this.$https(e).then(function(e){0==e.Code&&(t.$emit("refresh"),t.$router.push({path:"/Spareparts_page"}))})}}},a={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("SaxoPage",{scopedSlots:t._u([{key:"title",fn:function(){return[i("saxo-button",{attrs:{mini:""},on:{click:function(e){return t.create()}}},[t._v("保存")])]},proxy:!0},{key:"content",fn:function(){return[i("h3",[t._v("基础数据")]),t._v(" "),i("div",{staticClass:"demo"},[i("div",[t._v("产品编号:")]),t._v(" "),i("el-input",{attrs:{size:"mini"},model:{value:t.Product.ProductCode,callback:function(e){t.$set(t.Product,"ProductCode",e)},expression:"Product.ProductCode"}})],1),t._v(" "),i("div",{staticClass:"demo"},[i("div",[t._v("内部编码:")]),t._v(" "),i("el-input",{attrs:{size:"mini"},model:{value:t.Product.BarcodeMemo,callback:function(e){t.$set(t.Product,"BarcodeMemo",e)},expression:"Product.BarcodeMemo"}})],1),t._v(" "),i("div",{staticClass:"demo"},[i("div",[t._v("品牌:")]),t._v(" "),i("el-row",{staticClass:"demo-autocomplete"},[i("el-col",[i("el-autocomplete",{staticClass:"inline-input input",attrs:{size:"mini","fetch-suggestions":t.querySearch,placeholder:"请输入内容"},on:{select:t.handleSelect,input:t.GetUnitPriceByPO},model:{value:t.Product.Manufacturer,callback:function(e){t.$set(t.Product,"Manufacturer",e)},expression:"Product.Manufacturer"}})],1)],1)],1),t._v(" "),i("div",{staticClass:"demo"},[i("div",[t._v("年份:")]),t._v(" "),i("el-input",{attrs:{size:"mini"},model:{value:t.Product.ProductionYear,callback:function(e){t.$set(t.Product,"ProductionYear",e)},expression:"Product.ProductionYear"}})],1),t._v(" "),i("div",{staticClass:"demo"},[i("div",[t._v("保质期:")]),t._v(" "),i("el-select",{attrs:{size:"mini",placeholder:"请选择"},model:{value:t.Product.GuaranteePeriodMonths,callback:function(e){t.$set(t.Product,"GuaranteePeriodMonths",e)},expression:"Product.GuaranteePeriodMonths"}},t._l(t.options,function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),i("div",{staticClass:"demo"},[i("div",[t._v("库存量下限:")]),t._v(" "),i("el-input",{staticClass:"no-number",attrs:{type:"number",size:"mini"},model:{value:t.Product.MinInventoryAlert,callback:function(e){t.$set(t.Product,"MinInventoryAlert",e)},expression:"Product.MinInventoryAlert"}})],1),t._v(" "),i("div",{staticClass:"demo"},[i("div",[t._v("库存量上限:")]),t._v(" "),i("el-input",{staticClass:"no-number",attrs:{type:"number",size:"mini"},model:{value:t.Product.MaxInventoryAlert,callback:function(e){t.$set(t.Product,"MaxInventoryAlert",e)},expression:"Product.MaxInventoryAlert"}})],1),t._v(" "),i("div",{staticClass:"demo"},[i("div",[t._v("最佳库存量:")]),t._v(" "),i("el-input",{staticClass:"no-number",attrs:{type:"number",size:"mini"},model:{value:t.Product.OptimalInventory,callback:function(e){t.$set(t.Product,"OptimalInventory",e)},expression:"Product.OptimalInventory"}})],1),t._v(" "),i("div",{staticClass:"demo"},[i("div",[t._v("单位:")]),t._v(" "),i("el-input",{attrs:{size:"mini"},model:{value:t.Product.Unit,callback:function(e){t.$set(t.Product,"Unit",e)},expression:"Product.Unit"}})],1),t._v(" "),i("div",{staticClass:"demo"},[i("div",[t._v("是否回收:")]),t._v(" "),i("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:t.Product.Recovery,callback:function(e){t.$set(t.Product,"Recovery",e)},expression:"Product.Recovery"}})],1),t._v(" "),i("h3",[t._v("价格属性")]),t._v(" "),i("div",{staticClass:"Data_2"},[i("div",{staticClass:"demo2"},[i("div",{staticClass:"div_56789"},[t._v("采购单价:")]),t._v(" "),i("el-input",{staticClass:"input-with-select no-number",staticStyle:{width:"calc(100% - 120px)"},attrs:{placeholder:"请输入内容",size:"mini",type:"number"},on:{change:t.GetUnitPriceByPO},model:{value:t.Product.BuyingUnitPrice,callback:function(e){t.$set(t.Product,"BuyingUnitPrice",e)},expression:"Product.BuyingUnitPrice"}},[i("el-select",{staticStyle:{width:"120px"},attrs:{slot:"prepend",size:"mini",placeholder:"请选择币种"},on:{change:t.GetUnitPriceByPO},slot:"prepend",model:{value:t.Product.BuyingCurrency,callback:function(e){t.$set(t.Product,"BuyingCurrency",e)},expression:"Product.BuyingCurrency"}},[i("el-option",{attrs:{label:"RMB",value:"RMB"}}),t._v(" "),i("el-option",{attrs:{label:"EUR",value:"EUR"}}),t._v(" "),i("el-option",{attrs:{label:"GBP",value:"GBP"}})],1)],1),t._v(" "),i("div",{staticStyle:{width:"620px","min-height":"30px",float:"left","padding-left":"130px","box-sizing":"border-box"}},[i("el-collapse",[i("el-collapse-item",{attrs:{title:"采购单价 历史价格",name:"1"}},[i("el-table",{attrs:{data:t.Product.POHistoryPriceDtos,height:"200",size:"mini"}},[i("el-table-column",{attrs:{prop:"UnitPrice",label:"单价",width:"80"}}),t._v(" "),i("el-table-column",{attrs:{prop:"Currency",label:"单价币种",width:"70"}}),t._v(" "),i("el-table-column",{attrs:{label:"更新时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                                            "+t._s(e.row.CreateDate.split("T")[0])+"\n                                        ")]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"Creater",label:"更新人",width:"100"}})],1)],1)],1)],1)],1),t._v(" "),i("div",{staticClass:"demo2"},[i("div",{staticClass:"div_56789"},[t._v("销售单价:")]),t._v(" "),i("el-input",{staticClass:"no-number",staticStyle:{width:"200px"},attrs:{type:"number",size:"mini"},model:{value:t.Product.UnitPrice,callback:function(e){t.$set(t.Product,"UnitPrice",e)},expression:"Product.UnitPrice"}}),t._v(" "),i("div",{staticStyle:{width:"620px","min-height":"30px",float:"left","padding-left":"130px","box-sizing":"border-box"}},[i("el-collapse",[i("el-collapse-item",{attrs:{title:"销售单价 历史价格",name:"1"}},[i("el-table",{attrs:{data:t.Product.SOHistoryPriceDtos,height:"200",size:"mini"}},[i("el-table-column",{attrs:{prop:"UnitPrice",label:"单价",width:"80"}}),t._v(" "),i("el-table-column",{attrs:{prop:"Currency",label:"单价币种",width:"70"}}),t._v(" "),i("el-table-column",{attrs:{label:"更新时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                                            "+t._s(e.row.CreateDate.split("T")[0])+"\n                                        ")]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"Creater",label:"更新人",width:"100"}})],1)],1)],1)],1)],1)]),t._v(" "),i("div",{staticClass:"Data_2"},[i("div",{staticClass:"demo2"},[i("div",{staticClass:"div_56789"},[t._v("保养工时:")]),t._v(" "),i("el-input",{staticClass:"input-with-select a1 no-number",staticStyle:{width:"calc(100% - 120px)"},attrs:{placeholder:"请输入内容",size:"mini",type:"number"},on:{input:t.MaintainPrice},model:{value:t.Product.MaintainHours,callback:function(e){t.$set(t.Product,"MaintainHours",e)},expression:"Product.MaintainHours"}},[i("el-select",{staticStyle:{width:"120px"},attrs:{slot:"prepend",size:"mini",placeholder:"请选择系数"},on:{change:t.MaintainPrice},slot:"prepend",model:{value:t.Product.BMBSJ,callback:function(e){t.$set(t.Product,"BMBSJ",e)},expression:"Product.BMBSJ"}},[i("el-option",{attrs:{label:"宝马",value:"35"}}),t._v(" "),i("el-option",{attrs:{label:"保时捷",value:"45"}})],1)],1)],1),t._v(" "),i("div",{staticClass:"demo"},[i("div",[t._v("保养价格:")]),t._v(" "),i("el-input",{staticClass:"no-number",attrs:{type:"number",size:"mini"},model:{value:t.Product.MaintainPrice,callback:function(e){t.$set(t.Product,"MaintainPrice",e)},expression:"Product.MaintainPrice"}})],1)]),t._v(" "),i("div",{staticClass:"Data_2"},[i("div",{staticClass:"demo"},[i("div",[t._v("维修费欧元价:")]),t._v(" "),i("el-input",{staticClass:"no-number",attrs:{type:"number",size:"mini"},on:{input:function(e){return t.BuyingUnitPrice()}},model:{value:t.Product.ReapirChargeEUR,callback:function(e){t.$set(t.Product,"ReapirChargeEUR",e)},expression:"Product.ReapirChargeEUR"}})],1),t._v(" "),i("div",{staticClass:"demo"},[i("div",[t._v("维修费:")]),t._v(" "),i("el-input",{staticClass:"no-number",attrs:{type:"number",size:"mini"},model:{value:t.Product.RepairCharge,callback:function(e){t.$set(t.Product,"RepairCharge",e)},expression:"Product.RepairCharge"}})],1)]),t._v(" "),i("div",{staticClass:"Data_2"},[i("div",{staticClass:"demo"},[i("div",[t._v("安装工时:")]),t._v(" "),i("el-input",{staticClass:"no-number",attrs:{size:"mini",type:"number"},on:{input:function(e){return t.AssemblyUnitPriceTimeMN()}},model:{value:t.Product.AssemblyUnitPriceTime,callback:function(e){t.$set(t.Product,"AssemblyUnitPriceTime",e)},expression:"Product.AssemblyUnitPriceTime"}})],1),t._v(" "),i("div",{staticClass:"demo"},[i("div",[t._v("安装费:")]),t._v(" "),i("el-input",{staticClass:"no-number",attrs:{type:"number",size:"mini"},model:{value:t.Product.AssemblyUnitPrice,callback:function(e){t.$set(t.Product,"AssemblyUnitPrice",e)},expression:"Product.AssemblyUnitPrice"}})],1)]),t._v(" "),i("h3",[t._v("描述，内容，备注")]),t._v(" "),i("div",{staticClass:"bottom"},[i("div",{staticClass:"Memo"},[i("div",[t._v("产品描述：")]),t._v(" "),i("el-input",{attrs:{type:"textarea",placeholder:"请输入内容","show-word-limit":""},model:{value:t.Product.Characteristics,callback:function(e){t.$set(t.Product,"Characteristics",e)},expression:"Product.Characteristics"}})],1),t._v(" "),i("div",{staticClass:"Memo"},[i("div",[t._v("保养内容：")]),t._v(" "),i("el-input",{attrs:{type:"textarea",placeholder:"请输入内容","show-word-limit":""},model:{value:t.Product.MaintainContent,callback:function(e){t.$set(t.Product,"MaintainContent",e)},expression:"Product.MaintainContent"}})],1),t._v(" "),i("div",{staticClass:"Memo"},[i("div",[t._v("备注：")]),t._v(" "),i("el-input",{attrs:{type:"textarea",placeholder:"请输入内容","show-word-limit":""},model:{value:t.Product.Barcode,callback:function(e){t.$set(t.Product,"Barcode",e)},expression:"Product.Barcode"}})],1)]),t._v(" "),i("h3",[t._v("图片\n                "),i("el-button",{staticStyle:{float:"right"},attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.UpImg()}}},[t._v("上传")])],1),t._v(" "),t._l(t.Product.ProductPhotoDtos,function(e,r){return i("div",{key:r,staticClass:"img"},[i("el-image",{staticStyle:{width:"150px"},attrs:{"preview-src-list":["http://icms.inchwell.com.cn/File/product/"+e.File],src:"http://icms.inchwell.com.cn/File/product/"+e.File}}),t._v(" "),i("i",{staticClass:"el-icon-delete-solid iconimg",on:{click:function(i){return t.deleteImg(e.Id)}}})],1)}),t._v(" "),i("el-upload",{staticStyle:{float:"left"},attrs:{action:t.uploadFileUrlapp,data:{attachType:0},name:"appFile",limit:10,multiple:!0,accept:"image/*,video/*","before-upload":t.beforeuploadMainGraph,"on-success":t.handleSuccessMainGraph,"on-preview":t.handlePreviewMainGraph,"before-remove":t.beforeremoveMainGraph,"on-remove":t.handleRemoveMainGraph,"list-type":"picture-card","file-list":t.imageUrlList}},[i("i",{staticClass:"el-icon-plus spc1"})]),t._v(" "),i("saxo-pop",{ref:"primary",attrs:{width:"600px",title:"查看图片"},on:{close:function(e){return t.$refs.primary.start()}}},[i("img",{attrs:{width:"100%",src:t.imageUrl.url,alt:""}})])]},proxy:!0}])})},staticRenderFns:[]};var o=i("VU/8")(r,a,!1,function(t){i("NuzR")},"data-v-69588dd8",null);e.default=o.exports}});