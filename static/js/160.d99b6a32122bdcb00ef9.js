webpackJsonp([160],{"6PFk":function(t,e){},ex0X:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s={data:function(){return{radio:"单个添加",Kehu:"不明款",CusId:"b8868525-e462-4574-b2f2-b746e9b40a54",Str:"",Other:"",DataBar:"",tabData:[],index:0,index2:0,UPState:!0,Err:!1,Type:"",Dt:"",Source:""}},computed:{},watch:{DataBar:function(t){if(!this.UPState)return!1;var e="";if(-1!=(t=t.replace(/\ +/g," ")).indexOf("，")?e="，":-1!=t.indexOf("\t")?e="\t":-1!=t.indexOf(" ")&&(e="***"),"***"==e)t=t.replace(/\ +/g,"***");function a(t){if(t&&void 0!=t&&null!=t){var e=t;return e=(e=e.toString()).replace(/,/gi,"")}return t}function s(t){var e,a,s=t.toString(),i=/^(\d+)(e)([\-]?\d+)$/,r="";if(i.test(s)){e=i.exec(s),a=Math.abs(e[3])-1;for(var o=0;o<a;o++)r+="0";return"0."+r+e[1]}return t}console.log(t);for(var i=t.split("\n"),r=[],o=0;o<i.length;o++){var n=i[o],l={Str:s(Number(a(n.split(e)[0])).toFixed(2)),Type:n.split(e)[1],Up:0,Memo:""};l.Type&&l.Str&&r.push(l)}console.log(r),this.tabData=r}},methods:{CopyFun:function(){console.log("00000");for(var t="",e=0;e<this.tabData.length;e++){var a=this.tabData[e];2==a.Up&&(t+=a.Type+"-"+a.Str+"\n")}var s=this;s.$copyText(t).then(function(t){s.$message({message:"复制成功",type:"success"})},function(t){s.$message.error("复制失败")})},Create:function(){return this.CusId?this.Str?this.Type?this.Source?void this.AddCusCapital():(this.$message.error("没有选择来自"),!1):(this.$message.error("没有选择隶属公司"),!1):(this.$message.error("没有输入款额"),!1):(this.$message.error("没有输入客户！"),!1)},AddCusCapital2:function(t){if(!this.Type)return this.$message.error("没有选择隶属公司"),!1;this.UPState=!1,this.index=this.tabData.length;for(var e=0;e<this.tabData.length;e++){var a=this.tabData[e];this.AddTo(a,e)}},AddTo:function(t,e){var a=this;this.tabData[e].Up="正在创建";var s={Str:t.Str,Type:t.Type,Append:this.Type,Dt:this.Dt};this.API_POST("CRM/AddCusCapital2",s,!1,!0,!0).then(function(t){console.log(t),0==t.Code?a.tabData[e].Up=1:(a.tabData[e].Up=2,a.tabData[e].Memo=t.Msg.split("：")[1],a.index2+=1,a.Err=!0),a.index-=1,0==a.index&&(0==a.index2?a.$message({message:"创建完毕，无错误！",type:"success"}):a.$message.error("创建完毕，有"+a.index2+"项错误！"))})},AddCusCapital:function(){var t=this,e={data:{Id:this.CusId,Str:this.Str,Other:this.Other,Append:this.Type,Dt:this.Dt,Source:this.Source},api:"post",url:this.$store.state.http+"CRM/AddCusCapital"};this.$https(e).then(function(e){console.log(e.Data.Dtos),t.$message({message:"创建成功！",type:"success"}),t.$router.push({path:"/GetCusCapitalPools"}),t.$emit("refresh")})},querySearch:function(t,e){if(console.log(t),void 0==t)return t="",!1;""==t&&(t="北京");var a={data:{search:t},api:"get",url:this.$store.state.http+"CRM/GetCustomerMini",header:this.$store.state.token};this.$https(a).then(function(t){console.log(t.Data.Dtos);if(0==t.Data.Dtos.length)return e([]),!1;for(var a=0;a<t.Data.Dtos.length;a++)t.Data.Dtos[a].value=t.Data.Dtos[a].FullName;e(t.Data.Dtos)})},handleSelect:function(t){console.log(t),this.CusId=t.CusId}},created:function(){console.log(this.GetDate("-",-1)),this.Dt=this.GetDate("-",-1)},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},i={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"box_s"},[a("div",{staticClass:"retrieve"},[a("span",{staticClass:"retrieveSpan"},[t._v("创建客户资金")]),t._v(" "),"单个添加"==t.radio?a("saxo-button",{staticStyle:{float:"right"},attrs:{type:"success",mini:""},on:{click:function(e){return t.Create()}}},[t._v("创 建")]):t._e()],1),t._v(" "),a("div",{staticClass:"Con"},[a("el-radio-group",{staticStyle:{margin:"30px 0 30px 132px"},attrs:{size:"mini"},model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}},[a("el-radio-button",{attrs:{label:"单个添加"}}),t._v(" "),a("el-radio-button",{attrs:{label:"多个添加"}})],1),t._v(" "),"单个添加"==t.radio?a("div",{staticClass:"From"},[a("span",[t._v("客户")]),t._v(" "),a("span",{staticStyle:{"line-height":"50px",color:"#606266"}},[t._v(t._s(t.Kehu))])]):t._e(),t._v(" "),"单个添加"==t.radio?a("div",{staticClass:"From"},[a("span",[t._v("款额")]),t._v(" "),a("el-input",{attrs:{placeholder:"款额"},model:{value:t.Str,callback:function(e){t.Str=e},expression:"Str"}})],1):t._e(),t._v(" "),"单个添加"==t.radio?a("div",{staticClass:"From"},[a("span",[t._v("隶属")]),t._v(" "),a("el-radio-group",{staticStyle:{marginTop:"15px"},model:{value:t.Type,callback:function(e){t.Type=e},expression:"Type"}},[a("el-radio",{attrs:{label:"技术公司"}}),t._v(" "),a("el-radio",{attrs:{label:"服务公司"}})],1)],1):t._e(),t._v(" "),"单个添加"==t.radio?a("div",{staticClass:"From"},[a("span",[t._v("来自")]),t._v(" "),a("el-radio-group",{staticStyle:{marginTop:"15px"},model:{value:t.Source,callback:function(e){t.Source=e},expression:"Source"}},[a("el-radio",{attrs:{label:"企业"}}),t._v(" "),a("el-radio",{attrs:{label:"个人"}})],1)],1):t._e(),t._v(" "),"单个添加"==t.radio?a("div",{staticClass:"From"},[a("span",[t._v("日期")]),t._v(" "),a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:t.Dt,callback:function(e){t.Dt=e},expression:"Dt"}})],1):t._e(),t._v(" "),"单个添加"==t.radio?a("div",{staticClass:"From"},[a("span",[t._v("备注")]),t._v(" "),a("el-input",{attrs:{type:"textarea",placeholder:"请输入备注",autosize:{minRows:2,maxRows:4}},model:{value:t.Other,callback:function(e){t.Other=e},expression:"Other"}})],1):t._e(),t._v(" "),"单个添加"!=t.radio?a("div",[a("div",{staticClass:"From2",staticStyle:{"min-height":"50px",height:"null"}},[a("span",[t._v("多条输入")]),t._v(" "),a("el-input",{staticStyle:{width:"500px"},attrs:{type:"textarea",autosize:{minRows:4,maxRows:50},placeholder:"款额  公司  \n款额  公司\n款额  公司"},model:{value:t.DataBar,callback:function(e){t.DataBar=e},expression:"DataBar"}})],1),t._v(" "),a("div",{staticClass:"From"},[a("span",[t._v("隶属")]),t._v(" "),a("el-radio-group",{staticStyle:{marginTop:"15px"},model:{value:t.Type,callback:function(e){t.Type=e},expression:"Type"}},[a("el-radio",{attrs:{label:"技术公司"}}),t._v(" "),a("el-radio",{attrs:{label:"服务公司"}})],1)],1),t._v(" "),a("div",{staticClass:"From"},[a("span",[t._v("日期")]),t._v(" "),a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:t.Dt,callback:function(e){t.Dt=e},expression:"Dt"}})],1),t._v(" "),a("div",{staticClass:"From2"},[t.UPState?a("span",[t._v("核对数据")]):t._e(),t._v(" "),t.UPState?t._e():a("span",[t._v("创建结果")]),t._v(" "),a("div",{staticClass:"dataheap"},[a("div",{staticClass:"li"},[a("table",t._l(t.tabData,function(e,s){return a("tr",{key:s},[a("td",{staticStyle:{"padding-right":"50px !important"}},[t._v(t._s(e.Type))]),t._v(" "),a("td",{staticStyle:{"padding-right":"50px !important"}},[t._v("￥ "+t._s(e.Str))]),t._v(" "),a("td",{staticStyle:{"padding-right":"50px !important"}},[0==e.Up?a("span",{staticClass:"LiSpan0"},[t._v("等待上传")]):t._e(),t._v(" "),1==e.Up?a("span",{staticClass:"LiSpan1"},[t._v("创建成功")]):t._e(),t._v(" "),2==e.Up?a("span",{staticClass:"LiSpan2"},[t._v(t._s(e.Memo))]):t._e()])])}),0)])]),t._v(" "),0!=t.tabData.length&&t.UPState?a("saxo-button",{staticStyle:{float:"left"},attrs:{type:"primary",mini:""},on:{click:function(e){return t.AddCusCapital2()}}},[t._v("开始创建")]):t._e(),t._v(" "),0!=t.tabData.length&&!t.UPState&&t.Err?a("saxo-button",{staticStyle:{float:"left"},attrs:{type:"primary",mini:""},on:{click:function(e){return t.CopyFun()}}},[t._v("复制错误项")]):t._e()],1)]):t._e()],1)])},staticRenderFns:[]};var r=a("VU/8")(s,i,!1,function(t){a("6PFk")},"data-v-251edf5d",null);e.default=r.exports}});