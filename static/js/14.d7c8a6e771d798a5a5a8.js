webpackJsonp([14],{IpKV:function(t,e){},iZ2C:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("mvHQ"),n=a.n(r),l={data:function(){return{returnData:{SourceId:"",From:"",GoodsPayStatus:"",ReturnType:"",Refund:"",RefundAmount:0,Memo:"",EquDtos:[],Source:""},tableData:[]}},created:function(){var t=this;console.log(this.$route.query),this.returnData.SourceId=this.$route.query.Id,this.returnData.From=this.$route.query.From,this.tableData=this.$route.query.EquDtos,0!=this.tableData.length&&this.tableData.forEach(function(e){t.$set(e,"ReturnsNumber",""),t.$set(e,"ReturnsPrice","")})},mounted:function(){},computed:{newEquDtos:function(){return n()(this.tableData)}},watch:{newEquDtos:function(t){var e=this,a=JSON.parse(t);this.returnData.EquDtos=[],1!=this.returnData.ReturnType&&(this.returnData.RefundAmount=0),a.forEach(function(t){""==t.ReturnsNumber&&""==t.ReturnsPrice||e.returnData.EquDtos.push({ProductId:t.ProductId,Number:t.ReturnsNumber,SellingPrice:t.ReturnsPrice}),1!=e.returnData.ReturnType&&""!=t.ReturnsNumber&&""!=t.ReturnsPrice&&(e.returnData.RefundAmount+=Number(t.ReturnsNumber)*Number(t.ReturnsPrice),e.returnData.RefundAmount=Number(e.returnData.RefundAmount.toFixed(2)))})}},methods:{AddMsoReturn:function(){var t=this;if(console.log(this.returnData),""==this.returnData.GoodsPayStatus)return this.$message.error("请选择货款状态！"),!1;if(""==this.returnData.ReturnType)return this.$message.error("请选择退货退款类型！"),!1;if(""==this.returnData.Refund)return this.$message.error("请选择退款方式！"),!1;if(0==this.returnData.RefundAmount&&(1==this.returnData.GoodsPayStatus||2==this.returnData.GoodsPayStatus))return this.$message.error("退货金额不可为 0 "),!1;if(3==this.returnData.GoodsPayStatus||4==this.returnData.GoodsPayStatus)this.returnData.Source="";else if(!this.returnData.Source)return this.$message.error("请选择资金退回！"),!1;for(var e=0;e<this.returnData.EquDtos.length;e++){var a=this.returnData.EquDtos[e];if(console.log(a),0==Number(a.SellingPrice)&&(1==this.returnData.GoodsPayStatus||2==this.returnData.GoodsPayStatus))return this.$message.warning("退货金额不可为 0 "),!1}this.API_POST("MachineSO/AddMsoReturnV2",this.returnData).then(function(e){t.$message.success("退货成功！"),t.$router.go(-1),t.$emit("refresh")})}},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"box_s"},[a("SaxoPage",{scopedSlots:t._u([{key:"title",fn:function(){return[a("saxo-button",{staticStyle:{float:"right"},attrs:{type:"primary",mini:""},on:{click:function(e){return t.AddMsoReturn()}}},[t._v("确认")])]},proxy:!0},{key:"content",fn:function(){return[a("div",{staticClass:"From"},[a("span",[t._v("来源")]),t._v(" "),1==t.returnData.From?a("span",[t._v("整机订单退货")]):t._e(),t._v(" "),2==t.returnData.From?a("span",[t._v("零配件订单退货")]):t._e(),t._v(" "),3==t.returnData.From?a("span",[t._v("整机采购单退货")]):t._e()]),t._v(" "),a("div",{staticClass:"From"},[a("span",[t._v("货款状态")]),t._v(" "),a("el-radio-group",{on:{change:function(e){t.returnData.ReturnType="",t.returnData.Refund=""}},model:{value:t.returnData.GoodsPayStatus,callback:function(e){t.$set(t.returnData,"GoodsPayStatus",e)},expression:"returnData.GoodsPayStatus"}},[a("el-radio",{attrs:{label:1}},[t._v("已付款未发货")]),t._v(" "),a("el-radio",{attrs:{label:2}},[t._v("已付款已发货")]),t._v(" "),a("el-radio",{attrs:{label:3}},[t._v("未付款未发货")]),t._v(" "),a("el-radio",{attrs:{label:4}},[t._v("未付款已发货")])],1)],1),t._v(" "),a("div",{staticClass:"From"},[a("span",[t._v("退货退款类型")]),t._v(" "),a("el-radio-group",{on:{change:function(e){t.returnData.Refund=""}},model:{value:t.returnData.ReturnType,callback:function(e){t.$set(t.returnData,"ReturnType",e)},expression:"returnData.ReturnType"}},[-1!=[1,2].indexOf(t.returnData.GoodsPayStatus)?a("el-radio",{attrs:{label:1}},[t._v("仅退款")]):t._e(),t._v(" "),1==t.returnData.GoodsPayStatus?a("el-radio",{attrs:{label:2}},[t._v("退款并删除设备")]):t._e(),t._v(" "),2==t.returnData.GoodsPayStatus?a("el-radio",{attrs:{label:3}},[t._v("退款退货")]):t._e(),t._v(" "),3==t.returnData.GoodsPayStatus?a("el-radio",{attrs:{label:4}},[t._v("删除设备")]):t._e(),t._v(" "),4==t.returnData.GoodsPayStatus?a("el-radio",{attrs:{label:5}},[t._v("仅退货")]):t._e()],1)],1),t._v(" "),a("div",{staticClass:"From"},[a("span",[t._v("退款方式")]),t._v(" "),a("el-radio-group",{model:{value:t.returnData.Refund,callback:function(e){t.$set(t.returnData,"Refund",e)},expression:"returnData.Refund"}},[-1!=[4,5].indexOf(t.returnData.ReturnType)?a("el-radio",{attrs:{label:1}},[t._v("货物价值")]):t._e(),t._v(" "),-1!=[1,2,3].indexOf(t.returnData.ReturnType)?a("el-radio",{attrs:{label:1}},[t._v("现金/货物价值")]):t._e(),t._v(" "),-1!=[1,2,3].indexOf(t.returnData.ReturnType)?a("el-radio",{attrs:{label:2}},[t._v("已开票挂账")]):t._e(),t._v(" "),-1!=[1,2,3].indexOf(t.returnData.ReturnType)?a("el-radio",{attrs:{label:3}},[t._v("未开票挂账")]):t._e()],1)],1),t._v(" "),a("div",{staticClass:"From"},[a("span",[t._v("金额")]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入金额",disabled:1!=t.returnData.ReturnType},model:{value:t.returnData.RefundAmount,callback:function(e){t.$set(t.returnData,"RefundAmount",e)},expression:"returnData.RefundAmount"}})],1),t._v(" "),a("div",{staticClass:"From"},[a("span",[t._v("资金来源")]),t._v(" "),a("el-radio-group",{model:{value:t.returnData.Source,callback:function(e){t.$set(t.returnData,"Source",e)},expression:"returnData.Source"}},[a("el-radio",{attrs:{disabled:3==t.returnData.GoodsPayStatus||4==t.returnData.GoodsPayStatus,label:"个人"}},[t._v("来自个人")]),t._v(" "),a("el-radio",{attrs:{disabled:3==t.returnData.GoodsPayStatus||4==t.returnData.GoodsPayStatus,label:"企业"}},[t._v("来自企业")])],1)],1),t._v(" "),a("div",{staticClass:"From",staticStyle:{height:"none","min-height":"150px"}},[a("span",[t._v("备注")]),t._v(" "),a("el-input",{attrs:{type:"textarea",autosize:{minRows:5,maxRows:5},placeholder:"请输入备注"},model:{value:t.returnData.Memo,callback:function(e){t.$set(t.returnData,"Memo",e)},expression:"returnData.Memo"}})],1),t._v(" "),1!=t.returnData.ReturnType&&""!=t.returnData.ReturnType?a("div",{staticClass:"From",staticStyle:{height:"none"}},[a("span",[t._v("设备")]),t._v(" "),1==t.returnData.From?a("el-table",{staticStyle:{width:"calc(100% - 200px)"},attrs:{data:t.tableData}},[a("el-table-column",{attrs:{label:"序号",type:"index",width:"50"}}),t._v(" "),a("el-table-column",{attrs:{prop:"ProductCode",label:"对内编码",width:"150"}}),t._v(" "),a("el-table-column",{attrs:{prop:"LongCode",label:"对外编码",width:"150"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Describe2",label:"描述","show-overflow-tooltip":!0}}),t._v(" "),a("el-table-column",{attrs:{label:"原始单价","header-align":"center",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:"price"},[t._v(" "+t._s(t.FinancialAmountFormat(e.row.OriginalPrice)))])]}}],null,!1,1552512277)}),t._v(" "),a("el-table-column",{attrs:{label:"优惠后单价","header-align":"center",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:"price"},[t._v(" "+t._s(t.FinancialAmountFormat(e.row.DiscountPrice)))])]}}],null,!1,1076014801)}),t._v(" "),a("el-table-column",{attrs:{label:"优惠后合计","header-align":"center",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:"price"},[t._v(" "+t._s(t.FinancialAmountFormat(e.row.DiscountPrice*e.row.Quantity)))])]}}],null,!1,2208760928)}),t._v(" "),a("el-table-column",{attrs:{label:"数量",width:"70",prop:"Quantity"}}),t._v(" "),a("el-table-column",{attrs:{label:"已发量",width:"70",prop:"NoSentQuantity"}}),t._v(" "),a("el-table-column",{attrs:{label:"退货数量",fixed:"right",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{staticStyle:{width:"90px"},attrs:{size:"mini",placeholder:"退货数量"},model:{value:e.row.ReturnsNumber,callback:function(a){t.$set(e.row,"ReturnsNumber",a)},expression:"scope.row.ReturnsNumber"}})]}}],null,!1,3414333808)}),t._v(" "),a("el-table-column",{attrs:{label:"退货单价",fixed:"right",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{staticStyle:{width:"90px"},attrs:{size:"mini",placeholder:"退货单价"},model:{value:e.row.ReturnsPrice,callback:function(a){t.$set(e.row,"ReturnsPrice",a)},expression:"scope.row.ReturnsPrice"}})]}}],null,!1,3339646115)})],1):t._e(),t._v(" "),3==t.returnData.From?a("el-table",{staticStyle:{width:"calc(100% - 200px)"},attrs:{data:t.tableData}},[a("el-table-column",{attrs:{label:"序号",type:"index",width:"50"}}),t._v(" "),a("el-table-column",{attrs:{prop:"ProductCode",label:"对内编码",width:"150"}}),t._v(" "),a("el-table-column",{attrs:{prop:"LongCode",label:"对外编码",width:"150"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Describe",label:"描述","show-overflow-tooltip":!0}}),t._v(" "),a("el-table-column",{attrs:{label:"采购单价",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:"price"},[t._v(" "+t._s(t.FinancialAmountFormat(e.row.UnitPrice,t.FinancialAmountSymbol(e.row.BuyingCurrency))))])]}}],null,!1,673474317)}),t._v(" "),a("el-table-column",{attrs:{label:"数量",width:"50"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticStyle:{"text-align":"center"}},[t._v(t._s(e.row.POQuantity))])]}}],null,!1,496730816)}),t._v(" "),a("el-table-column",{attrs:{label:"累计发货",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticStyle:{"text-align":"center"}},[t._v(t._s(e.row.DeliverQuantity))])]}}],null,!1,1637156218)}),t._v(" "),a("el-table-column",{attrs:{label:"不发货量",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticStyle:{"text-align":"center"}},[t._v(t._s(e.row.NoSentQuantity))])]}}],null,!1,1272038066)}),t._v(" "),a("el-table-column",{attrs:{label:"已发量",width:"70",prop:"NoSentQuantity"}}),t._v(" "),a("el-table-column",{attrs:{label:"退货数量",fixed:"right",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{staticStyle:{width:"90px"},attrs:{size:"mini",placeholder:"退货数量"},model:{value:e.row.ReturnsNumber,callback:function(a){t.$set(e.row,"ReturnsNumber",a)},expression:"scope.row.ReturnsNumber"}})]}}],null,!1,3414333808)}),t._v(" "),a("el-table-column",{attrs:{label:"退货单价",fixed:"right",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{staticStyle:{width:"90px"},attrs:{size:"mini",placeholder:"退货单价"},model:{value:e.row.ReturnsPrice,callback:function(a){t.$set(e.row,"ReturnsPrice",a)},expression:"scope.row.ReturnsPrice"}})]}}],null,!1,3339646115)})],1):t._e(),t._v(" "),2==t.returnData.From?a("el-table",{staticStyle:{width:"calc(100% - 200px)"},attrs:{data:t.tableData}},[a("el-table-column",{attrs:{label:"序号",type:"index",width:"50"}}),t._v(" "),a("el-table-column",{attrs:{prop:"ProcodeCode",label:"产品编号",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Brand",label:"品牌",width:"150"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Desc",label:"描述","show-overflow-tooltip":!0}}),t._v(" "),a("el-table-column",{attrs:{label:"采购单价",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:"price"},[t._v(" "+t._s(t.FinancialAmountFormat(e.row.BuyingUnitPrice,t.FinancialAmountSymbol(e.row.BuyingCurrency))))])]}}],null,!1,916685379)}),t._v(" "),a("el-table-column",{attrs:{label:"销售单价",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:"price"},[t._v(" "+t._s(t.FinancialAmountFormat(e.row.UnitPrice)))])]}}],null,!1,1348604746)}),t._v(" "),a("el-table-column",{attrs:{prop:"Number",label:"数量",width:"150"}}),t._v(" "),a("el-table-column",{attrs:{label:"退货数量",fixed:"right",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{staticStyle:{width:"90px"},attrs:{size:"mini",placeholder:"退货数量"},model:{value:e.row.ReturnsNumber,callback:function(a){t.$set(e.row,"ReturnsNumber",a)},expression:"scope.row.ReturnsNumber"}})]}}],null,!1,3414333808)}),t._v(" "),a("el-table-column",{attrs:{label:"退货单价",fixed:"right",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{staticStyle:{width:"90px"},attrs:{size:"mini",placeholder:"退货单价"},model:{value:e.row.ReturnsPrice,callback:function(a){t.$set(e.row,"ReturnsPrice",a)},expression:"scope.row.ReturnsPrice"}})]}}],null,!1,3339646115)})],1):t._e()],1):t._e()]},proxy:!0}])})],1)},staticRenderFns:[]};var o=a("VU/8")(l,u,!1,function(t){a("IpKV")},"data-v-03681569",null);e.default=o.exports}});