webpackJsonp([90],{"60wG":function(t,e){},"6S2w":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("t4zo"),i=a.n(n),l=a("uXZL"),r=a.n(l),s={name:"Ech",data:function(){return{Data:[],msg:"赵鸿飞",area:"",areaS:[],Brandi:"Maha",Brand:[],CustomerType:"奥迪",TimeData:[],ValueData:[],year:"",monthrange:"",begin:"",end:"",Time:"",myChart2data:[],seriesdata:[],Timetable:"",TimetableYU:"",ValueType:"",ValueDataS:0,BIgtext:"",TableData:[],TimetableYUData:[],SalesData:[]}},mounted:function(){this.init(),this.initGetArea(),this.GetBrand()},methods:{init:function(t){var e=this;console.log(t),"monthrange"===t&&null!=this.monthrange&&(this.begin=this.monthrange[0],this.end=this.monthrange[1],this.Timetable=this.begin+"-"+this.end,this.year=""),"year"===t&&null!=this.year&&(console.log(this.year),this.begin=this.year,(new Date).getFullYear()==this.year.split("-")[0]?this.end=(new Date).getFullYear()+"-"+(Number((new Date).getMonth())+1):this.end=this.year.split("-")[0]+"-12",this.Timetable=this.begin.split("-")[0]),""==this.begin&&(this.year=(new Date).getFullYear()+"-1",this.begin=(new Date).getFullYear()+"-1",this.end=(new Date).getFullYear()+"-"+(Number((new Date).getMonth())+1),this.Timetable=this.begin.split("-")[0]);var a={begin:this.begin,end:this.end,cusType:this.CustomerType,area:this.area,brand:this.Brandi};this.API_GET("Statistic/SOSalesVolume",a).then(function(t){e.SalesData=t,console.log(t),e.TimeData=[],e.ValueData=[],e.ValueDataS=0;e.TimetableYUData=[];var a=Number(e.begin.split("-")[0]),n=Number(e.begin.split("-")[1]),i=t[0].StatDtos,l=t[1].StatDtos,r=t[2].StatDtos;e.ValueData=[["product","零配件","维修费","差旅费"]];for(var s=0;s<i.length;s++){var o=i[s].Key,d=Number(i[s].Value),p=Number(r[s].Value),h=Number(l[s].Value);e.TimeData.push(o),e.ValueData.push([o,d,p,h]),n+s<13&&e.TimetableYUData.push(a+"-"+(n+s)),n+s>12&&n+s<25&&e.TimetableYUData.push(a+1+"-"+(n+s-12)),n+s>24&&n+s<37&&e.TimetableYUData.push(a+2+"-"+(n+s-24))}console.log(e.ValueData),e.BIgtext="没有最佳销售额",console.log(e.begin),e.drawLine()})},initGetArea:function(){var t=this;this.API_GET("System/GetArea").then(function(e){t.areaS=e})},GetBrand:function(){var t=this;this.API_GET("System/GetBrand").then(function(e){t.Brand=e;for(var a=0;a<t.Brand.length;a++)t.Brand[a].value=t.Brand[a].Value;console.log(t.Brand)})},querySearch:function(t,e){if(console.log(t),void 0==t)return t="",!1;if(""==t)return e(this.Brand),this.init(),!1;for(var a=t,n=this.Brand,i=[],l=(a.split("")[0],0);l<n.length;l++){var r=n[l];if(-1!=r.value.indexOf(a)){i.push(r);break}}console.log(i),e(i)},handleSelect:function(t){this.init()},drawLine:function(){var t=this,e=t.$echarts.init(document.getElementById("myChart1"));return e.off("click"),e.setOption({legend:{},tooltip:{},dataset:{source:this.ValueData},xAxis:{type:"category"},yAxis:{},series:[{type:"bar",itemStyle:{normal:{color:"#5470c6"}}},{type:"bar",itemStyle:{normal:{color:"#91cc75"}}},{type:"bar",itemStyle:{normal:{color:"#fac858"}}}]}),e.on("click",function(e){console.log(e),t.TimetableYU=t.TimetableYUData[e.dataIndex],t.ValueType=e.seriesName,t.SOSalesByArea(e.seriesIndex+1)}),!1},drawLinerwo:function(){var t=this.$echarts.init(document.getElementById("myChart2"));t.off("click"),t.setOption({title:{text:this.TimetableYU+"月 "+this.ValueType+" 销售额",x:"center"},color:["#cca272","#74608f","#d7a02b","#c8ba23","#9bca63","#fe8463","#fcce10","#FF0099","#d8a056","#909399","#67C23A","#F56C6C"],tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{orient:"vertical",left:"left",data:this.myChart2data},series:[{name:"标题!",type:"pie",radius:"55%",center:["50%","60%"],data:this.seriesdata,emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0}}}]})},SOSalesByArea:function(t){var e=this;console.log("SOSalesByArea");var a={date:this.TimetableYU,cusType:this.CustomerType,brand:"",type:t};this.API_GET("Statistic/SOSalesByArea",a).then(function(t){console.log(t.StatDtos);var a=t.StatDtos;e.myChart2data=[],e.seriesdata=[];for(var n=0;n<a.length;n++)e.myChart2data.push(a[n].Key),e.seriesdata.push({value:a[n].Value,name:a[n].Key});console.log(e.myChart2data),e.drawLinerwo()})},Delwd:function(){var t=this,e={begin:this.begin,end:this.end,cusType:this.CustomerType,area:this.area,brand:this.Brandi};this.API_GET("Statistic/SOSalesDetail",e).then(function(e){t.Data=e.Dtos,console.log(t.Data),setTimeout(function(){t.DekExcel1()},500)})},exportExcel:function(){var t=r.a.utils.table_to_book(document.querySelector("#out-table"),{raw:!0});console.log(t);var e=r.a.write(t,{bookType:"xlsx",bookSST:!0,type:"array"});try{i.a.saveAs(new Blob([e],{type:"application/octet-stream"}),"零配件销售额.xlsx")}catch(t){"undefined"!=typeof console&&console.log(t,e)}return e},transNum:function(t){return t.replace(/^(\d+)(?:.(\d+))*eE(\d+)/,function(t,e,a,n,i){return a=a||"","-"===n&&i>0?"0."+"0".repeat(i-1)+e+a:e+(a.length>i?a.substr(0,i)+"."+a.substr(i):a+"0".repeat(i-a.length))})},DekExcel1:function(){var t="height:30px;line-height:30px;",e="width:400px;height:30px;line-height:30px;",a="width:1000px;height:30px;line-height:30px;",n="<tr>    \n                        <td style='"+t+"'>\n                          <p>客户名称</p>\n                        </td>\n                         <td style='"+t+"'>\n                          <p>订单单号</p>\n                        </td>\n                         <td style='"+t+"'>\n                          <p>付款日期</p>\n                        </td>\n                         <td style='"+t+"'>\n                          <p>产品型号</p>\n                        </td>\n                         <td style='"+t+"'>\n                          <p>数量</p>\n                        </td>\n                         <td style='"+t+"'>\n                          <p>价格</p>\n                        </td>\n                         <td style='"+t+"'>\n                          <p>产品描述</p>\n                        </td>\n                    </tr>",i="";i+=" <tr>    \n                        <td colspan='7' style='height:30px;line-height:30px;font-size:25px;padding-left:180px;box-sizing:border-box;font-weight:bolder;text-align:center;'>\n                          <p>零配件部分</p>\n                        </td>\n                    </tr>",i+=n;for(var l=0;l<this.Data[0].Dtos.length;l++){var r=this.Data[0].Dtos[l];i+="<tr>    \n                        <td style='"+e+"'>\n                          <p>"+r.CusFullName+"</p>\n                        </td>\n                         <td style='"+t+"'>\n                          <p>"+r.Code+"</p>\n                        </td>\n                         <td style='"+t+"'>\n                          <p>"+r.Date.split("T")[0]+"</p>\n                        </td>\n                        <td style='vnd.ms-excel.numberformat:@' style='"+t+"'>\n                          <p>"+r.ProductCode+"\t</p>\n                        </td>\n                         <td style='"+t+"'>\n                          <p>"+r.Number+"</p>\n                        </td>\n                         <td style='"+t+"'>\n                          <p>"+r.Price+"</p>\n                        </td>\n                         <td style='"+a+"'>\n                          <p>"+r.ProDesc+"</p>\n                        </td>\n                    </tr>"}i+=" <tr>    \n                        <td colspan='7' style='height:30px;line-height:30px;font-size:25px;padding-left:180px;box-sizing:border-box;font-weight:bolder;text-align:center;'>\n                          <p>差旅费部分</p>\n                        </td>\n                    </tr>",i+=n;for(var s=0;s<this.Data[1].Dtos.length;s++){var o=this.Data[1].Dtos[s];i+="<tr>    \n                        <td style='"+e+"'>\n                          <p>"+o.CusFullName+"</p>\n                        </td>\n                         <td style='"+t+"'>\n                          <p>"+o.Code+"</p>\n                        </td>\n                         <td style='"+t+"'>\n                          <p>"+o.Date.split("T")[0]+"</p>\n                        </td>\n                        <td style='vnd.ms-excel.numberformat:@' style='"+t+"'>\n                          <p>"+o.ProductCode+"\t</p>\n                        </td>\n                         <td style='"+t+"'>\n                          <p>"+o.Number+"</p>\n                        </td>\n                         <td style='"+t+"'>\n                          <p>"+o.Price+"</p>\n                        </td>\n                         <td style='"+a+"'>\n                          <p>"+o.ProDesc+"</p>\n                        </td>\n                    </tr>"}i+=" <tr>    \n                        <td colspan='7' style='height:30px;line-height:30px;font-size:25px;padding-left:180px;box-sizing:border-box;font-weight:bolder;text-align:center;'>\n                          <p>维修费部分</p>\n                        </td>\n                    </tr>",i+=n;for(var d=0;d<this.Data[2].Dtos.length;d++){var p=this.Data[2].Dtos[d];i+="<tr>    \n                        <td style='"+e+"'>\n                          <p>"+p.CusFullName+"</p>\n                        </td>\n                         <td style='"+t+"'>\n                          <p>"+p.Code+"</p>\n                        </td>\n                         <td style='"+t+"'>\n                          <p>"+p.Date.split("T")[0]+"</p>\n                        </td>\n                        <td style='vnd.ms-excel.numberformat:@' style='"+t+"'>\n                          <p>"+p.ProductCode+"\t</p>\n                        </td>\n                         <td style='"+t+"'>\n                          <p>"+p.Number+"</p>\n                        </td>\n                         <td style='"+t+"'>\n                          <p>"+p.Price+"</p>\n                        </td>\n                         <td style='"+a+"'>\n                          <p>"+p.ProDesc+"</p>\n                        </td>\n                    </tr>"}var h='\n\t\t\t<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">\n\t\t\t<head>\n\t\t\t\t<meta charset="utf-8">\n\t\t\t</head>\n\t\t\t<body>\n                <table border=1 style="font-family: "宋体";border: 1px solid #333">\n                    '+i+"\n                </table>\n\t\t\t</body>\n\t\t\t</html>",c=document.createElement("a");c.download="销售额.xls",c.href="data:application/vnd.ms-excel;base64,"+window.btoa(unescape(encodeURIComponent(h))),document.body.appendChild(c),c.click(),document.body.removeChild(c)}}},o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"box"},[a("div",{staticClass:"top_init_data_INWEll",staticStyle:{borderBottom:"1px solid #ccc",paddingBottom:"5px"}},[a("el-date-picker",{staticStyle:{width:"100px"},attrs:{size:"mini","value-format":"yyyy-MM",type:"year",placeholder:"选择年"},on:{change:function(e){return t.init("year")}},model:{value:t.year,callback:function(e){t.year=e},expression:"year"}}),t._v(" "),a("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"monthrange",size:"mini","value-format":"yyyy-MM","range-separator":"至","start-placeholder":"开始月份","end-placeholder":"结束月份"},on:{change:function(e){return t.init("monthrange")}},model:{value:t.monthrange,callback:function(e){t.monthrange=e},expression:"monthrange"}}),t._v(" "),a("el-select",{staticStyle:{width:"120px"},attrs:{size:"mini",clearable:"",placeholder:"请选择区域"},on:{change:function(e){return t.init()}},model:{value:t.area,callback:function(e){t.area=e},expression:"area"}},t._l(t.areaS,function(t){return a("el-option",{key:t.Value,attrs:{label:t.Value,value:t.Value}})}),1),t._v(" "),a("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"mini",loading:this.$store.state.Vuex.loading},on:{click:function(e){return t.init()}}},[t._v("检索")])],1),t._v(" "),a("el-divider",{attrs:{"content-position":"left"}},[t._v("零配件销售额合计: "),t.SalesData[0]?a("span",[t._v(t._s(t.SalesData[0].Title||"- -"))]):t._e(),t._v(" 元 | 差旅费销售额合计: "),t.SalesData[1]?a("span",[t._v(t._s(t.SalesData[1].Title||"- -"))]):t._e(),t._v(" 元 | 维修费销售额合计: "),t.SalesData[2]?a("span",[t._v(t._s(t.SalesData[2].Title||"- -"))]):t._e(),t._v(" 元 ")]),t._v(" "),a("div",{style:{width:"800px",height:"400px"},attrs:{id:"myChart1"}}),t._v(" "),a("div",{style:{width:"480px",height:"320px"},attrs:{id:"myChart2"}}),t._v(" "),a("div",{staticStyle:{width:"80%",paddingBottom:"5px",float:"left",paddingLeft:"50px"}},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.Delwd()}}},[t._v("下载明细")]),t._v(" "),t._m(0)],1),t._v(" "),a("div",{staticClass:"table",staticStyle:{display:"none"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{size:"mini",data:t.TableData,"highlight-current-row":"",height:this.$store.state.TableOptimumHeight,border:"",id:"out-table","header-cell-style":{background:"#e1e1e1"}}},[a("el-table-column",{attrs:{prop:"CusFullName",width:"100",label:"客户名称"}}),t._v(" "),a("el-table-column",{attrs:{prop:"SOCode",width:"100",label:"订单单号"}}),t._v(" "),a("el-table-column",{attrs:{prop:"PayDate",width:"100",label:"付款日期"}}),t._v(" "),a("el-table-column",{attrs:{prop:"ProductCode",width:"100",label:"产品型号"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Number",width:"100",label:"数量"}}),t._v(" "),a("el-table-column",{attrs:{prop:"RealUnitPrice",width:"100",label:"价格"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Characteristics",width:"100",label:"产品描述"}})],1)],1)],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("p",{staticStyle:{lineHeight:"28px",fontSize:"13px"}},[this._v("\n            零配件取值：已确认之后的订单(排除AS订单)\n            "),e("br"),this._v("\n            差旅费取值：已结单的工单\n            "),e("br"),this._v("\n            维修费取值：已结单的工单\n        ")])}]};var d=a("VU/8")(s,o,!1,function(t){a("60wG")},"data-v-6918c198",null);e.default=d.exports}});