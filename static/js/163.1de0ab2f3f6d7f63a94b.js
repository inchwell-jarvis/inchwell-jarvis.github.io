webpackJsonp([163],{"1Gp0":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a("mvHQ"),l=a.n(o),i={name:"",data:function(){return{iframeData:{width:"100%",height:"99%",https:"./index.html",http:""},ToolObjectId:"",ToolProId:"",GetAllAll:[],options:[],Selectcontact:"",timer:"",labelPosition:"right",formLabelAlign:{Name:"",Email:"",Tel:"",LinkManId:"",Address:"",Default:"",Mobile:"",NameEn:""},tableData:[],drawer:!1,titlebatch:"查找零配件",pageNum:1,pagesize:10,productCode:"",barcodeMemo:"",man:"",desc:"",memo:"",total:0,Data:[],rightPX:0}},created:function(){this.GetAllAllPartDrawing()},mounted:function(){var t=this;window.onmessage=function(e){"webpack"==String(e.data).substring(0,7)||"[object"==String(e.data).substring(0,7)||t.HTMLtoVue(e.data)}},components:{},methods:{ShowIS:function(){0==this.rightPX?this.rightPX="-780px":this.rightPX=0},adds:function(t){var e=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});console.log(t);t=JSON.parse(l()(t));this.$set(t,"Number",1),t.switch=!0,t.ProductId=t.ID,t.Describe=t.Manufacturer;for(var a=0;a<this.tableData.length;a++){var o=this.tableData[a];if(console.log(o.ProductCode==t.ProductCode),o.ProductCode==t.ProductCode)return o.Number+=1,e.close(),!1}this.tableData.push(t),e.close()},func:function(t,e){this.pagesize=t,this.pageNum=e,this.initss()},initss:function(t){var e=this;1==t&&(this.pageNum=1);var a={api:"get",url:this.$store.state.http+"Product/GetProducts2",data:{pageNum:this.pageNum,numPerPage:this.pagesize,orderField:"",orderDirection:"",proType:"1",productCode:this.productCode,barcodeMemo:this.barcodeMemo,man:this.man,desc:this.desc,memo:this.memo}};this.$https(a).then(function(t){console.log(t.Data),e.total=t.Data.DataBars,e.Data=t.Data.Dtos;for(var a=0;a<e.Data.length;a++)e.Data[a].UpdateDate=e.Data[a].UpdateDate.split("T")[0];console.log(e.Data)})},handleClose:function(t){this.$confirm("确认关闭？").then(function(e){t()}).catch(function(t){})},LinkSpareParts:function(){this.drawer=!0,this.initss()},Trues:function(){var t=this;console.log(this.ToolProId),console.log(this.formLabelAlign),console.log(this.tableData);for(var e=[],a=0;a<this.tableData.length;a++){var o=this.tableData[a],l={};l.ProductId=o.ProductId,l.Number=o.Number,l.IsAssembly=o.switch,e.push(l)}var i={data:{AddressId:this.formLabelAlign.LinkManId,Type:2,CustomerId:this.ToolProId,WorkorderId:"",GoodsInfos:e,From:"ERP"},api:"post",url:this.$store.state.http+"CRM/SubmitOrder"};this.$https(i).then(function(e){console.log(e),t.$message({message:"创建成功",type:"success"}),t.$emit("refresh"),t.$router.push({path:"/SpareParts"})})},Dele:function(){this.formLabelAlign={Name:"",Email:"",Tel:"",LinkManId:"",Address:"",Default:"",Mobile:"",NameEn:""},this.Selectcontact="",this.ToolObjectId="",this.ToolProId=""},validate:function(t){return/^[0-9]*$/.test(Number(t))},querySearchs:function(t,e){if(""==this.ToolProId)return console.log("0000bj"),!1;var a={data:{cusId:this.ToolProId},api:"get",url:this.$store.state.http+"CRM/GetCusLinkManMini",header:this.$store.state.token};this.$https(a).then(function(t){console.log(t.Data.Dtos);if(0==t.Data.Dtos.length)return e([]),!1;for(var a=0;a<t.Data.Dtos.length;a++)t.Data.Dtos[a].value=t.Data.Dtos[a].Name;console.log(t.Data.Dtos),e(t.Data.Dtos)})},querySearch:function(t,e){if(console.log(t),void 0==t)return t="",!1;""==t&&(t="北京");var a={data:{search:t},api:"get",url:this.$store.state.http+"CRM/GetCustomerMini",header:this.$store.state.token};this.$https(a).then(function(t){console.log(t.Data.Dtos);if(0==t.Data.Dtos.length)return e([]),!1;for(var a=0;a<t.Data.Dtos.length;a++)t.Data.Dtos[a].value=t.Data.Dtos[a].FullName;console.log(t.Data.Dtos),e(t.Data.Dtos)})},handleSelects:function(t){console.log(t),this.formLabelAlign=t},handleSelect:function(t){null!=t.ImageUrl?this.StoreHttp=this.$store.state.Filehttp+"CusTool/"+t.ImageUrl:this.StoreHttp="",this.item=[],this.item[0]=t,this.ToolProId=t.CusId,console.log(this.ToolProId),this.Selectcontact="",this.formLabelAlign={Name:"",Email:"",Tel:"",LinkManId:"",Address:"",Default:"",Mobile:"",NameEn:""}},HTMLtoVue:function(t){var e=this;console.log(t);var a={data:{productCodce:t.replace(/^\s+|\s+$/g,"")},api:"get",url:this.$store.state.http+"Product/GetProductMini",header:this.$store.state.token};this.$https(a).then(function(t){t.Data.Number=1,t.Data.switch=!0;for(var a=0;a<e.tableData.length;a++){var o=e.tableData[a];if(o.ProductCode==t.Data.ProductCode)return o.Number+=1,!1}e.$confirm("<p> 描述： "+t.Data.Describe+"</p> <br/>  <p>编号: "+t.Data.ProductCode+"</p>","是否添加?",{confirmButtonText:"确定",cancelButtonText:"取消",dangerouslyUseHTMLString:!0}).then(function(){e.tableData.push(t.Data)}).catch(function(){}),console.log(t.Data)})},deleteRow:function(t){console.log(t.ProductCode);for(var e=0;e<this.tableData.length;e++)this.tableData[e].ProductCode==t.ProductCode&&this.tableData.splice(e,1)},GetAllAllPartDrawing:function(){var t=this,e={data:{},api:"get",url:this.$store.state.http+"System/GetAllAllPartDrawing",header:this.$store.state.token};this.$https(e).then(function(e){for(var a=0;a<e.Data.length;a++){var o=e.Data[a];o.label=o.Valus,o.value=o.Key,o.children=o.TwoDtos;for(var l=0;l<o.children.length;l++){var i=o.children[l];i.label=i.Valus,i.children=i.ThreeDtos,i.value=i.Key;for(var s=0;s<i.children.length;s++){var n=i.children[s];n.label=n.Key,n.value=n.Valus}}}console.log(e.Data),t.options=e.Data})},handleChange:function(t){console.log(t[2]),this.iframeData.http=this.$store.state.httpData+"content/pcpartsdrawing/productView/"+t[2],console.log(this.iframeData.http)}}},s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"box_s"},[a("div",{staticClass:"TopClickHandelSE"},[a("el-cascader",{staticStyle:{width:"100%"},attrs:{options:t.options,placeholder:"请选择零件图",props:{expandTrigger:"hover"},size:"mini"},on:{change:t.handleChange},model:{value:t.GetAllAll,callback:function(e){t.GetAllAll=e},expression:"GetAllAll"}})],1),t._v(" "),a("div",{staticClass:"ifarCo"},[a("iframe",{attrs:{scrolling:"no",width:t.iframeData.width,height:t.iframeData.height,src:t.iframeData.http,frameborder:"0"}})]),t._v(" "),a("div",{staticClass:"ifarRi",style:{right:t.rightPX}},[a("div",{staticClass:"arrow-left",on:{click:function(e){return t.ShowIS()}}},[0==t.rightPX?a("i",{staticClass:"el-icon-s-unfold"}):t._e(),t._v(" "),0!=t.rightPX?a("i",{staticClass:"el-icon-s-fold"}):t._e()]),t._v(" "),a("el-autocomplete",{staticClass:"inline-input",staticStyle:{width:"100%"},attrs:{size:"mini","show-overflow-tooltip":!0,"fetch-suggestions":t.querySearch,placeholder:"请选择客户",clearable:""},on:{select:t.handleSelect},model:{value:t.ToolObjectId,callback:function(e){t.ToolObjectId=e},expression:"ToolObjectId "}},[a("template",{slot:"prepend"},[t._v("选择客户")])],2),t._v(" "),a("el-autocomplete",{staticClass:"inline-input",staticStyle:{width:"100%",marginTop:"15px"},attrs:{size:"mini","show-overflow-tooltip":!0,"fetch-suggestions":t.querySearchs,placeholder:"请选择联系人",clearable:""},on:{select:t.handleSelects},model:{value:t.Selectcontact,callback:function(e){t.Selectcontact=e},expression:"Selectcontact "}},[a("template",{slot:"prepend"},[t._v("选择联系人")])],2),t._v(" "),a("el-input",{staticStyle:{marginTop:"15px",width:"48%"},attrs:{disabled:"",placeholder:"请输入手机",prop:"Mobile",size:"mini"},model:{value:t.formLabelAlign.Mobile,callback:function(e){t.$set(t.formLabelAlign,"Mobile",e)},expression:"formLabelAlign.Mobile"}},[a("template",{slot:"prepend"},[t._v("手机")])],2),t._v(" "),a("el-input",{staticStyle:{marginTop:"15px",width:"48%"},attrs:{disabled:"",placeholder:"请输入电话",size:"mini"},model:{value:t.formLabelAlign.Tel,callback:function(e){t.$set(t.formLabelAlign,"Tel",e)},expression:"formLabelAlign.Tel"}},[a("template",{slot:"prepend"},[t._v("电话")])],2),t._v(" "),a("el-input",{staticStyle:{marginTop:"15px",width:"48%"},attrs:{disabled:"",placeholder:"请输入地址",prop:"Mobile",size:"mini"},model:{value:t.formLabelAlign.Address,callback:function(e){t.$set(t.formLabelAlign,"Address",e)},expression:"formLabelAlign.Address"}},[a("template",{slot:"prepend"},[t._v("地址")])],2),t._v(" "),a("el-input",{staticStyle:{marginTop:"15px",width:"48%"},attrs:{disabled:"",placeholder:"请输入邮箱",size:"mini"},model:{value:t.formLabelAlign.Email,callback:function(e){t.$set(t.formLabelAlign,"Email",e)},expression:"formLabelAlign.Email"}},[a("template",{slot:"prepend"},[t._v("邮箱")])],2),t._v(" "),a("el-form",{ref:"formLabelAlign",staticStyle:{marginTop:"20px"},attrs:{"label-position":t.labelPosition,"status-icon":"","label-width":"80px",size:"mini",model:t.formLabelAlign}},[a("el-form-item",{attrs:{label:""}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,"max-height":"250",size:"mini"}},[a("el-table-column",{attrs:{fixed:"",prop:"Describe",label:"品牌","show-overflow-tooltip":!0,width:"200"}}),t._v(" "),a("el-table-column",{attrs:{fixed:"",prop:"ProductCode",label:"编码","show-overflow-tooltip":!0,width:"150"}}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"数量"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input-number",{attrs:{name:"Attributes",size:"mini","controls-position":"right",min:1},model:{value:e.row.Number,callback:function(a){t.$set(e.row,"Number",a)},expression:"scope.row.Number"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"甲方安装",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:e.row.switch,callback:function(a){t.$set(e.row,"switch",a)},expression:"scope.row.switch"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.deleteRow(e.row)}}},[t._v("移除")])]}}])})],1)],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.Trues()}}},[t._v("提交")]),t._v(" "),a("el-button",{on:{click:function(e){return t.Dele()}}},[t._v("重置")])],1)],1)],1),t._v(" "),a("el-drawer",{staticStyle:{width:"200%"},attrs:{visible:t.drawer,direction:"ltr",modal:!1,title:t.titlebatch,"before-close":t.handleClose},on:{"update:visible":function(e){t.drawer=e}}},[a("div",{staticClass:"top_init_data",staticStyle:{marginbottom:"10px"}},[a("el-input",{staticStyle:{width:"193px"},attrs:{size:"mini",placeholder:"请输入产品编码"},on:{change:function(e){return t.initss(1)}},model:{value:t.productCode,callback:function(e){t.productCode=e},expression:"productCode"}}),t._v(" "),a("el-input",{staticStyle:{width:"193px"},attrs:{size:"mini",placeholder:"请输入内部编码"},on:{change:function(e){return t.initss(1)}},model:{value:t.barcodeMemo,callback:function(e){t.barcodeMemo=e},expression:"barcodeMemo"}}),t._v(" "),a("el-input",{staticStyle:{width:"193px"},attrs:{size:"mini",placeholder:"请输入产品描述"},on:{change:function(e){return t.initss(1)}},model:{value:t.desc,callback:function(e){t.desc=e},expression:"desc"}}),t._v(" "),a("el-input",{staticStyle:{width:"193px"},attrs:{size:"mini",placeholder:"请输入产品备注"},on:{change:function(e){return t.initss(1)}},model:{value:t.memo,callback:function(e){t.memo=e},expression:"memo"}}),t._v(" "),a("el-select",{attrs:{filterable:"",placeholder:"请选择品牌",size:"mini",clearable:""},on:{change:function(e){return t.initss(1)}},model:{value:t.man,callback:function(e){t.man=e},expression:"man"}},t._l(t.$store.state.Vuex.Brand,function(t){return a("el-option",{key:t.value,attrs:{label:t.Value,value:t.value}})}),1),t._v(" "),a("el-button",{staticStyle:{float:"right"},attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.initss(1)}}},[t._v("检索")])],1),t._v(" "),a("el-table",{ref:"multipleTable",staticStyle:{marginbottom:"10px"},attrs:{data:t.Data,size:"mini",height:this.$store.state.TableOptimumHeight,border:"","header-cell-style":{background:"#e1e1e1"}}},[a("el-table-column",{attrs:{prop:"ProductCode",label:"产品编号",width:"170"}}),t._v(" "),a("el-table-column",{attrs:{prop:"BarcodeMemo",label:"内部编码",width:"140"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Manufacturer",label:"品牌",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Characteristics",label:"产品描述","show-overflow-tooltip":!0}}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return t.adds(e.row)}}},[t._v("添加")])]}}])})],1),t._v(" "),a("SaxoFenYe",{attrs:{total:t.total},on:{func:t.func}})],1)],1)},staticRenderFns:[]};var n=a("VU/8")(i,s,!1,function(t){a("SNG0")},"data-v-22b293f4",null);e.default=n.exports},SNG0:function(t,e){}});