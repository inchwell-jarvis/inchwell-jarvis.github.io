webpackJsonp([32],{Igyc:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("mvHQ"),o=a.n(n),l=a("bOdI"),s=a.n(l),i=a("t4zo"),r=a.n(i),c=a("uXZL"),u=a.n(c),d={data:function(){var t,e;return{DeviceDatabaseShow:!1,StoreRoomindex:0,StoreRoom22:"请选择",DateOfDeliverys:["入公司库","入供应商库"],headerCellStyle:(t={background:"#f7f8fd",fontSize:"12px",fontWeight:400,fontStyle:"normal"},s()(t,"fontSize","11px"),s()(t,"padding","5px"),s()(t,"paddingLeft","0px"),t),headerCellStyle2:(e={background:"#f7f8fd",fontSize:"12px",fontWeight:400,fontStyle:"normal"},s()(e,"fontSize","11px"),s()(e,"padding","5px"),s()(e,"paddingLeft","0px"),s()(e,"textAlign","center"),e),cellStyle:{height:"48px",fontSize:"12px"},Id:"",MPO:{},MachinePOFiles:[],edit:!1,BelongCompanyList:["技术公司","服务公司"],PayTypeList:[{label:"付全款",value:1},{label:"分期付款",value:2},{label:"先发货后付款",value:3}],PaymentAmount:"",PaymentAmountBFB:"",drawer2:!1,options:[{value:-1,label:"全部"},{value:1,label:"制作中"},{value:2,label:"已确认"},{value:3,label:"部分发货"},{value:4,label:"全部发货"},{value:5,label:"已结单"},{value:9,label:"已撤单"}],Typeofcustomer:[{label:"全部"},{label:"宝马"},{label:"保时捷"},{label:"奥迪"},{label:"奔驰"},{label:"劳斯莱斯"},{label:"路虎"},{label:"自由市场"},{label:"其他"}],DrawerSearch:"",DrawerSaler:"",state:-1,area:"",cusType:"",tableData:[],pageNum2:1,numPerPage2:20,total2:0,MachineSOEquDtos:[],MachineSOEquDtos2:[],drawer3:!1,SeacrhEqu:"",brand:"",brands:[],DocumentIdentification:"",options2:[],received:"",CurrencySign:"",dialogVisible2:!1,column:{},MachinePOPayDtosHJ:0,MachinePOInvoiceDtosHJ:0,restaurants:[{value:"10"},{value:"30"},{value:"50"},{value:"70"},{value:"100"}],RequestRefundDialog:!1,RequestRefundData:{PayId:"",RefundAmount:0,RefundTo:"网银",Other:"",Amount:0},SaxoDrawer:!1,Subscription:0,CapitalPoolDtos:[]}},computed:{newCapitalPoolDtos:function(){return JSON.parse(o()(this.CapitalPoolDtos))}},watch:{PaymentAmountBFB:function(t){console.log(t),this.PaymentAmount=null!=t&&""!=t?(this.MPO.TotalAmount*(t/100)).toFixed(2):""},newCapitalPoolDtos:function(t){var e=this;this.Subscription=0,t.forEach(function(t){t.Number>0&&(e.Subscription+=Number(t.Number))})}},methods:{AddMSOPaymentFun:function(){var t=this;console.log(this.CapitalPoolDtos);for(var e=[],a=0;a<this.CapitalPoolDtos.length;a++){var n=this.CapitalPoolDtos[a];isNaN(parseFloat(n.Number))||e.push({ID:n.ID,SellingPrice:Number(n.Number)})}if(0==e.length)return this.$message.error("请输入使用量");console.log(e),this.API_POST("MachineSO/MpoApplyPayByBBOC",{Id:this.MPO.ID,Other:this.Subscription,Euqs:e}).then(function(e){t.$message.success("申请成功！"),t.SaxoDrawer=!1,t.start()})},applyToUseAccounts:function(){console.log("11111"),this.GetCusCapitalPool(),this.SaxoDrawer=!0},GetCusCapitalPool:function(t){var e=this;this.SaxoDrawer=!0;var a={api:"get",url:this.$store.state.http+"CRM/GetCusCapitalPool",data:{cusId:this.MPO.CusId,onlyPart:!0,includebboc:!0,includebuming:!1}};this.$https(a).then(function(t){e.CapitalPoolDtos=[];var a=t.Data,n=a.BBOCDtos,o=a.CapitalPoolDtos;null!=n&&t.Data.BBOCDtos.forEach(function(t){t.LB="挂帐款",t.CreateDate=t.CreateDate.split("T")[0],e.$set(t,"Number",""),""!=t.SystemInfo&&null!=t.SystemInfo?t.SystemInfo2=t.SystemInfo.split("@"):element.SystemInfo2=[],e.CapitalPoolDtos.push(t)}),null!=o&&o.forEach(function(t){t.LB=t.Type,t.CreateDate=t.CreateDate.split("T")[0],e.$set(t,"Number",""),""!=t.SystemInfo&&null!=t.SystemInfo?t.SystemInfo2=t.SystemInfo.split("@"):element.SystemInfo2=[],e.CapitalPoolDtos.push(t)}),console.log(e.CapitalPoolDtos)})},deleteOrder:function(){var t=this;this.$confirm("此操作将永久删除该订单, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.API_POST("MachineSO/DelMpo",{id:t.Id}).then(function(e){t.$message.success("删除成功！"),t.$router.push({path:"/machine-purchase"}),t.$emit("refresh")})}).catch(function(){t.$message.info("已取消删除")})},DwFileUrl:function(t,e){saveAs("http://icms.inchwell.com.cn"+t,e)},SubmitRedInv:function(t){var e=this;console.log(t),this.$confirm("提交冲红发票?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.API_POST("Finance/SubmitRedInv",{Id:t.ID}).then(function(t){e.$message.success("操作成功！"),e.start()})})},OperationInvoice:function(t){var e=this;this.$prompt("请输入内容","操作发票",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(a){var n=a.value;e.API_POST("Finance/ApplyHandleInvoice",{ID:t.ID,Str:n}).then(function(t){e.$message.success("操作成功"),e.start()})}).catch(function(){e.$message("取消操作发票")})},RequestRefundPrimary:function(){var t=this;if(0==this.RequestRefundData.RefundAmount)return this.$message.warning("请输入退款金额！");this.API_POST("MachineSO/MpoRefundApply",this.RequestRefundData).then(function(e){t.$message.success("申请成功！"),t.RequestRefundDialog=!1,t.start()})},RequestRefund:function(t){console.log(t),this.RequestRefundDialog=!0,this.RequestRefundData.RefundAmount=0,this.RequestRefundData.RefundTo="网银",this.RequestRefundData.Other="",this.RequestRefundData.Amount=t.Amount,this.RequestRefundData.PayId=t.ID},SeeApplyEquipment:function(t){console.log(t),this.$router.push({path:"apply-to-change-equipment-see-po",query:{ID:t.ID}})},ApplyToChangeEquipment:function(){this.$router.push({path:"/apply-to-change-equipment-mpo2",query:{Id:this.Id,From:2,EquDtos:this.MPO.MachinePOEquDtos,BuyingCurrency:this.MPO.BuyingCurrency}})},querySearch:function(t,e){var a=this.restaurants;e(t?a.filter(this.createFilter(t)):a)},createFilter:function(t){return function(e){return 0===e.value.toLowerCase().indexOf(t.toLowerCase())}},ModifyMemo:function(t){var e=this;if(void 0==t)var a=this.column;else a=t;var n={data:{Id:a.ID,UnitPrice:a.UnitPrice,POQuantity:a.POQuantity,NoSentQuantity:a.NoSentQuantity,Memo:a.Memo,StoreRoom:"入公司库"==a.StoreRoom2?1:0},api:"post",url:this.$store.state.http+"MachineSO/UpdateMPOEquPrice"};console.log(n),this.$https(n).then(function(a){e.dialogVisible2=!1,void 0==t?(e.$message({showClose:!0,message:"修改成功！",type:"success"}),e.start()):(e.columnIndex-=1,0==e.columnIndex&&(e.$message({showClose:!0,message:"批量修改备注成功！",type:"success"}),e.start()))})},CellClick:function(t,e,a,n){console.log(t,e,a,n),"备注"==e.label&&(this.column=JSON.parse(o()(t)),this.dialogVisible2=!0)},DownloadTheStorageOrder:function(t,e){console.log(t,e);for(var a="height:40px;line-height:40px;font-size:20px;font-weight: bold;",n="height:40px;line-height:40px;font-size:20px;text-align: left;",o="text-align: left;font-size:18px;",l="text-align: center;font-size:18px;",s=new Date,i="",r=0;r<t.MacPODispatchOrderGoodDtos.length;r++){for(var c=t.MacPODispatchOrderGoodDtos[r],u="",d=0;d<c.LocationInfo2.length;d++){var p=c.LocationInfo2[d];0!=d&&(u+="\n                            <tr>\n                                <td style='"+l+"'>"+p.split(",")[1]+"</td>\n                                <td style='"+l+"'>"+p.split(",")[0].split("[")[1]+"</td>\n                            </tr>\n                            ")}i+="\n                    <tr>\n                        <td rowspan='"+c.LocationInfo2.length+"' style='"+l+"'>"+(r+1)+"</td>\n                        <td rowspan='"+c.LocationInfo2.length+"' style='"+o+"'>"+c.ProductCode+"</td>\n                        <td rowspan='"+c.LocationInfo2.length+"' style='"+o+"'>"+c.Describe+"</td>\n                        <td rowspan='"+c.LocationInfo2.length+"' style='"+o+"'>"+c.Locations+"</td>\n                        <td rowspan='"+c.LocationInfo2.length+"' style='"+l+"'>"+c.DeliverQuantity+"</td>\n                        <td style='"+l+"'>"+(c.LocationInfo2.length>0?c.LocationInfo2[0].split(",")[1]:"")+"</td>\n                        <td style='"+l+"'>"+(c.LocationInfo2.length>0?c.LocationInfo2[0].split(",")[0].split("[")[1]:"")+"</td>\n                    </tr>\n\n                    ",i+=u}var h='\n\n            <html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">\n                <head>\n                <meta charset="utf-8">\n                </head>\n                <body>\n                <table border=1 style="font-family: "宋体";padding:10px">\n\n                    <tr>\n                       <th colspan=\'7\' style=\'font-size:60px;line-height:150px;height:150px;color:rgb(20,25,244)\'>\n                        北京英之杰天祥入库单</th>\n                    </tr>\n\n                    <tr>\n                       <td colspan=\'2\' style=\''+a+"'>客户名称</td>\n                       <td colspan='5' style='"+n+"'>"+this.MPO.CusFullName+"</td>\n                    </tr>\n                    <tr>\n                       <td colspan='2' style='"+a+"'>订单编号</td>\n                       <td colspan='5' style='"+n+"'>"+this.MPO.POCode+"</td>\n                    </tr>\n                    <tr>\n                       <td colspan='2' style='"+a+"'>当前日期</td>\n                       <td colspan='5' style='"+n+"'>"+s.getFullYear()+"/"+(s.getMonth()+1)+"/"+s.getDate()+" "+s.getHours()+" : "+s.getMinutes()+" </td>\n                    </tr>\n\n                    <tr style='height:60px;line-height:60px;font-size:25px;margin:0 20px'>\n                       <th>序号</th>\n                       <th>产品编码</th>\n                       <th>描述</th>\n                       <th>库存库位</th>\n                       <th>发货数量</th>\n                       <th>收货数量</th>\n                       <th>收货库位</th>\n                    </tr>\n                    "+i+"\n                </table>\n                </body>\n                </html>",v=document.createElement("a");v.download="北京英之杰天祥入库单.xls",v.href="data:application/vnd.ms-excel;base64,"+window.btoa(unescape(encodeURIComponent(h))),document.body.appendChild(v),v.click(),document.body.removeChild(v)},ShowFalse:function(t){this.DeviceDatabaseShow=t},DataBase:function(t){var e=this;console.log(t);for(var a=[],n=0;n<t.length;n++){var o=t[n];a.push({ProductId:o.ID,Number:o.Quantity})}var l={api:"post",url:this.$store.state.http+"MachineSO/AddMPOEqus",data:{Id:this.Id,Euqs:a}};this.$https(l).then(function(t){e.$message({showClose:!0,message:"添加成功!",type:"success"}),e.drawer3=!1,e.start()})},InvoiceReceived:function(){var t=this;if(console.log(this.received),""==this.received||0==this.received)return this.$message.error("请输入正确的数值！"),!1;var e={api:"post",url:this.$store.state.http+"MachineSO/AddMPOInvoice",data:{id:this.Id,Str:Number(this.received),Memo:this.MPO.Memo}};this.$https(e).then(function(e){t.$message({showClose:!0,message:"创建成功!",type:"success"}),t.start()})},deleteFun:function(t){var e=this;this.API_POST("MachineSO/DeleteMPOAtt",{ID:t.ID}).then(function(t){e.$message.success("删除成功！"),e.start()})},receive:function(t){var e=this,a={id:this.Id,FileName:t.name,FileStr:t.Base64};this.API_POST("MachineSO/UploadMPOAtt",a,!1).then(function(t){console.log(t),e.$message.success("上传成功！"),e.start()})},Manufacturer:function(){var t=this,e={url:this.$store.state.http+"System/GetBrand",api:"get"};this.$https(e).then(function(e){t.options2=e.Data;for(var a=0;a<t.options2.length;a++)t.options2[a].value=t.options2[a].Value})},Statement:function(){var t=this,e={api:"post",url:this.$store.state.http+"MachineSO/MPOClose",data:{Id:this.Id}};this.$https(e).then(function(e){t.$message({showClose:!0,message:"结单成功!",type:"success"}),t.start()})},exportData:function(t,e){var a=this,n=new FileReader;FileReader.prototype.readAsBinaryString=function(t){var n,o,l="",s=new FileReader;s.onload=function(t){for(var i=new Uint8Array(s.result),r=i.byteLength,c=0;c<r;c++)l+=String.fromCharCode(i[c]);n=u.a.read(l,{type:"binary"}),o=u.a.utils.sheet_to_json(n.Sheets[n.SheetNames[0]]),a.fillIn(o,e)},s.readAsArrayBuffer(t)},n.readAsBinaryString(t)},ChinesetoEnglish:function(t){},DownloadStorageFile:function(t){var e=u.a.utils.table_to_book(document.querySelector(t),{raw:!0});console.log(e);var a=u.a.write(e,{bookType:"xlsx",bookSST:!0,type:"array"});try{r.a.saveAs(new Blob([a],{type:"application/octet-stream"}),"入库文件.xlsx")}catch(t){"undefined"!=typeof console&&console.log(t,a)}return a},fillIn:function(t,e){var a=this,n=e.split("-")[0],l=e.split("-")[1];if(console.log(t,n,l),3==n){var s=this.MPO.MacPODispatchOrderDtos[Number(l)].MacPODispatchOrderGoodDtos;console.log(s);for(var i=0;i<s.length;i++){s[i].RuKu=[{ku:"",num:""}]}for(var r=0;r<t.length;r++)for(var c=t[r],u=0;u<s.length;u++){var d=s[u];console.log(d),d.ProductCode==c["产品编码"]&&(""==d.RuKu[0].ku&&(d.RuKu=[]),d.RuKu.push({ku:c["库位"],num:c["收货数量"]}))}return!1}if(0==t.length)return this.$message.error("表格没有数据"),!1;if(5==n){console.log(t);for(var p=[],h=0;h<t.length;h++){var v=t[h];console.log(v,v["采购单价"]),void 0!=v["产品编码"]&&void 0!=v["数量"]&&void 0!=v["采购单价"]&&(console.log(v),p.push({ProName:v["产品编码"],Number:v["数量"],SellingPrice:v["采购单价"],Other:v["备注"]}))}return 0==p.length?(this.$message.error("有效数据0条"),!1):(this.API_POST("MachineSO/AddMPOEqus2",{Id:this.Id,Euqs:p}).then(function(t){a.$message({message:"添加成功",type:"success"}),a.start()}),!1)}p=[];for(var m=0;m<t.length;m++){var f=t[m];f["采购单号"]==this.MPO.POCode&&(console.log(f),p.push(f))}if(0==p.length&&4!=Number(n))return this.$message.error("表格没有跟当前采购单匹配的数据"),!1;if(1==n)for(var _=0;_<p.length;_++)for(var b=p[_],y=0;y<this.MPO.MachinePOEquDtos.length;y++){var S=this.MPO.MachinePOEquDtos[y];console.log(S),S.ProductCode==b["设备编码"]&&(S.FHQuantity=b["发货/确认数量"])}if(2==n)for(var g=this.MPO.MacPODispatchOrderDtos[Number(l)].MacPODispatchOrderGoodDtos,P=0;P<p.length;P++)for(var O=p[P],w=0;w<g.length;w++){var M=g[w];console.log(M),M.ProductCode==O["设备编码"]&&(M.ConfirmQuantity=O["发货/确认数量"])}if(4==Number(n)){console.log("修改备注文件");var C=[];return t.forEach(function(t){var e=t["产品编码"];a.MPO.MachinePOEquDtos.forEach(function(a){if(a.ProductCode==e){var n=JSON.parse(o()(a));n.Memo=t["备注"],C.push(n)}})}),0==C.length?(this.$message.error("未查询到匹配的产品编码"),!1):(console.log(C),this.columnIndex=C.length,C.forEach(function(t){a.ModifyMemo(t)}),!1)}},getFile:function(t,e,a){var n=t.target.files[0];console.log(e,a);var o=e+"-"+a;this.exportData(n,o),t.target.value=""},ExcelUP:function(){},download:function(t){window.open("http://erp.inchwell.com.cn/mould/document/download/"+t+".xls")},SeacrhEquFun:function(){var t=this;if(""===this.SeacrhEqu&&""===this.brand)return this.MachineSOEquDtos=this.MachineSOEquDtos2,!1;var e=[];this.MachineSOEquDtos2.map(function(a){if(""!=t.brand&&(console.log(t.brand,a.Brand),a.Brand!=t.brand))return!1;if((console.log(t.brand),""!=t.SeacrhEqu)&&-1==(a.ProductCode+a.LongCode+a.Describe).indexOf(t.SeacrhEqu))return!1;e.push(a)}),this.MachineSOEquDtos=e},AddToCheck:function(){for(var t=this,e=[],a=this.$refs.HeTong2.selection,n=0;n<a.length;n++){var o=a[n];e.push({ProductId:o.ProductId,Number:o.Quantity})}var l={api:"post",url:this.$store.state.http+"MachineSO/AddMPOEqus",data:{Id:this.Id,Euqs:e}};this.$https(l).then(function(e){t.$message({showClose:!0,message:"添加成功!",type:"success"}),t.drawer3=!1,t.start()})},AddTo:function(t){var e=this;console.log(t);var a={api:"post",url:this.$store.state.http+"MachineSO/AddMPOEqus",data:{Id:this.Id,Euqs:[{ProductId:t.ProductId,Number:t.Quantity}]}};this.$https(a).then(function(t){e.$message({showClose:!0,message:"添加成功!",type:"success"}),e.drawer3=!1,e.start()})},Check:function(t){var e=this,a={data:{msoId:t.ID},api:"get",url:this.$store.state.http+"MachineSO/GetMSO"};this.$https(a).then(function(t){e.MachineSOEquDtos=t.Data.MSO.MachineSOEquDtos,e.MachineSOEquDtos2=t.Data.MSO.MachineSOEquDtos,console.log(e.MachineSOEquDtos),e.drawer3=!0,e.brands=[];for(var a=0;a<e.MachineSOEquDtos.length;a++){for(var n=e.MachineSOEquDtos[a].Brand,o=!0,l=0;l<e.brands.length;l++){e.brands[l].label==n&&(o=!1)}o&&e.brands.push({value:n,label:n})}console.log(e.brands)})},pageFun:function(t,e){this.numPerPage2=t,this.pageNum2=e,this.DrawerSearchFun()},DrawerSearchFun:function(){var t=this;if(""==this.cusType||"全部"==this.cusType)var e="";else e=this.cusType;var a={data:{search:this.DrawerSearch,area:this.area,state:this.state||-1,cusType:e,saler:this.DrawerSaler,pageNum:this.pageNum2,numPerPage:this.numPerPage2,orderField:"",orderDirection:""},api:"get",url:this.$store.state.http+"MachineSO/GetMSOs"};this.$https(a).then(function(e){console.log(e),t.tableData=e.Data.Dtos,t.total2=e.Data.DataBars})},ReceiveQuantityFun:function(t){var e=this;console.log(t);for(var a=[],n=0;n<t.length;n++)for(var o=t[n],l=0;l<o.RuKu.length;l++){var s=o.RuKu[l];s.num&&s.ku&&a.push({Id:o.ID,Number:Number(s.num),Other:s.ku})}var i={};if(i.Id=t[0].MacPODispatchOrderId,i.Euqs=a,0==i.Euqs.length)return this.$message.error("请输入入库的数量与库位!");this.API_POST("MachineSO/MPOReceiveGoods",i).then(function(t){e.$message.success("入库成功!"),e.start()})},ConfirmQuantityFun:function(t){var e=this;console.log(t);for(var a=[],n=0;n<t.length;n++){var o=t[n];a.push({Id:o.ID,Number:Number(o.ConfirmQuantity)})}var l={data:{Id:t[0].MacPODispatchOrderId,Euqs:a},api:"post",url:this.$store.state.http+"MachineSO/MPOConfirmGoods"};this.$https(l).then(function(t){e.$message({showClose:!0,message:"修改成功!",type:"success"}),e.start()})},Ship:function(){var t=this;console.log(this.MPO.MachinePOEquDtos);for(var e=[],a=0;a<this.MPO.MachinePOEquDtos.length;a++){var n=this.MPO.MachinePOEquDtos[a];""!=n.FHQuantity&&(console.log(n),e.push(n))}if(0==e.length)return this.$message({showClose:!0,message:"请输入正确的数量!",type:"warning"}),!1;for(var o=[],l=0;l<e.length;l++){var s=e[l];console.log(s),o.push({Id:s.ID,Number:Number(s.FHQuantity)})}var i={data:{Id:this.Id,Euqs:o},api:"post",url:this.$store.state.http+"MachineSO/MPODeliverGoods"};this.$https(i).then(function(e){t.$message({showClose:!0,message:"发货成功！",type:"success"}),t.start()})},PaymentAmountClick:function(){var t=this;if(console.log(this.PaymentAmount),""===this.PaymentAmount.trim())this.$message({showClose:!0,message:"请输入正确的金额!",type:"warning"});else{var e={data:{Id:this.Id,Other:this.MPO.Memo,Str:this.PaymentAmount},api:"post",url:this.$store.state.http+"MachineSO/AddMPOPay"};this.$https(e).then(function(e){t.$message({showClose:!0,message:"已申请！",type:"success"}),t.start()})}},MPOApproval:function(t){var e=this,a={data:{Id:this.Id,Other:this.MPO.Memo,Str:t},api:"post",url:this.$store.state.http+"MachineSO/MPOApproval"};this.$https(a).then(function(t){e.start()})},MPOSubmitForManager:function(t){var e=this,a={data:{Id:this.Id,Other:this.MPO.Memo,Str:t},api:"post",url:this.$store.state.http+"MachineSO/MPOSubmitForManager"};this.$https(a).then(function(t){e.start()})},MPOSubmitForVerify:function(){var t=this,e={data:{Id:this.Id,Other:this.MPO.Memo},api:"post",url:this.$store.state.http+"MachineSO/MPOSubmitForVerify"};this.$https(e).then(function(e){t.start()})},editFun:function(t){var e=this;if(this.edit=!this.edit,t){var a={Id:this.Id,BelongCompany:this.MPO.BelongCompany,PayType:this.MPO.PayType,StorageCost:this.MPO.StorageCost,LogisticsCost:this.MPO.LogisticsCost,RebateCost:this.MPO.RebateCost,Memo:this.MPO.Memo,CusLinkMan:this.MPO.CusLinkMan,POCode:this.MPO.POCode};this.API_POST("MachineSO/SaveMPOEqu",a).then(function(t){e.$message.success("保存成功！"),e.start()})}else this.start()},DeleteStorageLocation:function(t,e,a){for(var n=this.MPO.MacPODispatchOrderDtos[t].MacPODispatchOrderGoodDtos,o=0;o<n.length;o++){var l=n[o];l.ID==e&&l.RuKu.splice(a,1)}},AddStorageLocation:function(t,e){for(var a=this.MPO.MacPODispatchOrderDtos[t].MacPODispatchOrderGoodDtos,n=0;n<a.length;n++){var o=a[n];o.ID==e&&o.RuKu.push({num:"",ku:""})}},UpdateMPOEquPriceFun:function(){this.StoreRoomindex=0;for(var t=0;t<this.MPO.MachinePOEquDtos.length;t++){this.MPO.MachinePOEquDtos[t].StoreRoom2=this.StoreRoom22}for(var e=0;e<this.MPO.MachinePOEquDtos.length;e++){var a=this.MPO.MachinePOEquDtos[e];this.UpdateMPOEquPrice(a,99)}},UpdateNoSentQuantity:function(t,e,a){var n=this,o=t.NoSentQuantity;"Del"==e&&(o-=1),"Add"==e&&(o+=1),"saxo"==e&&(o=a);var l={data:{Id:t.ID,UnitPrice:t.UnitPrice,NoSentQuantity:o,POQuantity:t.POQuantity,Memo:t.Memo,StoreRoom:"入公司库"==t.StoreRoom2?1:0},api:"post",url:this.$store.state.http+"MachineSO/UpdateMPOEquPrice"};console.log(l),this.$https(l).then(function(t){if(99==e)return n.StoreRoomindex+=1,n.StoreRoomindex==n.MPO.MachinePOEquDtos.length&&n.$message({showClose:!0,message:"修改成功！",type:"success"}),n.start(),!1;n.$message({showClose:!0,message:"修改成功！",type:"success"}),n.start()})},UpdateMPOEquPrice:function(t,e,a){var n=this,o=t.POQuantity;"Del"==e&&(o-=1),"Add"==e&&(o+=1),"saxo"==e&&(o=a);var l={data:{Id:t.ID,UnitPrice:t.UnitPrice,POQuantity:o,StoreRoom:"入公司库"==t.StoreRoom2?1:0},api:"post",url:this.$store.state.http+"MachineSO/UpdateMPOEquPrice"};console.log(l),this.$https(l).then(function(t){if(99==e)return n.StoreRoomindex+=1,n.StoreRoomindex==n.MPO.MachinePOEquDtos.length&&n.$message({showClose:!0,message:"修改成功！",type:"success"}),n.start(),!1;n.$message({showClose:!0,message:"修改成功！",type:"success"}),n.start()})},start:function(){var t=this,e={data:{mpoId:this.Id},api:"get",url:this.$store.state.http+"MachineSO/GetMPO"};this.$https(e).then(function(e){console.log(e.Data),t.MachinePOFiles=e.Data.MachinePOFiles,console.log(t.MachinePOFiles),t.MPO=e.Data.MPO;[{abbreviation:"RMB",sign:"¥"},{abbreviation:"USD",sign:"$"},{abbreviation:"EUR",sign:"€"},{abbreviation:"GBP",sign:"￡"},{abbreviation:"JPY",sign:"¥"}].forEach(function(e){t.MPO.BuyingCurrency==e.abbreviation&&(t.CurrencySign=e.sign+" ")});for(var a=0;a<t.MPO.MachinePOEquDtos.length;a++){var n=t.MPO.MachinePOEquDtos[a];t.$set(n,"FHQuantity",""),n.StoreRoom2=1==n.StoreRoom?"入公司库":"入供应商库"}for(var o=0;o<t.MPO.MacPODispatchOrderDtos.length;o++){var l=t.MPO.MacPODispatchOrderDtos[o];t.$set(l,"NumberOfSpecies",l.MacPODispatchOrderGoodDtos.length),t.$set(l,"number99",0),t.$set(l,"numberCai",0),t.$set(l,"numberKu",0);for(var s=0;s<l.MacPODispatchOrderGoodDtos.length;s++){var i=l.MacPODispatchOrderGoodDtos[s];t.$set(i,"RuKu",[{num:"",ku:""}]),l.number99+=i.DeliverQuantity,l.numberCai+=i.ConfirmQuantity,l.numberKu+=i.ReceiveQuantity,t.$set(i,"LocationInfo2",(i.LocationInfo||"").split("]").slice(0,-1))}}t.MachinePOPayDtosHJ=0;for(var r=0;r<t.MPO.MachinePOPayDtos.length;r++){var c=t.MPO.MachinePOPayDtos[r];console.log(c),"已驳回"!=c.PayStateStr&&(t.MachinePOPayDtosHJ+=c.Amount),c.AuditorA&&(c.AuditorA=c.AuditorA.split("/")[0].slice(0,c.AuditorA.split("/")[0].length-4)),c.AuditorB&&(c.AuditorB=c.AuditorB.split("/")[0].slice(0,c.AuditorB.split("/")[0].length-4)),c.AuditorC&&(c.AuditorC=c.AuditorC.split("/")[0].slice(0,c.AuditorC.split("/")[0].length-4)),c.AuditorD&&(c.AuditorD=c.AuditorD.split("/")[0].slice(0,c.AuditorD.split("/")[0].length-4))}t.MachinePOInvoiceDtosHJ=0;for(var u=0;u<t.MPO.MachinePOInvoiceDtos.length;u++){var d=t.MPO.MachinePOInvoiceDtos[u];"发票已作废"!=d.InvoiceStateStr&&(t.MachinePOInvoiceDtosHJ+=d.Amount)}console.log(t.MachinePOInvoiceDtosHJ),console.log(t.MPO)})},dele:function(t){var e=this;console.log(t);var a={api:"post",url:this.$store.state.http+"MachineSO/DelMPOEqu",data:{Id:t.ID}};this.$https(a).then(function(t){e.$message({message:"删除成功",type:"success"}),e.start()})}},created:function(){this.Id=this.$route.query.Id,this.pagesize3=this.$store.state.DisplayNumber,this.start(),this.Manufacturer()},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){this.$emit("refresh")},destroyed:function(){},activated:function(){}},p={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"box_s"},[a("router-view",{on:{refresh:t.start}}),t._v(" "),a("div",{staticClass:"retrieve"},[a("span",{staticClass:"leftSpan"},[t._v("编辑零配件采购")]),t._v(" "),1!=t.MPO.State&&2!=t.MPO.State||t.edit?t._e():a("saxo-button",{staticClass:"butState",attrs:{mini:"",type:"primary"},on:{click:function(e){t.edit=!t.edit}}},[t._v("编辑")]),t._v(" "),1!=t.MPO.State&&2!=t.MPO.State||!t.edit?t._e():a("saxo-button",{staticClass:"butState",attrs:{mini:"",type:"success"},on:{click:function(e){return t.editFun(!0)}}},[t._v("保存")]),t._v(" "),1!=t.MPO.State&&2!=t.MPO.State||!t.edit?t._e():a("saxo-button",{staticClass:"butState",attrs:{mini:"",type:"danger"},on:{click:function(e){return t.editFun(!1)}}},[t._v("放弃")]),t._v(" "),1==t.MPO.State?a("saxo-button",{staticClass:"butState",attrs:{mini:"",plain:"",type:"info"},on:{click:function(e){return t.MPOSubmitForVerify()}}},[t._v("提交预审批")]):t._e(),t._v(" "),2==t.MPO.State?a("saxo-button",{staticClass:"butState",attrs:{mini:"",plain:"",type:"primary"},on:{click:function(e){return t.MPOApproval(1)}}},[t._v("批准采购")]):t._e(),t._v(" "),2==t.MPO.State?a("saxo-button",{staticClass:"butState",attrs:{mini:"",plain:"",type:"danger"},on:{click:function(e){return t.MPOApproval(0)}}},[t._v("驳回采购")]):t._e(),t._v(" "),8==t.MPO.State?a("saxo-button",{staticClass:"butState",attrs:{mini:"",plain:"",type:"primary"},on:{click:function(e){return t.MPOSubmitForManager(1)}}},[t._v("部门经理批准采购")]):t._e(),t._v(" "),8==t.MPO.State?a("saxo-button",{staticClass:"butState",attrs:{mini:"",plain:"",type:"danger"},on:{click:function(e){return t.MPOSubmitForManager(0)}}},[t._v("部门经理驳回采购")]):t._e(),t._v(" "),t.MPO.AllowClose?a("saxo-button",{staticClass:"butState",attrs:{mini:"",type:"primary"},on:{click:function(e){return t.Statement()}}},[t._v("结单")]):t._e(),t._v(" "),1==t.MPO.State?a("saxo-button",{staticClass:"butState",attrs:{mini:"",type:"danger"},on:{click:function(e){return t.deleteOrder()}}},[t._v("删除")]):t._e()],1),t._v(" "),a("div",{staticClass:"Con"},[t.MPO.CreateDateStr?t._e():a("div",{staticClass:"el-descriptions__title"},[t._v("基础信息")]),t._v(" "),t.MPO.CreateDateStr?t._e():a("br"),t._v(" "),t.MPO.CreateDateStr?t._e():a("el-skeleton",{attrs:{rows:6,animated:""}}),t._v(" "),a("el-descriptions",{staticClass:"margin-top",attrs:{title:"基础信息",column:3,size:"mini",border:""}},[a("template",{slot:"extra"}),t._v(" "),a("el-descriptions-item",[a("template",{slot:"label"},[t._v("\n                       创建时间\n                   ")]),t._v("\n                   "+t._s("  "+t.MPO.CreateDateStr)+"\n               ")],2),t._v(" "),a("el-descriptions-item",[a("template",{slot:"label"},[a("i",{staticClass:"el-icon-mobile-phone"}),t._v("\n                       采购单编号\n                   ")]),t._v(" "),t.edit?t._e():a("span",[t._v(t._s("  "+t.MPO.POCode))]),t._v(" "),t.edit?a("el-input",{staticStyle:{width:"192px"},attrs:{size:"mini",placeholder:"请输入内容"},model:{value:t.MPO.POCode,callback:function(e){t.$set(t.MPO,"POCode",e)},expression:"MPO.POCode"}}):t._e()],2),t._v(" "),a("el-descriptions-item",[a("template",{slot:"label"},[a("i",{staticClass:"el-icon-location-outline"}),t._v("\n                       供应商\n                   ")]),t._v("\n                   "+t._s("  "+t.MPO.CusFullName)+"\n\n               ")],2),t._v(" "),a("el-descriptions-item",[a("template",{slot:"label"},[a("i",{staticClass:"el-icon-tickets"}),t._v("\n                       采购员\n                   ")]),t._v("\n                   "+t._s("  "+t.MPO.Buyer)+"\n               ")],2),t._v(" "),t.edit?t._e():a("el-descriptions-item",[a("template",{slot:"label"},[a("i",{staticClass:"el-icon-office-building"}),t._v("\n                       隶属公司\n                   ")]),t._v("\n                   "+t._s("  "+t.MPO.BelongCompany)+"\n               ")],2),t._v(" "),t.edit?a("el-descriptions-item",[a("template",{slot:"label"},[a("i",{staticClass:"el-icon-office-building"}),t._v("\n                       隶属公司\n                   ")]),t._v(" "),a("el-select",{attrs:{placeholder:"请选择",size:"mini"},model:{value:t.MPO.BelongCompany,callback:function(e){t.$set(t.MPO,"BelongCompany",e)},expression:"MPO.BelongCompany"}},t._l(t.BelongCompanyList,function(t){return a("el-option",{key:t,attrs:{label:t,value:t}})}),1)],2):t._e(),t._v(" "),t.edit?t._e():a("el-descriptions-item",[a("template",{slot:"label"},[a("i",{staticClass:"el-icon-office-building"}),t._v("\n                       付款方式\n                   ")]),t._v(" "),1==t.MPO.PayType?a("span",[t._v("  付全款")]):t._e(),t._v(" "),2==t.MPO.PayType?a("span",[t._v("  分期付款")]):t._e(),t._v(" "),3==t.MPO.PayType?a("span",[t._v("  先发货后付款")]):t._e()],2),t._v(" "),t.edit?a("el-descriptions-item",[a("template",{slot:"label"},[a("i",{staticClass:"el-icon-office-building"}),t._v("\n                       付款方式\n                   ")]),t._v(" "),a("el-select",{attrs:{placeholder:"请选择",size:"mini"},model:{value:t.MPO.PayType,callback:function(e){t.$set(t.MPO,"PayType",e)},expression:"MPO.PayType"}},t._l(t.PayTypeList,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],2):t._e(),t._v(" "),a("el-descriptions-item",[a("template",{slot:"label"},[a("i",{staticClass:"el-icon-office-building"}),t._v("\n                       付款状态\n                   ")]),t._v("\n                   "+t._s("  "+t.MPO.PayStateStr)+"\n               ")],2),t._v(" "),a("el-descriptions-item",[a("template",{slot:"label"},[a("i",{staticClass:"el-icon-office-building"}),t._v("\n                       状态\n                   ")]),t._v("\n                   "+t._s("  "+t.MPO.StateStr)+"\n               ")],2)],2),t._v(" "),a("br"),t._v(" "),a("div",{staticClass:"el-descriptions__title"},[t._v("设备清单\n               "),t._v(" "),t.MPO.State<3?a("saxo-button",{staticStyle:{float:"right","margin-right":"10px"},attrs:{mini:"",type:"success"},on:{click:function(e){return t.ShowFalse(!0)}}},[t._v("添加")]):t._e(),t._v(" "),-1!=[3,4,5,6].indexOf(t.MPO.State)?a("saxo-button",{staticStyle:{float:"right","margin-right":"10px"},attrs:{mini:"",type:"success"},on:{click:function(e){return t.Ship()}}},[t._v("供应商发货")]):t._e(),t._v(" "),-1!=[3,4,5,6].indexOf(t.MPO.State)?a("el-button",{staticStyle:{float:"right",background:"#01000000",border:"none",color:"#67C23A",cursor:"default"},attrs:{type:"success",size:"mini"}},[a("label",{attrs:{for:"int"}},[a("i",{staticClass:"el-icon-upload2"}),t._v("\n                       上传发货文件\n                   ")]),t._v(" "),a("input",{ref:"referenceUpload",staticStyle:{"margin-left":"70px",display:"none"},attrs:{id:"int",type:"file",accept:".xlsx, .xls"},on:{change:function(e){return t.getFile(e,1)}}})]):t._e(),t._v(" "),1==t.MPO.State||2==t.MPO.State?a("el-button",{staticStyle:{float:"right",background:"#01000000",border:"none",color:"#67C23A",cursor:"default"},attrs:{type:"success",size:"mini"}},[a("label",{attrs:{for:"int2"}},[a("i",{staticClass:"el-icon-upload2"}),t._v("\n                       上传备注表\n                   ")]),t._v(" "),a("input",{ref:"referenceUpload",staticStyle:{"margin-left":"70px",display:"none"},attrs:{id:"int2",type:"file",accept:".xlsx, .xls"},on:{change:function(e){return t.getFile(e,4)}}})]):t._e(),t._v(" "),1==t.MPO.State||2==t.MPO.State?a("el-link",{staticStyle:{float:"right","font-size":"12px","line-height":"28px"},attrs:{href:"http://erp.inchwell.com.cn/mould/document/download/整机采购批量修改设备备注模板.xlsx",type:"primary",underline:!1}},[a("i",{staticClass:"el-icon-download"}),t._v("\n                   下载修改备注表\n               ")]):t._e(),t._v(" "),1==t.MPO.State||2==t.MPO.State?a("el-button",{staticStyle:{float:"right",background:"#01000000",border:"none",color:"#67C23A",cursor:"default"},attrs:{type:"success",size:"mini"}},[a("label",{attrs:{for:"int3"}},[a("i",{staticClass:"el-icon-upload2"}),t._v("\n                       上传批量导入设备表\n                   ")]),t._v(" "),a("input",{ref:"referenceUpload",staticStyle:{"margin-left":"70px",display:"none"},attrs:{id:"int3",type:"file",accept:".xlsx, .xls"},on:{change:function(e){return t.getFile(e,5)}}})]):t._e(),t._v(" "),1==t.MPO.State||2==t.MPO.State?a("el-link",{staticStyle:{float:"right","font-size":"12px","line-height":"28px"},attrs:{href:"http://erp.inchwell.com.cn/mould/document/download/采购批量导入设备.xlsx",type:"primary",underline:!1}},[a("i",{staticClass:"el-icon-download"}),t._v("\n                   下载批量导入设备表\n               ")]):t._e()],1),t._v(" "),a("DeviceDatabase",{attrs:{show:t.DeviceDatabaseShow,protype:"1"},on:{ShowFalse:t.ShowFalse,DataBase:t.DataBase}}),t._v(" "),a("br"),t._v(" "),t.edit?t._e():a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.MPO.MachinePOEquDtos,"header-cell-style":t.headerCellStyle2,"cell-style":t.cellStyle,stripe:""}},[a("el-table-column",{attrs:{label:"序号",type:"index",width:"50"}}),t._v(" "),a("el-table-column",{attrs:{prop:"ProductCode",label:"产品编码",width:"150"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Describe",label:"描述","show-overflow-tooltip":!0}}),t._v(" "),a("el-table-column",{attrs:{label:"采购中",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                       "+t._s(e.row.NetInventory.split("*")[0])+"\n                   ")]}}],null,!1,2602364009)}),t._v(" "),a("el-table-column",{attrs:{label:"在途",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                       "+t._s(e.row.NetInventory.split("*")[1])+"\n                   ")]}}],null,!1,2611328040)}),t._v(" "),a("el-table-column",{attrs:{label:"在库",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                       "+t._s(e.row.NetInventory.split("*")[2])+"\n                   ")]}}],null,!1,2884807915)}),t._v(" "),a("el-table-column",{attrs:{label:"销售量",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                       "+t._s(e.row.NetInventory.split("*")[3])+"\n                   ")]}}],null,!1,433918378)}),t._v(" "),a("el-table-column",{attrs:{label:"净库存",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                       "+t._s(e.row.NetInventory.split("*")[4])+"\n                   ")]}}],null,!1,960072557)}),t._v(" "),a("el-table-column",{attrs:{label:"采购单价",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{float:"right"}},[t._v(t._s(t.CurrencySign+e.row.UnitPrice.toFixed(2)))])]}}],null,!1,2427540817)}),t._v(" "),a("el-table-column",{attrs:{label:"库房",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticStyle:{"text-align":"center"}},[t._v(t._s(e.row.StoreRoom2))])]}}],null,!1,1698638614)}),t._v(" "),a("el-table-column",{attrs:{label:"数量",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticStyle:{"text-align":"center"}},[t._v(t._s(e.row.POQuantity))])]}}],null,!1,496730816)}),t._v(" "),a("el-table-column",{attrs:{label:"累计发货",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticStyle:{"text-align":"center"}},[t._v(t._s(e.row.DeliverQuantity))])]}}],null,!1,1637156218)}),t._v(" "),a("el-table-column",{attrs:{label:"不发货量",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticStyle:{"text-align":"center"}},[t._v(t._s(e.row.NoSentQuantity))])]}}],null,!1,1272038066)}),t._v(" "),a("el-table-column",{attrs:{label:"备注",width:"150","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                       "+t._s(e.row.Memo||"无")+"\n                   ")]}}],null,!1,2602325367)}),t._v(" "),-1!=[3,4,5,6].indexOf(t.MPO.State)?a("el-table-column",{attrs:{label:"发货数量",fixed:"right",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{attrs:{size:"mini",placeholder:"发货"},model:{value:e.row.FHQuantity,callback:function(a){t.$set(e.row,"FHQuantity",a)},expression:"scope.row.FHQuantity"}})]}}],null,!1,3013784659)}):t._e()],1),t._v(" "),t.edit?a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.MPO.MachinePOEquDtos,"header-cell-style":t.headerCellStyle2,"cell-style":t.cellStyle,stripe:""},on:{"cell-click":t.CellClick}},[a("el-table-column",{attrs:{label:"序号",type:"index",width:"50"}}),t._v(" "),a("el-table-column",{attrs:{prop:"ProductCode",label:"产品编码",width:"150"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Describe",label:"描述","show-overflow-tooltip":!0}}),t._v(" "),a("el-table-column",{attrs:{label:"采购中",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                       "+t._s(e.row.NetInventory.split("*")[0])+"\n                   ")]}}],null,!1,2602364009)}),t._v(" "),a("el-table-column",{attrs:{label:"在途",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                       "+t._s(e.row.NetInventory.split("*")[1])+"\n                   ")]}}],null,!1,2611328040)}),t._v(" "),a("el-table-column",{attrs:{label:"在库",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                       "+t._s(e.row.NetInventory.split("*")[2])+"\n                   ")]}}],null,!1,2884807915)}),t._v(" "),a("el-table-column",{attrs:{label:"销售量",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                       "+t._s(e.row.NetInventory.split("*")[3])+"\n                   ")]}}],null,!1,433918378)}),t._v(" "),a("el-table-column",{attrs:{label:"净库存",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                       "+t._s(e.row.NetInventory.split("*")[4])+"\n                   ")]}}],null,!1,960072557)}),t._v(" "),a("el-table-column",{attrs:{label:"采购单价",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{staticStyle:{width:"100%"},attrs:{size:"mini",placeholder:"申请发货数量"},on:{change:function(a){return t.UpdateMPOEquPrice(e.row)}},model:{value:e.row.UnitPrice,callback:function(a){t.$set(e.row,"UnitPrice",a)},expression:"scope.row.UnitPrice"}})]}}],null,!1,1389815467)}),t._v(" "),a("el-table-column",{attrs:{prop:"handle",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-select",{ref:"selectAppType",staticStyle:{"max-width":"140px"},attrs:{placeholder:"请选择",size:"mini"},on:{change:function(a){return t.UpdateMPOEquPrice(e.row)}},model:{value:e.row.StoreRoom2,callback:function(a){t.$set(e.row,"StoreRoom2",a)},expression:"scope.row.StoreRoom2"}},t._l(t.DateOfDeliverys,function(t){return a("el-option",{key:t,attrs:{label:t,value:t}})}),1)]}}],null,!1,2947797743)},[a("template",{slot:"header"},[a("el-select",{staticStyle:{"max-width":"140px"},attrs:{placeholder:"请选择",size:"mini"},on:{change:function(e){return t.UpdateMPOEquPriceFun()}},model:{value:t.StoreRoom22,callback:function(e){t.StoreRoom22=e},expression:"StoreRoom22"}},t._l(t.DateOfDeliverys,function(t){return a("el-option",{key:t,attrs:{label:t,value:t}})}),1)],1)],2),t._v(" "),a("el-table-column",{attrs:{label:"数量",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{attrs:{id:"Number_input"}},[a("div",{staticClass:"div_icon_text",on:{click:function(a){return t.UpdateMPOEquPrice(e.row,"Del")}}},[a("i",{staticClass:"el-icon-minus"})]),t._v(" "),a("div",{staticClass:"div_icon_textConter"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.row.POQuantity,expression:"scope.row.POQuantity"}],staticStyle:{"text-align":"center","border-style":"none",outline:"none",width:"100%"},attrs:{type:"text",name:"",id:""},domProps:{value:e.row.POQuantity},on:{blur:function(a){return t.UpdateMPOEquPrice(e.row,"saxo",e.row.POQuantity)},input:function(a){a.target.composing||t.$set(e.row,"POQuantity",a.target.value)}}})]),t._v(" "),a("div",{staticClass:"div_icon_text",on:{click:function(a){return t.UpdateMPOEquPrice(e.row,"Add")}}},[a("i",{staticClass:"el-icon-plus"})])])]}}],null,!1,2812734178)}),t._v(" "),a("el-table-column",{attrs:{label:"累计发货",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticStyle:{"text-align":"center"}},[t._v(t._s(e.row.DeliverQuantity))])]}}],null,!1,1637156218)}),t._v(" "),a("el-table-column",{attrs:{label:"不发货量",width:"130"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{attrs:{id:"Number_input"}},[a("div",{staticClass:"div_icon_text",on:{click:function(a){return t.UpdateNoSentQuantity(e.row,"Del")}}},[a("i",{staticClass:"el-icon-minus"})]),t._v(" "),a("div",{staticClass:"div_icon_textConter"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.row.NoSentQuantity,expression:"scope.row.NoSentQuantity"}],staticStyle:{"text-align":"center","border-style":"none",outline:"none",width:"100%"},attrs:{type:"text",name:"",id:""},domProps:{value:e.row.NoSentQuantity},on:{blur:function(a){return t.UpdateNoSentQuantity(e.row,"saxo",e.row.NoSentQuantity)},input:function(a){a.target.composing||t.$set(e.row,"NoSentQuantity",a.target.value)}}})]),t._v(" "),a("div",{staticClass:"div_icon_text",on:{click:function(a){return t.UpdateNoSentQuantity(e.row,"Add")}}},[a("i",{staticClass:"el-icon-plus"})])])]}}],null,!1,1729286808)}),t._v(" "),a("el-table-column",{attrs:{label:"备注",width:"150","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{color:"#409EFF"}},[t._v(t._s(e.row.Memo||"无")+" ")])]}}],null,!1,2039781666)}),t._v(" "),a("el-table-column",{attrs:{label:"操作",fixed:"right",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("saxo-button",{attrs:{mini:"",type:"danger"},on:{click:function(a){return t.dele(e.row)}}},[t._v("删除")])]}}],null,!1,1691880002)})],1):t._e(),t._v(" "),a("br"),t._v(" "),t.edit?t._e():a("el-descriptions",[void 0!=t.MPO.StorageCost?a("el-descriptions-item",{attrs:{label:"仓储费用"}},[t._v(t._s(t.CurrencySign+t.MPO.StorageCost.toFixed(2)))]):t._e(),t._v(" "),void 0!=t.MPO.LogisticsCost?a("el-descriptions-item",{attrs:{label:"物流费用"}},[t._v(t._s(t.CurrencySign+t.MPO.LogisticsCost.toFixed(2)))]):t._e(),t._v(" "),void 0!=t.MPO.RebateCost?a("el-descriptions-item",{attrs:{label:"返利金额"}},[t._v(t._s(t.CurrencySign+t.MPO.RebateCost.toFixed(2)))]):t._e(),t._v(" "),void 0!=t.MPO.TotalAmount?a("el-descriptions-item",{attrs:{label:"合计金额"}},[t._v(t._s(t.CurrencySign+t.MPO.TotalAmount.toFixed(2)))]):t._e(),t._v(" "),void 0!=t.MPO.TotalAmountRMB?a("el-descriptions-item",{attrs:{label:"人民币合计"}},[t._v(t._s(t.CurrencySign+t.MPO.TotalAmountRMB.toFixed(2)))]):t._e()],1),t._v(" "),t.edit?a("el-descriptions",[a("el-descriptions-item",{attrs:{label:"仓储费用"}},[a("el-input",{staticStyle:{width:"100px"},attrs:{size:"mini",placeholder:"仓储费用"},model:{value:t.MPO.StorageCost,callback:function(e){t.$set(t.MPO,"StorageCost",e)},expression:"MPO.StorageCost"}})],1),t._v(" "),a("el-descriptions-item",{attrs:{label:"物流费用"}},[a("el-input",{staticStyle:{width:"100px"},attrs:{size:"mini",placeholder:"物流费用"},model:{value:t.MPO.LogisticsCost,callback:function(e){t.$set(t.MPO,"LogisticsCost",e)},expression:"MPO.LogisticsCost"}})],1),t._v(" "),a("el-descriptions-item",{attrs:{label:"返利金额"}},[a("el-input",{staticStyle:{width:"100px"},attrs:{size:"mini",placeholder:"返利金额"},model:{value:t.MPO.RebateCost,callback:function(e){t.$set(t.MPO,"RebateCost",e)},expression:"MPO.RebateCost"}})],1),t._v(" "),void 0!=t.MPO.TotalAmount?a("el-descriptions-item",{attrs:{label:"合计金额"}},[t._v(t._s(t.CurrencySign+t.MPO.TotalAmount.toFixed(2)))]):t._e(),t._v(" "),void 0!=t.MPO.TotalAmountRMB?a("el-descriptions-item",{attrs:{label:"人民币合计"}},[t._v(t._s(t.CurrencySign+t.MPO.TotalAmountRMB.toFixed(2)))]):t._e()],1):t._e(),t._v(" "),a("br"),t._v(" "),-1!=[3,4,5,6].indexOf(t.MPO.State)?a("div",{staticClass:"el-descriptions__title"},[t._v("收货清单\n\n               "),a("el-link",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:function(e){return t.download("发货清单模板")}}},[t._v("\n                   下载发货清单模板\n                   "),a("i",{staticClass:"el-icon-download"})]),t._v(" "),a("span",{staticStyle:{float:"right",visibility:"hidden"}},[t._v("\n                   占位\n               ")]),t._v(" "),a("el-link",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:function(e){return t.download("物流收货模板")}}},[t._v("\n                   下载物流收货模板\n                   "),a("i",{staticClass:"el-icon-download"})])],1):t._e(),t._v(" "),a("br"),t._v(" "),a("el-collapse",t._l(t.MPO.MacPODispatchOrderDtos,function(e,n){return a("el-collapse-item",{key:n,attrs:{title:"第 "+(n+1)+" 次发货       共"+e.NumberOfSpecies+"种       共"+e.number99+"件       确认到货"+e.numberCai+"       物流收货"+e.numberKu+"      "+e.CreateDate.split("T")[0],name:n}},[a("template",{slot:"title"},[a("div",[a("span",[t._v("第"+t._s(n+1)+" 次发货")]),t._v(" \n                           "),a("span",[t._v("共"+t._s(e.NumberOfSpecies)+"种")]),t._v(" \n                           "),a("span",[t._v("共"+t._s(e.number99)+"件")]),t._v(" \n                           "),a("span",[t._v("确认到货"+t._s(e.numberCai))]),t._v(" \n                           "),a("span",[t._v("物流收货"+t._s(e.numberKu))]),t._v(" \n                           "),a("span",[t._v(t._s(e.CreateDate.split("T")[0]))]),t._v(" \n                           "),a("el-link",{attrs:{type:"primary"},on:{click:function(a){return a.stopPropagation(),t.DownloadTheStorageOrder(e,n)}}},[t._v("下载入库单")])],1)]),t._v(" "),a("div",{staticClass:"ShippingDetails"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.MacPODispatchOrderGoodDtos,size:"mini"}},[a("el-table-column",{attrs:{prop:"ProductCode",label:"产品编码",width:"150"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Describe",label:"描述","show-overflow-tooltip":!0}}),t._v(" "),a("el-table-column",{attrs:{prop:"Locations",label:"库存库位",width:"200"}}),t._v(" "),a("el-table-column",{attrs:{width:"350"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.LocationInfo2,function(e,n){return a("div",{key:n,staticStyle:{float:"left","min-width":"100px"}},[t._v(" "+t._s(e+"]")+" ")])})}}],null,!0)},[a("template",{slot:"header"},[a("p",[t._v(t._s("入库信息"))])])],2),t._v(" "),a("el-table-column",{attrs:{prop:"DeliverQuantity",label:"发货数量",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{label:"物流收货",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.RuKu,function(o,l){return a("div",{key:l,staticClass:"ShippingDetails_scope"},[a("el-input",{staticStyle:{width:"60px",float:"left"},attrs:{size:"mini",placeholder:"数量"},model:{value:o.num,callback:function(e){t.$set(o,"num",e)},expression:"RuKuItem.num"}}),t._v(" "),a("el-input",{staticStyle:{width:"90px",float:"left"},attrs:{size:"mini",placeholder:"库位"},model:{value:o.ku,callback:function(e){t.$set(o,"ku",e)},expression:"RuKuItem.ku"}}),t._v(" "),0==l?a("span",{staticClass:"span3"},[a("i",{staticClass:"el-icon-circle-plus",staticStyle:{fontSize:"17px",color:"#67C23A",marginTop:"5px"},on:{click:function(a){return t.AddStorageLocation(n,e.row.ID)}}})]):t._e(),t._v(" "),0!=l?a("span",{staticClass:"span3"},[a("i",{staticClass:"el-icon-remove",staticStyle:{fontSize:"17px",color:"#F56C6C",marginTop:"5px"},on:{click:function(a){return t.DeleteStorageLocation(n,e.row.ID,l)}}})]):t._e()],1)})}}],null,!0)})],1),t._v(" "),a("el-table",{staticStyle:{display:"none"},attrs:{data:e.MacPODispatchOrderGoodDtos,id:"out-table-"+n,size:"mini"}},[a("el-table-column",{attrs:{prop:"Describe",label:"描述","show-overflow-tooltip":!0}}),t._v(" "),a("el-table-column",{attrs:{prop:"ProductCode",label:"产品编码",width:"150"}}),t._v(" "),a("el-table-column",{attrs:{width:"350"},scopedSlots:t._u([{key:"default",fn:function(t){}}],null,!0)},[a("template",{slot:"header"},[a("p",[t._v(t._s("收货数量"))])])],2),t._v(" "),a("el-table-column",{attrs:{width:"350"},scopedSlots:t._u([{key:"default",fn:function(t){}}],null,!0)},[a("template",{slot:"header"},[a("p",[t._v(t._s("库位"))])])],2)],1),t._v(" "),a("div",{staticClass:"ShippingDetails_primary"},[a("saxo-button",{staticStyle:{float:"right",margin:"0 5px"},attrs:{mini:"",type:"primary"},on:{click:function(a){return t.ReceiveQuantityFun(e.MacPODispatchOrderGoodDtos)}}},[t._v("保存物流数量")]),t._v(" "),a("el-button",{staticStyle:{float:"right",background:"#01000000",border:"none",color:"#67C23A",cursor:"default"},attrs:{type:"success",size:"mini"}},[a("label",{attrs:{for:n+"2"}},[a("i",{staticClass:"el-icon-upload"}),t._v("\n                                   上传入库文件\n                               ")]),t._v(" "),a("input",{ref:"referenceUpload",refInFor:!0,staticStyle:{"margin-left":"70px",display:"none"},attrs:{id:n+"2",type:"file",accept:".xlsx, .xls"},on:{change:function(e){return t.getFile(e,3,n)}}})]),t._v(" "),a("el-button",{staticStyle:{float:"right",background:"#01000000",border:"none",color:"#5e72e4",cursor:"default"},attrs:{type:"success",size:"mini"},on:{click:function(e){return t.DownloadStorageFile("#out-table-"+n)}}},[a("i",{staticClass:"el-icon-upload"}),t._v("\n                               下载入库文件\n                           ")])],1)],1)],2)}),1),t._v(" "),a("br"),t._v(" "),a("br"),t._v(" "),a("SaxoDrawer",{attrs:{show:t.SaxoDrawer,title:t.MPO.CusFullName+"(挂账款 & 不明款 & 资金池)"},on:{ShowFalse:function(e){t.SaxoDrawer=!1}}},[a("div",{staticClass:"DeawerBox"},[a("div",{staticClass:"table"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.CapitalPoolDtos,height:"100%"}},[a("el-table-column",{attrs:{label:"类别",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return["挂帐款"==e.row.LB?a("span",[t._v(" "+t._s(e.row.LB+"("+e.row.InvoiceStateStr+")"))]):t._e(),t._v(" "),"挂帐款"!=e.row.LB?a("span",[t._v(" "+t._s(e.row.LB))]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"资金量",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{float:"right"}},[t._v(" "+t._s(t.FinancialAmountFormat(e.row.Amount,t.FinancialAmountSymbol(e.row.BuyingCurrency))))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"使用量",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{float:"right"}},[t._v(" "+t._s(t.FinancialAmountFormat(e.row.UsageAmount,t.FinancialAmountSymbol(e.row.BuyingCurrency))))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"Creater",label:"创建人",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"CreateDate",label:"创建时间",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"StateStr",label:"状态",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{label:"系统信息","show-overflow-tooltip":!0,width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-popover",{attrs:{placement:"top-start",title:"系统信息",trigger:"hover"}},[t._l(e.row.SystemInfo2,function(e,n){return a("p",{key:n},[t._v(t._s(e))])}),t._v(" "),a("span",{attrs:{slot:"reference"},slot:"reference"},[t._v("系统信息"),a("i",{staticClass:"el-icon-warning-outline"})])],2)]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"Memo",label:"备注"}}),t._v(" "),a("el-table-column",{attrs:{label:"使用量",fixed:"right",width:"150px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{attrs:{size:"mini",type:"number",placeholder:"请输入使用量"},model:{value:e.row.Number,callback:function(a){t.$set(e.row,"Number",a)},expression:"scope.row.Number"}})]}}])})],1)],1),t._v(" "),a("div",{staticClass:"but"},[a("div",[t._v("认款合计：￥"),a("span",[t._v(" "+t._s(t.Subscription))])]),t._v(" "),a("saxo-button",{staticClass:"butState",attrs:{mini:"",type:"primary"},on:{click:t.AddMSOPaymentFun}},[t._v("确认")])],1)])]),t._v(" "),-1!=[3,4,5,6].indexOf(t.MPO.State)?a("div",[a("div",{staticClass:"el-descriptions__title"},[t._v("付款清单\n\n                   "),t.MachinePOPayDtosHJ<t.MPO.TotalAmount?a("saxo-button",{staticStyle:{float:"right","margin-left":"100px"},attrs:{mini:"",type:"success"},on:{click:function(e){return t.applyToUseAccounts()}}},[t._v("申请使用挂账款")]):t._e(),t._v(" "),t.MachinePOPayDtosHJ<t.MPO.TotalAmount?a("el-input",{staticStyle:{width:"250px",float:"right"},attrs:{placeholder:"请输入金额",size:"mini"},model:{value:t.PaymentAmount,callback:function(e){t.PaymentAmount=e},expression:"PaymentAmount"}},[a("el-button",{attrs:{slot:"append",type:"success",id:"success_s"},on:{click:t.PaymentAmountClick},slot:"append"},[t._v("付款")])],1):t._e(),t._v(" "),t.MachinePOPayDtosHJ<t.MPO.TotalAmount?a("el-autocomplete",{staticClass:"inline-input",staticStyle:{width:"200px",float:"right"},attrs:{"fetch-suggestions":t.querySearch,placeholder:"请选择或输入比例",size:"mini",clearable:""},model:{value:t.PaymentAmountBFB,callback:function(e){t.PaymentAmountBFB=e},expression:"PaymentAmountBFB"}},[a("template",{slot:"append"},[t._v("%")])],2):t._e()],1),t._v(" "),a("br"),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.MPO.MachinePOPayDtos,"header-cell-style":t.headerCellStyle,"cell-style":t.cellStyle,stripe:""}},[a("el-table-column",{attrs:{label:"创建时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.CreateDate.split("T")[0]))])]}}],null,!1,3961921737)}),t._v(" "),a("el-table-column",{attrs:{label:"付款金额",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{float:"right"}},[t._v(" "+t._s(t.FinancialAmountFormat(e.row.Amount,t.CurrencySign)))])]}}],null,!1,169498669)}),t._v(" "),a("el-table-column",{attrs:{label:"付款比例",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{float:"right"}},[t._v(" "+t._s((e.row.Amount/t.MPO.TotalAmount*100).toFixed(2)+"%"))])]}}],null,!1,3318342154)}),t._v(" "),a("el-table-column",{attrs:{prop:"Creater",label:"申请人"}}),t._v(" "),a("el-table-column",{attrs:{prop:"AuditorA",label:"请款"}}),t._v(" "),a("el-table-column",{attrs:{prop:"AuditorB",label:"审核请款"}}),t._v(" "),a("el-table-column",{attrs:{prop:"AuditorC",label:"批准采购"}}),t._v(" "),a("el-table-column",{attrs:{prop:"AuditorD",label:"确认付款"}}),t._v(" "),a("el-table-column",{attrs:{prop:"PayStateStr",label:"付款状态"}}),t._v(" "),a("el-table-column",{attrs:{prop:"PayStateStr",label:"备注"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.Amount>0&&"已付款"==e.row.PayStateStr?a("saxo-button",{attrs:{mini:"",type:"danger"},on:{click:function(a){return t.RequestRefund(e.row)}}},[t._v("申请退款")]):t._e()]}}],null,!1,837958280)})],1),t._v(" "),a("br")],1):t._e(),t._v(" "),a("el-dialog",{attrs:{title:"申请退款",visible:t.RequestRefundDialog,width:"800px","append-to-body":!0},on:{"update:visible":function(e){t.RequestRefundDialog=e}}},[a("el-form",{attrs:{"label-width":"80px",model:t.RequestRefundData,size:"mini"}},[a("el-form-item",{attrs:{label:"付款金额"}},[a("span",{domProps:{textContent:t._s(t.FinancialAmountFormat(t.RequestRefundData.Amount,t.FinancialAmountSymbol(t.MPO.BuyingCurrency)))}})]),t._v(" "),a("el-form-item",{attrs:{label:"退款金额"}},[a("el-input-number",{attrs:{"controls-position":"right",min:0,max:t.RequestRefundData.Amount},model:{value:t.RequestRefundData.RefundAmount,callback:function(e){t.$set(t.RequestRefundData,"RefundAmount",e)},expression:"RequestRefundData.RefundAmount"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"资金去向"}},[a("el-radio-group",{model:{value:t.RequestRefundData.RefundTo,callback:function(e){t.$set(t.RequestRefundData,"RefundTo",e)},expression:"RequestRefundData.RefundTo"}},[a("el-radio",{attrs:{label:"网银"}},[t._v("网银")]),t._v(" "),a("el-radio",{attrs:{label:"已开票挂账"}},[t._v("已开票挂账")]),t._v(" "),"RMB"==t.MPO.BuyingCurrency?a("el-radio",{attrs:{label:"未开票挂账"}},[t._v("未开票挂账")]):t._e()],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:4}},model:{value:t.RequestRefundData.Other,callback:function(e){t.$set(t.RequestRefundData,"Other",e)},expression:"RequestRefundData.Other"}})],1)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("saxo-button",{attrs:{mini:"",type:"info"},on:{click:function(e){t.RequestRefundDialog=!1}}},[t._v("取消")]),t._v(" "),a("saxo-button",{attrs:{mini:"",type:"primary"},on:{click:function(e){return t.RequestRefundPrimary()}}},[t._v("确认")])],1)],1),t._v(" "),a("br"),t._v(" "),-1!=[3,4,5,6].indexOf(t.MPO.State)?a("div",[a("div",{staticClass:"el-descriptions__title"},[t._v("设备变更清单\n                   "),t._v(" "),a("saxo-button",{staticStyle:{float:"right"},attrs:{mini:"",type:"success"},on:{click:function(e){return t.ApplyToChangeEquipment()}}},[t._v("申请变更设备")])],1),t._v(" "),a("br"),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.MPO.MpoReturnDtos,"header-cell-style":t.headerCellStyle,"cell-style":t.cellStyle,stripe:""}},[a("el-table-column",{attrs:{label:"创建时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(" "+t._s(e.row.CreateDate.split("T")[0]))])]}}],null,!1,338188898)}),t._v(" "),a("el-table-column",{attrs:{label:"类别"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.Type))])]}}],null,!1,1730832542)}),t._v(" "),a("el-table-column",{attrs:{prop:"StateStr",label:"状态"}}),t._v(" "),a("el-table-column",{attrs:{label:"差额",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{float:"right"}},[t._v(" "+t._s(t.FinancialAmountFormat(e.row.ChaAmount)))])]}}],null,!1,1768404031)}),t._v(" "),a("el-table-column",{attrs:{label:"系统信息",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-popover",{attrs:{placement:"top-start",title:"系统信息",trigger:"hover"}},[t._l(e.row.SystemInfo.split("@"),function(e,n){return a("p",{key:n},[t._v(t._s(e))])}),t._v(" "),a("span",{attrs:{slot:"reference"},slot:"reference"},[t._v("系统信息"),a("i",{staticClass:"el-icon-warning-outline"})])],2)]}}],null,!1,3627510684)}),t._v(" "),a("el-table-column",{attrs:{label:"详情",fixed:"right",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-link",{staticStyle:{"font-size":"12px"},attrs:{type:"primary",underline:!1},on:{click:function(a){return t.SeeApplyEquipment(e.row)}}},[t._v("详情")])]}}],null,!1,3825900256)})],1)],1):t._e(),t._v(" "),a("br"),t._v(" "),-1!=[3,4,5,6].indexOf(t.MPO.State)?a("div",[a("div",{staticClass:"el-descriptions__title"},[t._v("发票清单\n                   "),t.MachinePOInvoiceDtosHJ<t.MPO.TotalAmount?a("el-input",{staticStyle:{width:"250px",float:"right"},attrs:{placeholder:"请输入金额",size:"mini"},model:{value:t.received,callback:function(e){t.received=e},expression:"received"}},[a("el-button",{attrs:{slot:"append",type:"success",id:"success_s"},on:{click:t.InvoiceReceived},slot:"append"},[t._v("收到发票")])],1):t._e()],1),t._v(" "),a("br"),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.MPO.MachinePOInvoiceDtos,"header-cell-style":t.headerCellStyle,"cell-style":t.cellStyle,stripe:""}},[a("el-table-column",{attrs:{label:"创建时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.CreateDate.split("T")[0]))])]}}],null,!1,3961921737)}),t._v(" "),a("el-table-column",{attrs:{label:"发票金额",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{float:"right"}},[t._v(" "+t._s(t.FinancialAmountFormat(e.row.Amount,t.CurrencySign)))])]}}],null,!1,169498669)}),t._v(" "),a("el-table-column",{attrs:{label:"发票比例",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{float:"right"}},[t._v(t._s((e.row.Amount/t.MPO.TotalAmount*100).toFixed(2)+"%"))])]}}],null,!1,535793889)}),t._v(" "),a("el-table-column",{attrs:{prop:"Creater",label:"申请人"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Confirmer",label:"财务确认人"}}),t._v(" "),a("el-table-column",{attrs:{prop:"POCode",label:"采购单编号"}}),t._v(" "),a("el-table-column",{attrs:{prop:"CusFullName",label:"供应商名称"}}),t._v(" "),a("el-table-column",{attrs:{prop:"InvoiceStateStr",label:"发票状态"}}),t._v(" "),a("el-table-column",{attrs:{prop:"ReceiverEmail",label:"收票人邮箱"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Logistics",label:"物流单号"}}),t._v(" "),a("el-table-column",{attrs:{prop:"InvCode",label:"发票号"}}),t._v(" "),a("el-table-column",{attrs:{label:"附件",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.InvFiles,function(e,n){return a("p",{key:n},[a("el-link",{attrs:{target:"_blank",type:"primary",href:"http://icms.inchwell.com.cn"+e.FileUrl}},[t._v(t._s(e.FileName))]),t._v("  \n                               "),a("span",{staticStyle:{color:"#409EFF",cursor:"pointer"},on:{click:function(a){return t.DwFileUrl(e.FileUrl,e.FileName)}}},[t._v("下载")])],1)})}}],null,!1,2529443027)}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"130"},scopedSlots:t._u([{key:"default",fn:function(e){return[2==e.row.InvoiceState?a("saxo-button",{attrs:{mini:"",type:"success"},on:{click:function(a){return t.OperationInvoice(e.row)}}},[t._v("申请操作")]):t._e(),t._v(" "),10==e.row.InvoiceState?a("saxo-button",{attrs:{mini:"",type:"success"},on:{click:function(a){return t.SubmitRedInv(e.row)}}},[t._v("提交冲红发票")]):t._e()]}}],null,!1,669846297)})],1),t._v(" "),a("br")],1):t._e(),t._v(" "),a("div",{staticClass:"el-descriptions__title"},[t._v("附件")]),t._v(" "),a("br"),t._v(" "),a("uploadFile",{attrs:{FileData:t.MachinePOFiles},on:{receive:t.receive,deleteFun:t.deleteFun}}),t._v(" "),a("br"),t._v(" "),a("div",{staticClass:"el-descriptions__title"},[t._v("备注")]),t._v(" "),a("br"),t._v(" "),a("el-input",{staticStyle:{width:"500px"},attrs:{type:"textarea",autosize:{minRows:5,maxRows:10},placeholder:"请输入内容"},model:{value:t.MPO.Memo,callback:function(e){t.$set(t.MPO,"Memo",e)},expression:"MPO.Memo"}}),t._v(" "),a("br"),t._v(" "),a("br"),t._v(" "),a("br"),t._v(" "),a("br"),t._v(" "),a("br"),t._v(" "),a("el-drawer",{attrs:{visible:t.drawer2,direction:"ltr",modal:!1,"with-header":!1,size:"70%"},on:{"update:visible":function(e){t.drawer2=e}}},[a("div",{staticClass:"DrawerHeader"},[t._v("整机销售合同")]),t._v(" "),a("div",{staticClass:"DrawerSearch"},[a("div",{staticClass:"DrawerSearchLeft"},[a("div",{staticClass:"department"},[a("span",[t._v("客户名称、单号")]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入客户名称、单号",size:"mini"},model:{value:t.DrawerSearch,callback:function(e){t.DrawerSearch=e},expression:"DrawerSearch"}})],1),t._v(" "),a("div",{staticClass:"department"},[a("span",[t._v("区域：")]),t._v(" "),a("el-select",{attrs:{size:"mini",clearable:"",placeholder:"请选择区域"},model:{value:t.area,callback:function(e){t.area=e},expression:"area"}},t._l(t.$store.state.Vuex.Area,function(t){return a("el-option",{key:t.Value,attrs:{label:t.Value,value:t.Value}})}),1)],1),t._v(" "),a("div",{staticClass:"department"},[a("span",[t._v("客户类型：")]),t._v(" "),a("el-select",{attrs:{placeholder:"请选择客户类型",size:"mini",clearable:""},model:{value:t.cusType,callback:function(e){t.cusType=e},expression:"cusType"}},t._l(t.Typeofcustomer,function(t,e){return a("el-option",{key:e,attrs:{label:t.label,value:t.label}})}),1)],1),t._v(" "),a("div",{staticClass:"department"},[a("span",[t._v("选择状态：")]),t._v(" "),a("el-select",{attrs:{placeholder:"请选择状态",size:"mini",clearable:""},model:{value:t.state,callback:function(e){t.state=e},expression:"state"}},t._l(t.options,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),a("div",{staticClass:"department"},[a("span",[t._v("销售员")]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入销售员",size:"mini"},model:{value:t.DrawerSaler,callback:function(e){t.DrawerSaler=e},expression:"DrawerSaler"}})],1)]),t._v(" "),a("div",{staticClass:"DrawerSearchRight"},[a("saxo-button",{attrs:{mini:"",type:"primary"},on:{click:function(e){return t.DrawerSearchFun()}}},[t._v("搜索")])],1)]),t._v(" "),a("div",{staticClass:"DrawerContent"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,height:"100%",size:"mini"}},[a("el-table-column",{attrs:{prop:"CusFullName",label:"客户名称","show-overflow-tooltip":!0}}),t._v(" "),a("el-table-column",{attrs:{prop:"SOCode",label:"订单编号"}}),t._v(" "),a("el-table-column",{attrs:{prop:"StateStr",label:"订单状态",width:"100px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"PayStatusStr",label:"付款状态",width:"100px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"DiscountAmount",label:"优惠后金额",width:"100px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"CreateDateStr",label:"创建时间",width:"150px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"SalerName",label:"销售",width:"100px"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("saxo-button",{attrs:{mini:"",type:"primary"},on:{click:function(a){return t.Check(e.row)}}},[t._v("查看")])]}}])})],1)],1),t._v(" "),a("div",{staticClass:"DrawerTail"},[a("SaxoFenYe",{attrs:{total:t.total2},on:{func:t.pageFun}})],1),t._v(" "),a("el-drawer",{attrs:{visible:t.drawer3,direction:"ltr",modal:!1,"with-header":!1,size:"60%"},on:{"update:visible":function(e){t.drawer3=e}}},[a("div",{staticClass:"DrawerHeader"},[t._v("整机销售合同设备")]),t._v(" "),a("div",{staticClass:"DrawerSearch"},[a("div",{staticClass:"DrawerSearchLeft"},[a("div",{staticClass:"department"},[a("span",[t._v("检索")]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},on:{input:function(e){return t.SeacrhEquFun()}},model:{value:t.SeacrhEqu,callback:function(e){t.SeacrhEqu=e},expression:"SeacrhEqu"}})],1),t._v(" "),a("div",{staticClass:"department"},[a("span",[t._v("品牌")]),t._v(" "),a("el-select",{attrs:{filterable:"",placeholder:"请选择",size:"mini",clearable:""},on:{change:function(e){return t.SeacrhEquFun()}},model:{value:t.brand,callback:function(e){t.brand=e},expression:"brand"}},t._l(t.brands,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1)]),t._v(" "),a("div",{staticClass:"DrawerSearchRight"})]),t._v(" "),a("div",{staticClass:"DrawerContent"},[a("el-table",{ref:"HeTong2",staticStyle:{width:"100%"},attrs:{data:t.MachineSOEquDtos,height:"100%",size:"mini","empty-text":"此合同未查询到设备"}},[a("el-table-column",{attrs:{prop:"ProductCode",label:"产品编码","show-overflow-tooltip":!0,width:"150"}}),t._v(" "),a("el-table-column",{attrs:{prop:"LongCode",label:"内部编码",width:"150"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Describe",label:"描述"}}),t._v(" "),a("el-table-column",{attrs:{label:"数量",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{attrs:{id:"Number_input"}},[a("div",{staticClass:"div_icon_text",on:{click:function(t){e.row.Quantity>1&&(e.row.Quantity=Number(e.row.Quantity)-1)}}},[a("i",{staticClass:"el-icon-minus"})]),t._v(" "),a("div",{staticClass:"div_icon_textConter"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.row.Quantity,expression:"scope.row.Quantity"}],staticStyle:{"text-align":"center","border-style":"none",outline:"none",width:"100%"},attrs:{type:"text"},domProps:{value:e.row.Quantity},on:{input:function(a){a.target.composing||t.$set(e.row,"Quantity",a.target.value)}}})]),t._v(" "),a("div",{staticClass:"div_icon_text",on:{click:function(t){e.row.Quantity=Number(e.row.Quantity)+1}}},[a("i",{staticClass:"el-icon-plus"})])])]}}])}),t._v(" "),a("el-table-column",{attrs:{type:"selection",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("saxo-button",{attrs:{mini:"",type:"primary"},on:{click:function(a){return t.AddTo(e.row)}}},[t._v("添加")])]}}])})],1)],1),t._v(" "),a("div",{staticClass:"DrawerTail"},[a("saxo-button",{staticStyle:{marginTop:"10px",float:"right",marginRight:"10px"},attrs:{mini:"",type:"primary"},on:{click:function(e){return t.AddToCheck()}}},[t._v("添加选择")])],1)])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"修改设备"+t.column.ProductCode+"的备注",visible:t.dialogVisible2,width:"30%","append-to-body":!0},on:{"update:visible":function(e){t.dialogVisible2=e}}},[a("el-input",{attrs:{type:"textarea",rows:4,placeholder:"请输入内容"},model:{value:t.column.Memo,callback:function(e){t.$set(t.column,"Memo",e)},expression:"column.Memo"}}),t._v(" "),a("span",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini"},on:{click:function(e){t.dialogVisible2=!1}}},[t._v("取 消")]),t._v(" "),a("saxo-button",{attrs:{mini:"",type:"primary"},on:{click:function(e){return t.ModifyMemo()}}},[t._v("确 认")])],1)],1)],1)},staticRenderFns:[]};var h=a("VU/8")(d,p,!1,function(t){a("qHLX")},"data-v-f9654832",null);e.default=h.exports},qHLX:function(t,e){}});