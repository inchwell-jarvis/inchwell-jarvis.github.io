webpackJsonp([194],{"4Dyi":function(t,e){},pdHE:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("PXCl").Base64,i={name:"",data:function(){return{State:0,StateActive:0,Data:{},imgList:[],imageUrl:{},dialogVisibleMainGraph:!1,WoCodeCost:0,InState:"请选择在保状态",options:[{value:!0,label:"在保"},{value:!1,label:"不在保"}],Content:"",Memo:"",MDQuoteCharge:"",MDQuoteCode:"",SName:"确认",IsUnderWarranty:!1,ActualCharge:"",DiscountFinalCharge:""}},created:function(){this.init()},components:{},methods:{TravelForOnSiteMaintenance:function(t){var e={url:s.encodeURI(this.$store.state.http+"WO/GetQutuoTrave"),ID:s.encodeURI(t.WOId),token:s.encodeURI(localStorage.getItem("token"))};this.jump("List/DBLquotation.html",e)},init:function(){var t=this,e={url:this.$store.state.http+"WO/GetDBLWODetail",api:"get",data:{woId:this.$store.state.Vuex.Id}};this.$https(e).then(function(e){console.log(e.Data),t.Data=e.Data;for(var a=0;a<t.Data.RepairCosts.length;a++){var s=t.Data.RepairCosts[a];s.TravelTravelInfo=s.Travel+" - "+s.TravelInfo}t.Memo=e.Data.RepairProcess.Memo,t.MDQuoteCode=e.Data.RepairProcess.MDQuoteCode,t.IsUnderWarranty=e.Data.RepairProcess.IsUnderWarranty,t.MDQuoteCharge=e.Data.RepairProcess.MDQuoteCharge,t.State=e.Data.RepairProcess.State,console.log("当前订单状态："+t.State);for(var i=[30,32,34,41,35,33,42],o=0;o<i.length;o++)t.State==i[o]&&(t.StateActive=o+1);console.log("我的状态:"+t.StateActive),2==t.StateActive&&(t.SName="收到设备"),3==t.StateActive&&(t.SName="维修完毕"),4==t.StateActive&&(t.SName="报最终价"),5==t.StateActive&&(t.SName="维修费付款"),6==t.StateActive&&(t.SName="转物流")})},Save:function(){var t=this;
//! 已受理
if(1==this.StateActive){if(console.log(this.InState),""==this.MDQuoteCode)return this.$message.warning("请输入报价单号！"),!1;if("请选择在保状态"==this.InState)return this.$message.warning("请选择是否在保！"),!1;var e={url:this.$store.state.http+"WO/MDYuQuote",api:"post",data:{Id:this.Data.RepairProcess.WOId,MDQuoteCode:this.MDQuoteCode,IsUnderWarranty:this.InState,MDQuoteCharge:this.MDQuoteCharge,Memo:this.Memo}};this.$https(e).then(function(e){console.log(e.Data),t.$message.success("操作成功！"),t.$emit("refresh"),t.$router.push({path:"/WorkOrderTask"})})}if(2==this.StateActive){e={url:this.$store.state.http+"WO/MDReceive",api:"post",data:{Id:this.Data.RepairProcess.WOId,Other:this.Memo}};this.$https(e).then(function(e){console.log(e.Data),t.$message.success("操作成功！"),t.init()})}if(3==this.StateActive){e={url:this.$store.state.http+"WO/MDRepairComplete",api:"post",data:{Id:this.Data.RepairProcess.WOId,Str:this.Memo,Type:this.Content}};this.$https(e).then(function(e){console.log(e.Data),t.$message.success("操作成功！"),t.$emit("refresh"),t.$router.push({path:"/WorkOrderTask"})})}if(4==this.StateActive){e={url:this.$store.state.http+"WO/QuoteFinal",api:"post",data:{WoId:this.Data.RepairProcess.WOId,ActualCharge:this.ActualCharge,Memo:this.Memo}};this.$https(e).then(function(e){console.log(e.Data),t.$message.success("操作成功！"),t.init()})}if(5==this.StateActive){e={url:this.$store.state.http+"WO/FSFinalConfirm",api:"post",data:{Id:this.Data.RepairProcess.WOId}};this.$https(e).then(function(e){console.log(e.Data),t.$message.success("操作成功！"),t.init()})}if(6==this.StateActive){e={url:this.$store.state.http+"WO/WOGotoLogistics",api:"post",data:{Id:this.Data.RepairProcess.WOId,Str:this.Memo}};this.$https(e).then(function(e){console.log(e.Data),t.$message.success("操作成功！"),t.$emit("refresh"),t.$router.push({path:"/WorkOrderTask"})})}},IMGVIDEO:function(t){console.log(t),this.imageUrl=t,this.dialogVisibleMainGraph=!0},FSFinalConfirm:function(){var t=this,e={url:this.$store.state.http+"WO/FSFinalConfirm",api:"post",data:{Id:this.Data.RepairProcess.WOId}};this.$https(e).then(function(e){console.log(e.Data),t.$message.success("操作成功！"),t.init()})}}},o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"box_s"},[13!=t.StateActive?a("el-steps",{attrs:{active:t.StateActive,id:"BottomTextStopes"}},[a("el-step",{attrs:{icon:"el-icon-caret-bottom",description:"已受理"}}),t._v(" "),a("el-step",{attrs:{icon:"el-icon-caret-bottom",description:"维修费已确认"}}),t._v(" "),a("el-step",{attrs:{icon:"el-icon-caret-bottom",description:"维修中"}}),t._v(" "),a("el-step",{attrs:{icon:"el-icon-caret-bottom",description:"维修完毕"}}),t._v(" "),a("el-step",{attrs:{icon:"el-icon-caret-bottom",description:"已报最终价"}}),t._v(" "),a("el-step",{attrs:{icon:"el-icon-caret-bottom",description:"已付维修费"}}),t._v(" "),a("el-step",{attrs:{icon:"el-icon-caret-bottom",description:"已转物流"}})],1):t._e(),t._v(" "),11==t.StateActive?a("el-steps",{attrs:{active:1,"finish-status":"error",id:"BottomTextStopes"}},[a("el-step",{attrs:{icon:"el-icon-caret-bottom",description:"已撤单"}})],1):t._e(),t._v(" "),a("div",{staticClass:"boxj4bjb5hv65k43n53"},[t.Data.RepairBase?a("div",[a("div",{staticClass:"segmentation"},[t._v("\n                客户信息 【"+t._s(t.Data.RepairBase.CusName)+"】\n            ")]),t._v(" "),a("div",{staticClass:"itemmsgxx_document",staticStyle:{width:"100%"}},[a("p",[a("span",[t._v("报修单号:")]),t._v(t._s(t.Data.RepairBase.RepairCode))])]),t._v(" "),a("div",{staticClass:"itemmsgxx_document"},[a("p",[a("span",[t._v("报修人:")]),t._v(t._s(t.Data.RepairMan.RepairName))])]),t._v(" "),a("div",{staticClass:"itemmsgxx_document"},[a("p",[a("span",[t._v("英文名:")]),t._v(t._s(t.Data.RepairMan.RepairNameEn))])]),t._v(" "),a("div",{staticClass:"itemmsgxx_document"},[a("p",[a("span",[t._v("手机号码:")]),t._v(t._s(t.Data.RepairMan.MobilePhone))])]),t._v(" "),a("div",{staticClass:"itemmsgxx_document"},[a("p",[a("span",[t._v("固定号码:")]),t._v(t._s(t.Data.RepairMan.Tel))])]),t._v(" "),a("div",{staticClass:"itemmsgxx_document",staticStyle:{width:"600px"}},[a("p",[a("span",[t._v("邮箱:")]),t._v(t._s(t.Data.RepairMan.Email))])]),t._v(" "),a("div",{staticClass:"itemmsgxx_document",staticStyle:{width:"600px"}},[a("p",[a("span",[t._v("公司地址:")]),t._v(t._s(t.Data.RepairMan.AddressDetail))])]),t._v(" "),a("div",{staticClass:"itemmsgxx_documentText"},[a("p",{staticStyle:{"word-break":"break-all"}},[a("span",[t._v("客户备注:")]),t._v(t._s(t.Data.RepairBase.Remark))])])]):t._e(),t._v(" "),t.Data.RepairDeviceInfo?a("div",[a("div",{staticClass:"segmentation"},[t._v("\n                故障设备\n            ")]),t._v(" "),a("div",{staticClass:"itemmsgxx_document"},[a("p",[a("span",[t._v("产品编号:")]),t._v(t._s(t.Data.RepairDeviceInfo.DeviceCode))])]),t._v(" "),a("div",{staticClass:"itemmsgxx_document"},[a("p",[a("span",[t._v("序列号:")]),t._v(t._s(t.Data.RepairDeviceInfo.DeviceSN))])]),t._v(" "),a("div",{staticClass:"itemmsgxx_document"},[a("p",[a("span",[t._v("设备品牌:")]),t._v(t._s(t.Data.RepairDeviceInfo.DeviceBrand))])]),t._v(" "),a("div",{staticClass:"itemmsgxx_document",staticStyle:{width:"100%"}},[a("p",[a("span",[t._v("设备描述:")]),t._v(t._s(t.Data.RepairDeviceInfo.DeviceDesc))])]),t._v(" "),a("div",{staticClass:"itemmsgxx_documentText"},[a("p",{staticStyle:{"word-break":"break-all"}},[a("span",[t._v("故障描述:")]),t._v(t._s(t.Data.RepairBase.FaultDescribe))])])]):t._e(),t._v(" "),t.Data.RepairDeviceInfo?a("div",[a("div",{staticClass:"segmentation"},[t._v("\n                故障图片&视频\n            ")]),t._v(" "),t._l(t.Data.RepairFaultImages,function(e,s){return a("div",{key:s,staticClass:"demo-image__preview",staticStyle:{width:"200px",float:"left"},on:{click:function(a){return t.IMGVIDEO(e)}}},["picture"==e.Type?a("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{src:e.Path,fit:"fill","preview-src-list":t.imgList}}):t._e()],1)}),t._v(" "),t._l(t.Data.RepairFaultImages,function(e,s){return a("div",{key:s+123,staticClass:"demo-image__preview",staticStyle:{width:"200px",float:"left"},on:{click:function(e){return t.IMGVIDEO(t.upload)}}},["video"==e.Type?a("video",{staticClass:"avatar video-avatar",staticStyle:{width:"100%"},attrs:{src:e.Path,controls:"controls"}},[t._v("\n                    您的浏览器不支持视频播放\n                ")]):t._e()])})],2):t._e(),t._v(" "),a("el-dialog",{staticClass:"spc12",attrs:{visible:t.dialogVisibleMainGraph,"modal-append-to-body":!1},on:{"update:visible":function(e){t.dialogVisibleMainGraph=e}}},["video/mp4"!=t.imageUrl.type?a("img",{attrs:{width:"100%",src:t.imageUrl.Path,alt:""}}):t._e(),t._v(" "),"video/mp4"==t.imageUrl.type?a("video",{staticClass:"avatar video-avatar",attrs:{src:t.imageUrl.Path,controls:"controls"}},[t._v("\n                您的浏览器不支持视频播放\n            ")]):t._e()]),t._v(" "),t.Data.RepairCosts?a("div",[a("div",{staticClass:"segmentation"},[t._v("\n                费用清单\n            ")]),t._v(" "),a("el-table",{staticStyle:{width:"100%",paddingLeft:"50px",fontSize:"12px"},attrs:{data:t.Data.RepairCosts},on:{"row-click":t.TravelForOnSiteMaintenance}},[a("el-table-column",{attrs:{prop:"OrderTypeStr",label:"工单类型",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"WoCode",label:"工单单号",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"TravelTravelInfo",label:"差旅费",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Service",label:"服务费"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Cost",label:"合计"}}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"报价单",width:"150"}},[[a("p",{staticStyle:{color:"#409EFF"}},[t._v("维修服务费报价单")])]],2)],1)],1):t._e(),t._v(" "),a("div",[a("div",{staticClass:"segmentation"},[t._v("\n                工程师\n            ")]),t._v(" "),a("div",{staticClass:"itemmsgxx_document"},[a("p",[a("span",[t._v("工程师:")]),t._v(t._s(t.Data.RepairProcess.Enginner))])]),t._v(" "),a("div",{staticClass:"itemmsgxx_documentText"},[a("p",{staticStyle:{"word-break":"break-all"}},[a("span",[t._v("工作内容:")]),t._v(t._s(t.Data.RepairProcess.WorkContent))])])]),t._v(" "),1!=t.StateActive?a("div",[a("div",{staticClass:"segmentation"},[t._v("\n                在保状态\n            ")]),t._v(" "),a("div",{staticClass:"itemmsgxx_document"},[a("p",[a("span",[t._v("在保状态:")]),t._v(t._s(t.IsUnderWarranty?"在保":"不在保"))])])]):t._e(),t._v(" "),1==t.StateActive?a("div",[a("div",{staticClass:"segmentation"},[t._v("\n                选择在保状态\n                ")]),t._v(" "),a("div",{staticClass:"itemmsgxx_documentSece"},[a("span",{staticClass:"leftSpan"},[t._v("在保状态:")]),t._v(" "),a("el-select",{staticStyle:{width:"150px"},attrs:{size:"mini",placeholder:"请选择"},model:{value:t.InState,callback:function(e){t.InState=e},expression:"InState"}},t._l(t.options,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1)]):t._e(),t._v(" "),t.StateActive>3?a("div",[a("div",{staticClass:"segmentation"},[t._v("\n                最终价\n            ")]),t._v(" "),4==t.StateActive?a("div",{staticClass:"itemmsgxx_document"},[a("span",{staticStyle:{float:"left"}},[t._v("最终价:")]),t._v(" "),a("el-input",{staticStyle:{width:"193px",float:"left"},attrs:{size:"mini",placeholder:""},model:{value:t.ActualCharge,callback:function(e){t.ActualCharge=e},expression:"ActualCharge"}})],1):t._e(),t._v(" "),t.StateActive>4?a("div",{staticClass:"itemmsgxx_document"},[a("p",[a("span",[t._v("最终价")]),t._v(t._s(t.Data.RepairProcess.MDFinalQuoteCharge))])]):t._e()]):t._e(),t._v(" "),a("div",[a("div",{staticClass:"segmentation"},[t._v("\n                预报维修费\n            ")]),t._v(" "),1==t.StateActive?a("div",{staticClass:"itemmsgxx_document"},[a("span",{staticStyle:{float:"left"}},[t._v("报价单号:")]),t._v(" "),a("el-input",{staticStyle:{width:"193px",float:"left"},attrs:{size:"mini",placeholder:""},model:{value:t.MDQuoteCode,callback:function(e){t.MDQuoteCode=e},expression:"MDQuoteCode"}})],1):t._e(),t._v(" "),1==t.StateActive?a("div",{staticClass:"itemmsgxx_document"},[a("span",{staticStyle:{float:"left"}},[t._v("预报维修费:")]),t._v(" "),a("el-input",{staticStyle:{width:"193px",float:"left"},attrs:{size:"mini",placeholder:""},model:{value:t.MDQuoteCharge,callback:function(e){t.MDQuoteCharge=e},expression:"MDQuoteCharge"}})],1):t._e(),t._v(" "),1!=t.StateActive?a("div",{staticClass:"itemmsgxx_document"},[a("p",[a("span",[t._v("报价单号")]),t._v(t._s(t.MDQuoteCode))])]):t._e(),t._v(" "),1!=t.StateActive?a("div",{staticClass:"itemmsgxx_document"},[a("p",[a("span",[t._v("维修费")]),t._v(t._s(t.MDQuoteCharge))])]):t._e()]),t._v(" "),a("div",[a("div",{staticClass:"segmentation"},[t._v("\n                备注\n                ")]),t._v(" "),a("el-input",{staticStyle:{float:"left",width:"500px",margin:"10px"},attrs:{type:"textarea",autosize:{minRows:2,maxRows:10},placeholder:"备注"},model:{value:t.Memo,callback:function(e){t.Memo=e},expression:"Memo"}})],1),t._v(" "),3==t.StateActive?a("div",[a("div",{staticClass:"segmentation"},[t._v("\n                工作内容\n                ")]),t._v(" "),a("el-input",{staticStyle:{float:"left",width:"500px",margin:"10px"},attrs:{type:"textarea",autosize:{minRows:2,maxRows:10},placeholder:"工作内容"},model:{value:t.Content,callback:function(e){t.Content=e},expression:"Content"}})],1):t._e(),t._v(" "),t.StateActive<7?a("div",{staticStyle:{width:"99%",height:"2px",float:"left",marginBottom:"100px"}},[a("el-button",{staticStyle:{margin:"10px",float:"right"},attrs:{type:"primary",loading:this.$store.state.Vuex.loading,size:"mini"},on:{click:t.Save}},[t._v("\n                "+t._s(t.SName))])],1):t._e()],1)],1)},staticRenderFns:[]};var n=a("VU/8")(i,o,!1,function(t){a("4Dyi")},"data-v-0209a4a9",null);e.default=n.exports}});