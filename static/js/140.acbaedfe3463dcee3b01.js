webpackJsonp([140],{IbmV:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a("Dd8w"),n=a.n(o),i=a("mvHQ"),l=a.n(i),s=a("bOdI"),r=a.n(s),c={data:function(){var t,e;return{headerCellStyle:(t={background:"#f7f8fd",fontSize:"12px",fontWeight:400,fontStyle:"normal"},r()(t,"fontSize","11px"),r()(t,"padding","5px"),r()(t,"paddingLeft","0px"),t),headerCellStyle2:(e={background:"#f7f8fd",fontSize:"12px",fontWeight:400,fontStyle:"normal"},r()(e,"fontSize","11px"),r()(e,"padding","5px"),r()(e,"paddingLeft","0px"),r()(e,"textAlign","center"),e),cellStyle:{height:"48px",fontSize:"12px"},Kehu:"",CusId:"",RelatedMSOCode:"",RelatedMPOCode:"",TotalAmount:0,Memo:"",ReturnType:"",options:[{lable:"退货退款",value:"退货退款"},{lable:"退货挂账",value:"退货挂账"}],tableData:[],MachineReturnGoodDtos:[],CFclick:!0,DeviceDatabaseShow:!1}},computed:{newArray:function(){return JSON.parse(l()(this.tableData))}},watch:{newArray:function(t){var e=this;this.TotalAmount=0,this.MachineReturnGoodDtos=[],t.forEach(function(t){e.TotalAmount+=Number(t.UnitPrice)*Number(t.Quantity),e.MachineReturnGoodDtos.push({ProductId:t.ID,Quantity:t.Quantity,Amount:t.UnitPrice})})}},methods:{ShowFalse:function(t){this.DeviceDatabaseShow=t},DataBase:function(t){console.log(t);for(var e=0;e<t.length;e++){var a=t[e],o=JSON.parse(l()(a));console.log(o),-1===l()(this.tableData).indexOf(l()(o.ID))?this.tableData.push(o):this.tableData.forEach(function(t){t.ID===o.ID&&(t.Quantity+=o.Quantity)})}},Create:function(){var t=this;if(!this.CFclick)return this.$message.error("请勿连续点击！"),!1;this.CFclick=!1;var e=setTimeout(function(){t.CFclick=!0,clearTimeout(e)},3e3);if(!this.CusId)return this.$message.error("没有输入供应商！"),!1;if(!this.ReturnType)return this.$message.error("没有选择退货方式！"),!1;if(0==this.MachineReturnGoodDtos.length)return this.$message.error("没有选择退货设备！"),!1;var a={RelatedMSOCode:this.RelatedMSOCode,RelatedMPOCode:this.RelatedMPOCode,TotalAmount:this.TotalAmount,ReturnType:"退货退款"==this.ReturnType?1:2,Memo:this.Memo,CusId:this.CusId,MachineReturnGoodDtos:this.MachineReturnGoodDtos};this.API_POST("MachineSO/AddMacReturn",a).then(function(){t.$message({message:"创建成功！",type:"success"}),t.$router.push({path:"/MachineReturn"}),t.$emit("refresh")})},querySearch:function(t,e){if(console.log(t),void 0==t)return t="",!1;""==t&&(t="北京");var a={search:t};this.API_GET("CRM/GetCustomerMini",a).then(function(t){if(console.log(t.Dtos),0===t.Dtos.length)return e([]),!1;var a=t.Dtos.map(function(t){return n()({},t,{value:t.FullName})});e(a)})},handleSelect:function(t){console.log(t),this.CusId=t.CusId},del:function(t){var e=this;this.tableData.forEach(function(a,o){a.ID===t.ID&&e.tableData.splice(o,1)})}},created:function(){},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"box_s"},[a("div",{staticClass:"retrieve"},[a("span",{staticClass:"retrieveSpan"},[t._v("创建整机退货")]),t._v(" "),a("saxo-button",{staticStyle:{float:"right"},attrs:{type:"success",mini:""},on:{click:function(e){return t.Create()}}},[t._v("创 建")])],1),t._v(" "),a("div",{staticClass:"From"},[a("span",[t._v("相关销售订单单号")]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容 不必填"},model:{value:t.RelatedMSOCode,callback:function(e){t.RelatedMSOCode=e},expression:"RelatedMSOCode"}})],1),t._v(" "),a("div",{staticClass:"From"},[a("span",[t._v("相关采购订单单号")]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容 不必填"},model:{value:t.RelatedMPOCode,callback:function(e){t.RelatedMPOCode=e},expression:"RelatedMPOCode"}})],1),t._v(" "),a("div",{staticClass:"From"},[a("span",[t._v("供应商")]),t._v(" "),a("el-autocomplete",{attrs:{"fetch-suggestions":t.querySearch,placeholder:"点击选择供应商"},on:{select:t.handleSelect},model:{value:t.Kehu,callback:function(e){t.Kehu=e},expression:"Kehu"}})],1),t._v(" "),a("div",{staticClass:"From"},[a("span",[t._v("退货金额")]),t._v(" "),a("el-input",{attrs:{placeholder:"不可编辑 添加设备自动计算",disabled:""},model:{value:t.TotalAmount.toFixed(2),callback:function(e){t.$set(t.TotalAmount,"toFixed(2)",e)},expression:"TotalAmount.toFixed(2)"}})],1),t._v(" "),a("div",{staticClass:"From"},[a("span",[t._v("退货方式")]),t._v(" "),a("el-select",{staticStyle:{width:"300px",marginTop:"5px"},attrs:{placeholder:"请选择退货方式",clearable:""},model:{value:t.ReturnType,callback:function(e){t.ReturnType=e},expression:"ReturnType"}},t._l(t.options,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),a("div",{staticClass:"From"},[a("span",[t._v("备注")]),t._v(" "),a("el-input",{attrs:{type:"textarea",placeholder:"请输入备注 不必填",autosize:{minRows:2,maxRows:4}},model:{value:t.Memo,callback:function(e){t.Memo=e},expression:"Memo"}})],1),t._v(" "),a("br"),t._v(" "),a("div",{staticClass:"tableBox"},[a("div",{staticClass:"el-descriptions__title"},[t._v("设备清单\n            "),a("saxo-button",{staticStyle:{float:"right","margin-right":"10px"},attrs:{mini:"",type:"success"},on:{click:function(e){return t.ShowFalse(!0)}}},[t._v("添加")])],1),t._v(" "),a("br"),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,"header-cell-style":t.headerCellStyle2,"cell-style":t.cellStyle,stripe:""}},[a("el-table-column",{attrs:{label:"序号",type:"index",width:"50"}}),t._v(" "),a("el-table-column",{attrs:{prop:"ProductCode",label:"产品编号",width:"170"}}),t._v(" "),a("el-table-column",{attrs:{prop:"BarcodeMemo",label:"内部编码",width:"140"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Manufacturer",label:"品牌",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Characteristics",label:"产品描述","show-overflow-tooltip":!0}}),t._v(" "),a("el-table-column",{attrs:{label:"退货单价",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},model:{value:e.row.UnitPrice,callback:function(a){t.$set(e.row,"UnitPrice",a)},expression:"scope.row.UnitPrice"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"数量",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{attrs:{id:"Number_input"}},[a("div",{staticClass:"div_icon_text",on:{click:function(t){e.row.Quantity>1&&(e.row.Quantity=Number(e.row.Quantity)-1)}}},[a("i",{staticClass:"el-icon-minus"})]),t._v(" "),a("div",{staticClass:"div_icon_textConter"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.row.Quantity,expression:"scope.row.Quantity"}],staticStyle:{"text-align":"center","border-style":"none",outline:"none",width:"100%"},attrs:{type:"text"},domProps:{value:e.row.Quantity},on:{input:function(a){a.target.composing||t.$set(e.row,"Quantity",a.target.value)}}})]),t._v(" "),a("div",{staticClass:"div_icon_text",on:{click:function(t){e.row.Quantity=Number(e.row.Quantity)+1}}},[a("i",{staticClass:"el-icon-plus"})])])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("saxo-button",{attrs:{type:"danger",mini:""},on:{click:function(a){return t.del(e.row)}}},[t._v("删除")])]}}])})],1)],1),t._v(" "),a("div",{staticClass:"From",staticStyle:{width:"340px",float:"right"}},[a("span",[t._v("退货金额")]),t._v(" "),a("span",{staticStyle:{"line-height":"50px"}},[t._v(t._s(t.TotalAmount.toFixed(2)))])]),t._v(" "),a("DeviceDatabase",{attrs:{protype:"6",show:t.DeviceDatabaseShow},on:{ShowFalse:t.ShowFalse,DataBase:t.DataBase}})],1)},staticRenderFns:[]};var d=a("VU/8")(c,u,!1,function(t){a("NgFu")},"data-v-3805f8a6",null);e.default=d.exports},NgFu:function(t,e){}});