webpackJsonp([48],{"5y6u":function(t,e){},w3Pk:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("Dd8w"),s=a.n(n),i={data:function(){return{CusFullName:"",CusId:"",contacts:{},Belong:"",ConrtractType:"",MaintainCode:"",query:{}}},computed:{},watch:{},methods:{Create:function(){if(!this.CusId)return this.$message.warning("请输入客户！"),!1;if(!this.contacts.Name)return this.$message.warning("请输入联系人！"),!1;if(!this.MaintainCode)return this.$message.warning("请输入合同编号！"),!1;if(!this.Belong)return this.$message.warning("请选择隶属公司！"),!1;if(!this.ConrtractType)return this.$message.warning("请选择合同类型！"),!1;var t=this.MaintainCode.substring(this.MaintainCode.length-2);if((1==this.ConrtractType?"AS":"MC")!=t)return this.$message.warning("合同编号的尾部需与合同类型一致！"),!1;this.CreateMC()},CreateMC:function(){var t=this,e={OldMaintainId:this.query.Id||"",CusId:this.CusId,LinkMan:this.contacts.Name,LinkManEngilsh:this.contacts.NameEn,Mobile:this.contacts.Mobile,Belong:1==this.Belong?"技术公司":"服务公司",ConrtractType:1==this.ConrtractType?"AS":"MC",MaintainCode:this.MaintainCode};this.API_POST(this.query.Id?"Maintain/CopyMaintain":"Maintain/CreateMC",e).then(function(e){t.$message.success("创建成功！"),t.$emit("refresh"),t.$router.push({path:"/MaintenanceManagement"})})},querySearch:function(t,e){!t&&(t="北京");var a={search:t};this.API_GET("CRM/GetCustomerMini",a).then(function(t){for(var a=[],n=0;n<t.Dtos.length;n++)t.Dtos[n].value=t.Dtos[n].FullName,a.push(t.Dtos[n]);e(a)})},querySearchs:function(t,e){if(""==this.CusId)return!1;var a={cusId:this.CusId};this.API_GET("CRM/GetCusLinkManMini",a).then(function(t){var a=t.Dtos.map(function(t){return s()({},t,{value:t.Name})});e(a)})},handleSelects:function(t){console.log(t),this.contacts=t},handleSelect:function(t){this.CusId=t.CusId}},created:function(){console.log(this.$route.query),this.query=this.$route.query,this.CusFullName=this.query.CusFullName,this.CusId=this.query.CusId},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"box_s"},[a("div",{staticClass:"retrieve"},[a("span",{staticClass:"retrieveSpan"},[t._v("创建保养合同\n      "),t.query.CusFullName?a("span",[t._v("   (复制-"+t._s(t.query.CusFullName)+"-"+t._s(t.query.MaintainCode)+")")]):t._e()]),t._v(" "),a("saxo-button",{staticStyle:{float:"right"},attrs:{type:"success",mini:""},on:{click:function(e){return t.Create()}}},[t._v("创 建")])],1),t._v(" "),a("div",{staticClass:"From"},[a("span",[t._v("客户名称")]),t._v(" "),a("el-autocomplete",{attrs:{"fetch-suggestions":t.querySearch,placeholder:"请输入内容"},on:{select:t.handleSelect},model:{value:t.CusFullName,callback:function(e){t.CusFullName=e},expression:"CusFullName"}})],1),t._v(" "),a("div",{staticClass:"From"},[a("span",[t._v("联系人")]),t._v(" "),a("el-autocomplete",{attrs:{"fetch-suggestions":t.querySearchs,placeholder:"请输入内容"},on:{select:t.handleSelects},model:{value:t.contacts.Name,callback:function(e){t.$set(t.contacts,"Name",e)},expression:"contacts.Name"}})],1),t._v(" "),a("div",{staticClass:"From"},[a("span",[t._v("英文名")]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.contacts.NameEn,callback:function(e){t.$set(t.contacts,"NameEn",e)},expression:"contacts.NameEn"}})],1),t._v(" "),a("div",{staticClass:"From"},[a("span",[t._v("手机")]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.contacts.Mobile,callback:function(e){t.$set(t.contacts,"Mobile",e)},expression:"contacts.Mobile"}})],1),t._v(" "),a("div",{staticClass:"From"},[a("span",[t._v("合同编号")]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.MaintainCode,callback:function(e){t.MaintainCode=e},expression:"MaintainCode"}})],1),t._v(" "),a("div",{staticClass:"From"},[a("span",[t._v("隶属公司")]),t._v(" "),a("el-radio-group",{model:{value:t.Belong,callback:function(e){t.Belong=e},expression:"Belong"}},[a("el-radio",{attrs:{label:1}},[t._v("技术公司")]),t._v(" "),a("el-radio",{attrs:{label:2}},[t._v("服务公司")])],1)],1),t._v(" "),a("div",{staticClass:"From"},[a("span",[t._v("合同类型")]),t._v(" "),a("el-radio-group",{model:{value:t.ConrtractType,callback:function(e){t.ConrtractType=e},expression:"ConrtractType"}},[a("el-radio",{attrs:{label:1}},[t._v("AS")]),t._v(" "),a("el-radio",{attrs:{label:2}},[t._v("MC")])],1)],1)])},staticRenderFns:[]};var r=a("VU/8")(i,o,!1,function(t){a("5y6u")},"data-v-cc68e0be",null);e.default=r.exports}});