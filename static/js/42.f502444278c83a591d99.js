webpackJsonp([42],{"9Jl+":function(t,e){},CicW:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("pFYg"),a=n.n(o),l=n("gSQJ"),s=n("t4zo"),i=n.n(s),r=n("uXZL"),c=n.n(r),u={data:function(){return{checked:!1,EngineerList:[],tableData:[],IDShow:"",drawer:!1,RightViewData:{},chooseQ:!1,dialogVisible:!1,year:""}},components:{jdSelect:l.a},computed:{},watch:{},methods:{chooseQX:function(t){t||(this.tableData=[]);for(var e=0;e<this.EngineerList.length;e++){this.EngineerList[e].show=t}this.chooseQ=t;for(var n=0;n<this.EngineerList.length;n++){var o=this.EngineerList[n];o.show&&this.EngineerSOQuarterBonus(o)}},handleClick:function(t){console.log(t),this.drawer=!0,this.RightViewData=t},handleClose:function(t){this.$confirm("确认关闭？").then(function(e){t()}).catch(function(t){})},GetEmployeeMini:function(){var t=this,e={api:"get",url:this.$store.state.http+"System/GetEmployeeMini",data:{type:5}};this.$https(e).then(function(e){console.log(e.Data),t.EngineerList=e.Data;for(var n=0;n<t.EngineerList.length;n++){var o=t.EngineerList[n];t.$set(o,"show",!1)}})},choose:function(t){this.EngineerList[t].show=!0},AtTime:function(t){for(var e=[],n=0;n<this.EngineerList.length;n++){var o=this.EngineerList[n];o.show&&e.push(o)}console.log(e),this.check(e)},check:function(t){var e=this;if(0==this.tableData.length)this.EngineerSOQuarterBonus(t[0]),console.log("第一种情况 初始表格没数据");else if(0==t.length)console.log("格已有数据  但传来了空集合"),this.tableData=[];else{console.log("格已有数据  传来了数据");for(var n=0;n<t.length;n++){var o=t[n];-1==this.IDShow.indexOf(o.EmployeeId)?(this.EngineerSOQuarterBonus(o),console.log("添加"+o.ChineseName)):console.log("已有"+o.ChineseName)}for(var l=function(n){var o=e.tableData[n];if(i=!0,t.forEach(function(t){t.UserName==o.UserName&&(console.log("没有删除"),i=!1)}),i){e.tableData.splice(n,1),e.IDShow="";for(var a=0;a<t.length;a++)e.IDShow+=String(t[a].EmployeeId)+"-";return console.log(e.IDShow),{v:!1}}},s=0;s<this.tableData.length;s++){var i,r=l(s);if("object"===(void 0===r?"undefined":a()(r)))return r.v}}this.IDShow="";for(var c=0;c<t.length;c++)this.IDShow+=String(t[c].EmployeeId)+"-";console.log(this.IDShow)},EngineerSOQuarterBonus:function(t){var e=this,n={api:"get",url:this.$store.state.http+"Finance/EngineerMCYearBonus",data:{username:t.UserName,year:this.year}};this.$https(n).then(function(n){var o=n.Data;if(o.UserName=t.UserName,o.AsSales=o.Bonus.AsSales,o.SoSales=o.Bonus.SoSales,o.Area=o.EmployeeInfo.Area,o.Proportion=o.Bonus.Proportion,o.BonusAmount=o.Bonus.BonusAmount,o.BeforeSoSales=o.Bonus.BeforeSoSales,o.ChineseName=o.EmployeeInfo.ChineseName,o.PersonalSoSales=o.Bonus.PersonalSoSales,console.log(o),e.tableData.push(n.Data),console.log(e.tableData),0!=e.tableData.length){var a={};e.tableData=e.tableData.reduce(function(t,e){return!a[e.UserName]&&(a[e.UserName]=t.push(e)),t},[])}})},exportExcelTo:function(t){var e=c.a.utils.table_to_book(document.querySelector(t),{raw:!0}),n=c.a.write(e,{bookType:"xlsx",bookSST:!0,type:"array"});try{i.a.saveAs(new Blob([n],{type:"application/octet-stream"}),"未命名.xlsx")}catch(t){"undefined"!=typeof console&&console.log(t,n)}return n},exportEnumeration:function(){if(0==this.tableData.length)return this.$message.error("没有选择数据！"),!1;var t="width:165px;height:40px;line-height:40px;",e="";this.tableData.forEach(function(n){var o="display: block;width: 400px;float: left;",a="\n                    <tr>\n                        <td  colspan='10' style='"+t+"'>\n                            <h2>\n                                <span style='"+o+"'>"+n.ChineseName+"</span>\n                                <span style='"+o+"'>"+n.Area+"</span>\n                                <span style='"+o+"'>个人销售额:"+n.PersonalSoSales+"</span>\n                            </h2>    \n                        </td>\n                    </tr>\n                ",l="";l+="\n                            <tr>\n                                <td style='"+t+"'></td>\n                                <td style='"+t+"width:500px;font-weight:bolder;'>客户</td>                        \n                                <td style='"+t+"font-weight:bolder;'>报价单号</td>                        \n                                <td style='"+t+"font-weight:bolder;'>优惠总金额</td>                        \n                                <td style='"+t+"font-weight:bolder;'>退货金额</td>                        \n                                <td style='"+t+"font-weight:bolder;'>返点金额</td>                        \n                                <td style='"+t+"font-weight:bolder;'>区域</td>                        \n                                <td style='"+t+"font-weight:bolder;'>比例</td>                        \n                                <td style='"+t+"font-weight:bolder;'>占比</td>                        \n                                <td style='"+t+"font-weight:bolder;'>销售</td>                        \n                            </tr>\n                    ",n.PersonalSOSalesDtos.forEach(function(e){l+="\n                            <tr>\n                                <td style='"+t+"'></td>\n                                <td style='"+t+"width:500px'>"+e.CusFullName+"</td>                        \n                                <td style='"+t+"width:300px'>"+e.ContractCode+"</td>                        \n                                <td style='"+t+"'>"+e.DiscountAmount+"</td>                        \n                                <td style='"+t+"'>"+e.ReturnedPurchaseAmount+"</td>                        \n                                <td style='"+t+"'>"+e.RebateAmount+"</td>                        \n                                <td style='"+t+"'>"+e.Area+"</td>                        \n                                <td style='"+t+"'>"+e.Proportion+"</td>                                            \n                                <td style='"+t+"'>"+parseInt(100/e.OtherInt)+"%</td>   \n                                <td style='"+t+"'>"+e.Sales+"</td>                                                                                     \n                            </tr>\n                    "}),e+=a+l});var n='\n\t\t\t<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">\n                \n                <head>\n                    <meta charset="utf-8">\n                </head>\n\n                <body>\n                    <table border=1 style="font-family: "宋体";">\n                        <tr>    \n                            <td colspan=\'10\' style=\'text-align: center;height:100px;line-height:90px;color:#0000ff;font-size:40px;padding-left:180px;box-sizing:border-box;font-family:宋体;font-weight:bolder;\'>\n                                <p>工程师大包年度奖金 明细</p>\n                            </td>\n                        </tr>\n\n                        '+e+"\n\n            \n\n\n                \n\n                    </table>\n                </body>\n\t\t\t</html>",o=document.createElement("a");o.download="工程师大包年度奖金_明细.xls",o.href="data:application/vnd.ms-excel;base64,"+window.btoa(unescape(encodeURIComponent(n))),document.body.appendChild(o),o.click(),document.body.removeChild(o)}},created:function(){this.GetEmployeeMini();var t=new Date;this.year=String(t.getFullYear())},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},h={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"box_s"},[n("div",{staticClass:"Left"},[n("el-date-picker",{staticStyle:{width:"100%",marginBottom:"20px"},attrs:{type:"year",size:"mini",placeholder:"选择年","value-format":"yyyy"},model:{value:t.year,callback:function(e){t.year=e},expression:"year"}}),t._v(" "),n("el-checkbox",{on:{change:t.chooseQX},model:{value:t.chooseQ,callback:function(e){t.chooseQ=e},expression:"chooseQ"}},[n("span",{staticStyle:{color:"#409EFF","font-weight":"bold"}},[t._v("全选")])]),t._v(" "),t._l(t.EngineerList,function(e,o){return n("el-checkbox",{key:o,on:{click:function(e){return t.choose(o)},change:t.AtTime},model:{value:e.show,callback:function(n){t.$set(e,"show",n)},expression:"item.show"}},[n("div",{staticStyle:{width:"80px",float:"left"}},[t._v(t._s(e.Area)+" ")]),t._v("\n            "+t._s(e.Name)+"\n        ")])})],2),t._v(" "),n("div",{staticClass:"Right"},[n("el-button",{staticStyle:{float:"right","margin-left":"20px"},attrs:{type:"info",size:"mini"},on:{click:function(e){return t.exportEnumeration()}}},[t._v("打印明细")]),t._v(" "),n("el-button",{staticStyle:{float:"right"},attrs:{type:"info",size:"mini"},on:{click:function(e){return t.exportExcelTo("#out-table")}}},[t._v("打 印")]),t._v(" "),n("saxo-pop",{ref:"primary",attrs:{type:"primary",title:"工程师大包年度奖金",width:"800px"},on:{close:function(e){return t.$refs.primary.start()}}},[n("h1",[t._v("工程师大包年度奖金")]),t._v(" "),n("br"),t._v(" "),n("p",[n("span",{staticClass:"spanTxt"},[t._v("1、")]),t._v(" 大包来源：隶属于自己且付款日期(财务操作付款的日期)在当前年的大包付款单")]),t._v(" "),n("p",[n("span",{staticClass:"spanTxt"},[t._v("2、")]),t._v(" 计算方式：\n                "),n("br")]),n("p",{staticStyle:{"text-indent":"36px"}},[t._v("2.1 宝马-根据区域达到的大包家数计算奖金比例 * 自己的有效销售额")]),t._v(" "),n("p",{staticStyle:{"text-indent":"36px"}},[t._v("2.2 保时捷-事先设置好的奖金比例 * 自己的有效销售额")]),t._v(" "),n("p"),t._v(" "),n("p",[n("span",{staticClass:"spanTxt"},[t._v("3、")]),t._v(" 有效销售额：单个大包的有效销售额 = 付款总金额 - 返点额")]),t._v(" "),n("p",[n("span",{staticClass:"spanTxt"},[t._v("4、")]),t._v(" 统计日期：上一年的最后一个月的26号(含) 至 本年的最后一个月的25号(含)")])]),t._v(" "),n("el-button",{staticStyle:{float:"right",marginRight:"10px"},attrs:{type:"info",size:"mini"},on:{click:function(e){return t.$refs.primary.start()}}},[t._v("查看奖金配置")]),t._v(" "),n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,size:"mini",id:"out-table","default-sort":{prop:"Area",order:"descending"}}},[n("el-table-column",{attrs:{label:"",width:"70px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                    "+t._s(e.$index+1)+"\n                ")]}}])}),t._v(" "),n("el-table-column",{attrs:{sortable:"",prop:"ChineseName",label:"姓名",width:"180"}}),t._v(" "),n("el-table-column",{attrs:{sortable:"",prop:"Area",label:"区域",width:"180"}}),t._v(" "),n("el-table-column",{attrs:{sortable:"",prop:"SoSales",label:"区域销售额",width:"180"}}),t._v(" "),n("el-table-column",{attrs:{sortable:"",prop:"PersonalSoSales",label:"个人销售额"}}),t._v(" "),n("el-table-column",{attrs:{sortable:"",prop:"BonusAmount",label:"最终奖金"}}),t._v(" "),n("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(n){return t.handleClick(e.row)}}},[t._v("明细")])]}}])})],1)],1),t._v(" "),n("el-drawer",{attrs:{visible:t.drawer,"with-header":!1,"modal-append-to-body":!1,size:"50%"},on:{"update:visible":function(e){t.drawer=e}}},[n("div",{staticClass:"rightView"},[n("h2",[t._v(t._s(t.RightViewData.ChineseName)+" "),n("span",{staticStyle:{fontSize:"12px"}},[t._v(t._s(t.RightViewData.Area))])]),t._v(" "),n("br"),t._v(" "),n("p",[t._v("区域销售额 "+t._s(t.RightViewData.SoSales))]),t._v(" "),n("el-button",{staticStyle:{float:"right"},attrs:{type:"info",size:"mini"},on:{click:function(e){return t.exportExcelTo("#out-table2")}}},[t._v("打 印")]),t._v(" "),n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.RightViewData.SOSalesDtos,size:"mini",id:"out-table2"}},[n("el-table-column",{attrs:{prop:"CusFullName",label:"客户","show-overflow-tooltip":!0}}),t._v(" "),n("el-table-column",{attrs:{prop:"ContractCode",label:"报价单号",width:"200"}}),t._v(" "),n("el-table-column",{attrs:{prop:"DiscountAmount",label:"优惠总金额",width:"100"}}),t._v(" "),n("el-table-column",{attrs:{prop:"ReturnedPurchaseAmount",label:"退货金额",width:"100"}}),t._v(" "),n("el-table-column",{attrs:{prop:"RebateAmount",label:"返点金额",width:"100"}}),t._v(" "),n("el-table-column",{attrs:{prop:"Sales",label:"销售",width:"100"}})],1),n("br"),t._v(" "),n("p",[t._v("个人销售额 "+t._s(t.RightViewData.PersonalSoSales))]),t._v(" "),n("el-button",{staticStyle:{float:"right"},attrs:{type:"info",size:"mini"},on:{click:function(e){return t.exportExcelTo("#out-table4")}}},[t._v("打 印")]),t._v(" "),n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.RightViewData.PersonalSOSalesDtos,size:"mini",id:"out-table4"}},[n("el-table-column",{attrs:{prop:"CusFullName",label:"客户","show-overflow-tooltip":!0}}),t._v(" "),n("el-table-column",{attrs:{prop:"ContractCode",label:"报价单号",width:"200"}}),t._v(" "),n("el-table-column",{attrs:{prop:"DiscountAmount",label:"优惠总金额",width:"80"}}),t._v(" "),n("el-table-column",{attrs:{prop:"ReturnedPurchaseAmount",label:"退货金额",width:"80"}}),t._v(" "),n("el-table-column",{attrs:{prop:"RebateAmount",label:"返点金额",width:"80"}}),t._v(" "),n("el-table-column",{attrs:{prop:"Area",label:"区域",width:"80"}}),t._v(" "),n("el-table-column",{attrs:{prop:"Proportion",label:"比例",width:"80"}}),t._v(" "),n("el-table-column",{attrs:{label:"占比",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                        "+t._s(parseInt(100/e.row.OtherInt)+"%")+"\n                    ")]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"Sales",label:"销售",width:"100"}})],1),n("br"),t._v(" "),n("p",[t._v("奖金比例配置 ")]),t._v(" "),n("el-button",{staticStyle:{float:"right"},attrs:{type:"info",size:"mini"},on:{click:function(e){return t.exportExcelTo("#out-table6")}}},[t._v("打 印")]),t._v(" "),n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.RightViewData.BonusConfigDtos,size:"mini",id:"out-table6"}},[n("el-table-column",{attrs:{label:"到达档位"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.Selectd?n("i",{staticClass:"el-icon-check",staticStyle:{color:"#67C23A",fontWeight:"bold"}}):t._e()]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"Proportion",label:"比例"}}),t._v(" "),n("el-table-column",{attrs:{prop:"Price",label:"金额"}}),t._v(" "),n("el-table-column",{attrs:{prop:"BonusDate",label:"年份"}}),t._v(" "),n("el-table-column",{attrs:{prop:"Area",label:"区域"}})],1),n("br")],1)])],1)},staticRenderFns:[]};var d=n("VU/8")(u,h,!1,function(t){n("9Jl+")},"data-v-e09a15e4",null);e.default=d.exports}});