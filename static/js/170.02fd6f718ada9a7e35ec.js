webpackJsonp([170],{a6QW:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("mvHQ"),s=i.n(n),a={name:"",data:function(){return{tags:[],Engineerlist:[],Engineerlist2:[],Engineerlist3:[],EngineerName:"",pageNum:1,pagesize:10,search:"",enginner:"",area:"",state:"",areaS:[],sale:"",CustomerType:"",options:[{label:"临时创建",value:"0",index:2},{label:"已编辑",value:1,index:3},{label:"已报价",value:2,index:4},{label:"已确认",value:3,index:5},{label:"已付款",value:8,index:10},{label:"已发货",value:4,index:6},{label:"已收货",value:5,index:7},{label:"已结单",value:6,index:8},{label:"已撤单",value:7,index:9}],total:0,Data:[],optionss:[],loading:!1,value:"",dialogFormVisible:!1,SOId:"",ddd:0}},created:function(){this.pagesize=this.$store.state.DisplayNumber,this.init(),this.initGetArea(),this.EngineerlistGet()},components:{},methods:{DeleteEngineer:function(t){for(var e=0;e<this.tags.length;e++){var i=this.tags[e];i.Key==t.Key&&(this.tags.splice(e,1),this.Engineerlist2.push(i))}},EngineerlistGet:function(){var t=this,e={api:"get",url:this.$store.state.http+"System/GetEmployeeMini",data:{type:"2",search:""}};this.$https(e).then(function(e){t.Engineerlist=[];for(var i=0;i<e.Data.length;i++){var n=e.Data[i];t.Engineerlist.push({Key:n.UserName,Value:n.Name})}console.log(t.Engineerlist)})},userGCS:function(t){if(console.log(t),this.tags=t.BelongEnginnerUserNames,this.SOId=t.SOId,this.dialogFormVisible=!0,this.Engineerlist2=JSON.parse(s()(this.Engineerlist)),this.Engineerlist3=JSON.parse(s()(this.Engineerlist)),null!=this.tags)for(var e=0;e<this.tags.length;e++){var i=this.tags[e];console.log(i);for(var n=0;n<this.Engineerlist2.length;n++){this.Engineerlist2[n].Key==i.Key&&this.Engineerlist2.splice(n,1)}}this.Engineerlist3=this.Engineerlist2},INEngineer:function(t){if(""==t)return this.Engineerlist3=this.Engineerlist2,!1;for(var e=[],i=0;i<this.Engineerlist2.length;i++){var n=this.Engineerlist2[i];-1==n.Key.indexOf(t)&&-1==n.Value.indexOf(t)||e.push(n)}this.Engineerlist3=e},XzEngineer:function(t){console.log(t),null==this.tags&&(this.tags=[]),this.tags.push(t);for(var e=0;e<this.Engineerlist3.length;e++){this.Engineerlist3[e].Key==t.Key&&this.Engineerlist3.splice(e,1)}},UploadEngineer:function(){var t=this;if(console.log(this.tags),0==this.tags.length)return this.$message.warning("未选择隶属工程师！"),!1;for(var e="",i=0;i<this.tags.length;i++)console.log(this.tags[i]),e+=""==e?this.tags[i].Key:","+this.tags[i].Key;console.log(e);var n={api:"post",url:this.$store.state.http+"SO/SelectEnginnerToSo",data:{SOId:this.SOId,SubEnginnerGroup:e}};this.$https(n).then(function(e){t.dialogFormVisible=!1,t.value="",t.init()})},focuss:function(){console.log(this.ddd),0==this.ddd&&(this.remoteMethod(),this.ddd=1)},blurs:function(){this.ddd=0},remoteMethod:function(t){var e=this;console.log(t),""==t&&(t="x"),this.loading=!0;var i={api:"get",url:this.$store.state.http+"System/GetEmployeeMini",data:{type:"2",search:t}};this.$https(i).then(function(t){console.log(t),e.optionss=t.Data;for(var i=0;i<e.optionss.length;i++){var n=e.optionss[i];n.names=n.Name+" - "+n.UserName}e.loading=!1})},dialogFormVisibleTrueQK:function(){var t=this,e={api:"post",url:this.$store.state.http+"SO/SelectEnginnerToSo",data:{SOId:this.SOId,SubEnginnerGroup:""}};this.$https(e).then(function(e){t.dialogFormVisible=!1,t.value="",t.init()})},dialogFormVisibleTrue:function(){var t=this;if(console.log(this.value),0==this.value.length)return this.$message.warning("未选择隶属工程师！"),!1;for(var e="",i=0;i<this.value.length;i++)console.log(this.value[i]),""==e?e=this.value[i]:e+=","+this.value[i];console.log(e);var n={api:"post",url:this.$store.state.http+"SO/SelectEnginnerToSo",data:{SOId:this.SOId,SubEnginnerGroup:e}};this.$https(n).then(function(e){t.dialogFormVisible=!1,t.value="",t.init()})},dialogFormVisibles:function(){this.dialogFormVisible=!1,this.value=""},routes:function(t){console.log(t),this.$store.state.Vuex.SOId=t.SOId,this.$router.push({path:"/EditOrder"})},init:function(t){var e=this;1==t&&(this.pageNum=1);var i=this.state;i=""==i?-1:i;var n={api:"get",url:this.$store.state.http+"SO/GetSOForPCs",data:{pageNum:this.pageNum,numPerPage:this.pagesize,orderField:"",orderDirection:"",search:this.search,enginner:this.enginner,area:this.area,state:i,cusType:this.CustomerType,sale:this.sale}};this.$https(n).then(function(t){console.log(t),e.total=t.Data.DataBars,e.Data=t.Data.Dtos,e.Data.forEach(function(t){t.CreateDateStr=t.CreateDateStr.split(" ")[0]})})},initGetArea:function(){var t=this,e={url:this.$store.state.http+"System/GetArea",api:"get"};this.$https(e).then(function(e){t.areaS=e.Data})},func:function(t,e){this.pagesize=t,this.pageNum=e,this.init()},AddOrder:function(){this.$router.push({path:"/AddOrder"})}}},l={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"box"},[i("router-view",{on:{refresh:t.init}}),t._v(" "),i("div",{staticClass:"TopSerch",staticStyle:{padding:"5px"}},[i("el-input",{staticStyle:{width:"193px"},attrs:{size:"mini",placeholder:"请输入客户、单号、报价单号"},on:{change:function(e){return t.init(1)}},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),t._v(" "),i("el-input",{staticStyle:{width:"193px"},attrs:{size:"mini",placeholder:"请输入工程师"},on:{change:function(e){return t.init(1)}},model:{value:t.enginner,callback:function(e){t.enginner=e},expression:"enginner"}}),t._v(" "),i("el-input",{staticStyle:{width:"193px"},attrs:{size:"mini",placeholder:"请输入销售"},on:{change:function(e){return t.init(1)}},model:{value:t.sale,callback:function(e){t.sale=e},expression:"sale"}}),t._v(" "),i("el-select",{staticStyle:{width:"150px"},attrs:{size:"mini",placeholder:"请选择状态",clearable:""},on:{change:function(e){return t.init(1)}},model:{value:t.state,callback:function(e){t.state=e},expression:"state"}},t._l(t.options,function(t){return i("el-option",{key:t.index,attrs:{label:t.label,value:t.value}})}),1),t._v(" "),i("el-select",{staticStyle:{width:"120px"},attrs:{size:"mini",clearable:"",placeholder:"请选择区域"},on:{change:function(e){return t.init(1)}},model:{value:t.area,callback:function(e){t.area=e},expression:"area"}},t._l(t.areaS,function(t){return i("el-option",{key:t.Value,attrs:{label:t.Value,value:t.Value}})}),1),t._v(" "),i("el-select",{staticStyle:{width:"140px"},attrs:{size:"mini",clearable:"",placeholder:"请选择客户类型"},on:{change:function(e){return t.init(1)}},model:{value:t.CustomerType,callback:function(e){t.CustomerType=e},expression:"CustomerType"}},t._l(this.$store.state.Vuex.CustomerTypes,function(t){return i("el-option",{key:t+"2",attrs:{label:t,value:t}})}),1),t._v(" "),i("el-button",{attrs:{type:"primary",loading:this.$store.state.Vuex.loading,size:"mini"},on:{click:function(e){return t.init(1)}}},[t._v("检索")]),t._v(" "),i("el-button",{staticStyle:{float:"right"},attrs:{type:"success",size:"mini"},on:{click:function(e){return t.AddOrder()}}},[t._v("创建")])],1),t._v(" "),i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.Data,size:"mini",height:this.$store.state.TableOptimumHeight,"highlight-current-row":"",border:"","header-cell-style":{background:"#e1e1e1"}}},[i("el-table-column",{attrs:{prop:"CusName",label:"客户名","show-overflow-tooltip":!0}}),t._v(" "),i("el-table-column",{attrs:{prop:"Amount",label:"总金额",width:"90"}}),t._v(" "),i("el-table-column",{attrs:{prop:"DiscountAmount",label:"优惠价格",width:"90"}}),t._v(" "),i("el-table-column",{attrs:{prop:"LogisticCharge",label:"物流费",width:"70"}}),t._v(" "),i("el-table-column",{attrs:{prop:"StateStr",label:"状态",width:"90"}}),t._v(" "),i("el-table-column",{attrs:{prop:"PayStatusStr",label:"付款",width:"90"}}),t._v(" "),i("el-table-column",{attrs:{prop:"CreateDateStr",label:"创建日期",width:"90"}}),t._v(" "),i("el-table-column",{attrs:{prop:"SendDateStr",label:"末次发货",width:"90"}}),t._v(" "),i("el-table-column",{attrs:{prop:"Area",label:"区域",width:"100"}}),t._v(" "),i("el-table-column",{attrs:{prop:"SOCode",label:"订单编号",width:"200"}}),t._v(" "),i("el-table-column",{attrs:{prop:"BelongEnginners",label:"隶属工程师","show-overflow-tooltip":!0,width:"100"}}),t._v(" "),i("el-table-column",{attrs:{prop:"Sales",label:"隶属销售","show-overflow-tooltip":!0,width:"80"}}),t._v(" "),i("el-table-column",{attrs:{fixed:"right",label:"操作",width:"130"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-edit"},on:{click:function(i){return t.routes(e.row)}}}),t._v(" "),i("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-user"},on:{click:function(i){return t.userGCS(e.row)}}})]}}])})],1),t._v(" "),i("SaxoFenYe",{attrs:{total:t.total},on:{func:t.func}}),t._v(" "),i("el-dialog",{attrs:{title:"修改隶属工程师",visible:t.dialogFormVisible,"append-to-body":!0},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[i("p",[t._v("已选隶属工程师：")]),t._v(" "),i("br"),t._v(" "),null==this.tags||0==this.tags.length?i("p",{staticClass:"NotSelected"},[t._v("暂未选择工程师")]):t._e(),t._v(" "),null!=t.tags?i("div",t._l(t.tags,function(e){return i("el-tag",{key:e.name,staticStyle:{margin:"5px 5px 0px"},attrs:{closable:"",type:e.type,icon:"el-icon-user"},on:{close:function(i){return t.DeleteEngineer(e)}}},[t._v("\n        "+t._s(e.Value)+"\n      ")])}),1):t._e(),t._v(" "),i("br"),t._v(" "),i("p",[t._v("可选隶属工程师：")]),t._v(" "),i("el-input",{staticStyle:{width:"200px","margin-top":"5px"},attrs:{placeholder:"请输入工程师姓名",size:"mini","prefix-icon":"el-icon-search"},on:{input:t.INEngineer},model:{value:t.EngineerName,callback:function(e){t.EngineerName=e},expression:"EngineerName"}}),t._v(" "),i("div",{staticClass:"Xuan"},t._l(t.Engineerlist3,function(e,n){return i("el-button",{key:n,staticStyle:{margin:"5px"},attrs:{type:"success",icon:"el-icon-circle-plus",plain:"",size:"mini"},on:{click:function(i){return t.XzEngineer(e)}}},[t._v(t._s(e.Value))])}),1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini",type:"danger"},on:{click:t.dialogFormVisibleTrueQK}},[t._v("清 空")]),t._v(" "),i("el-button",{attrs:{size:"mini"},on:{click:t.dialogFormVisibles}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.UploadEngineer}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var r=i("VU/8")(a,l,!1,function(t){i("ifoG")},"data-v-1a73198c",null);e.default=r.exports},ifoG:function(t,e){}});