webpackJsonp([60],{ax3m:function(t,e){},bjp1:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i={name:"",data:function(){return{pageNum:1,pagesize:10,total:0,search:"",state:0,begin:"",end:"",area:"",areaS:[],value1:"",dialogTableVisible:!1,stateType:-1,Data:[],options:[{Name:"全部",ID:0,value:0},{Name:"已创建任务",ID:0,value:1},{Name:"已派送区域经理",ID:0,value:2},{Name:"已指派工程师",ID:0,value:3},{Name:"接接受任务",ID:0,value:4},{Name:"已拒绝",ID:0,value:5},{Name:"已发出",ID:0,value:6},{Name:"已到达",ID:0,value:7},{Name:"已结单",ID:0,value:8}],optionsType:[{Name:"全部",ID:0,value:-1},{Name:"整机安装",ID:0,value:1},{Name:"零配件安装",ID:0,value:2},{Name:"设备拆装服务",ID:0,value:3}],optionss:[],value:[],kehuCusiD:"",loading:!1,UploadEquInstallOrderFile:[]}},created:function(){this.pagesize=this.$store.state.DisplayNumber,this.initdata(),this.initGetArea()},components:{},methods:{initGetArea:function(){var t=this,e={url:this.$store.state.http+"System/GetArea",api:"get"};this.$https(e).then(function(e){t.areaS=e.Data})},cheche:function(t){var e=this;console.log(t);var a={api:"post",url:this.$store.state.http+"WO/CancelEquInstallOrder",data:{Id:t.ID}};this.$https(a).then(function(t){e.initdata()})},initdata:function(){var t=this,e=this.state;""==e&&(e=0);var a={api:"get",url:this.$store.state.http+"WO/GetEquInstallOrders",data:{pageNum:this.pageNum,numPerPage:this.pagesize,orderField:"",orderDirection:"",type:this.stateType,search:this.search,state:e,begin:this.begin,end:this.end,area:this.area}};this.$https(a).then(function(e){t.Data=e.Data.Dtos,t.total=e.Data.DataBars;for(var a=0;a<t.Data.length;a++){var i=t.Data[a];i.CreateDate=t.timeLv(i.CreateDate),i.DeliveryDate=t.timeLv(i.DeliveryDate),i.AcceptDate=t.timeLv(i.AcceptDate),i.GotoDate=t.timeLv(i.GotoDate),i.ArriveDate=t.timeLv(i.ArriveDate),i.CompleteDate=t.timeLv(i.CompleteDate)}})},pick:function(t){console.log(t),null==t?(this.begin="",this.end=""):(this.begin=t[0],this.end=t[1]),this.initdata()},addbs:function(){this.$router.push({path:"/AddOrderindex"})},dialogTableVisiblefalse:function(){this.dialogTableVisible=!1,this.UploadEquInstallOrderFile=[],this.kehuCusiD="",this.value=""},handleClose:function(t){var e=this;this.$confirm("确认关闭？").then(function(a){t(),e.UploadEquInstallOrderFile=[],e.kehuCusiD="",e.value=""}).catch(function(t){})},addtrue:function(){var t=this;console.log(this.kehuCusiD),console.log(this.UploadEquInstallOrderFile),""==this.kehuCusiD&&this.$message.warning("请选择客户！");var e={api:"post",url:this.$store.state.http+"WO/CreateEquInstallOrder",data:{CusId:this.kehuCusiD}};this.$https(e).then(function(e){if(0==t.UploadEquInstallOrderFile.length)return t.$message.success("创建成功未上传附件！"),t.dialogTableVisible=!1,t.UploadEquInstallOrderFile=[],t.kehuCusiD="",t.initdata(),!1;t.$message.success("创建成功正在上传附件！"),t.UploadEquInstallOrderFilefunction(e.Data)})},UploadEquInstallOrderFilefunction:function(t){for(var e=this,a=this.UploadEquInstallOrderFile.length,i=0;i<this.UploadEquInstallOrderFile.length;i++){var l={api:"post",url:this.$store.state.http+"WO/UploadEquInstallOrderFile",data:{Id:t,Str:this.UploadEquInstallOrderFile[i].base64,Type:this.UploadEquInstallOrderFile[i].type}};this.$https(l).then(function(t){0==(a-=1)&&(e.$message.success("创建完成！"),e.dialogTableVisible=!1,e.UploadEquInstallOrderFile=[],e.kehuCusiD="",e.initdata(),e.value="")})}},remoteMethod:function(t){var e=this;console.log(t),""==t&&(t="北京"),this.loading=!0;var a={api:"get",url:this.$store.state.http+"CRM/GetCustomerMini",data:{search:t}};this.$https(a).then(function(t){console.log(t),e.optionss=t.Data.Dtos,e.loading=!1})},CusiD:function(t){console.log(t),this.kehuCusiD=t},getFile:function(t){var e=t.target.files[0];console.log(e);var a=this;if(e){var i=new FileReader;i.readAsDataURL(e),i.onload=function(t){var i=this.result;a.UploadEquInstallOrderFile.push({name:e.name,base64:i,type:"."+e.type.split("/")[1]})}}console.log(a.UploadEquInstallOrderFile)},timeLv:function(t){return null==t||""==t?" - - ":t.split("T")[0]},func:function(t,e){this.pagesize=t,this.pageNum=e,this.initdata()},psgcs:function(t){var e=this;console.log(t.ID);var a={api:"post",url:this.$store.state.http+"WO/SentManageEquInstallOrder",data:{id:t.ID}};this.$https(a).then(function(t){console.log(t),e.initdata()})},lookitem:function(t){this.$store.state.InstallationtasklookID=t.ID,this.$store.state.InstallationtasklookIDState=t.State,this.$router.push({path:"/Installationtasklook"})}}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"box"},[a("router-view",{on:{refresh:t.initdata}}),t._v(" "),a("div",{staticClass:"TopSerch"},[a("el-input",{staticStyle:{width:"193px"},attrs:{size:"mini",placeholder:"请输入客户名称、工程师"},on:{change:function(e){return t.initdata()}},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),t._v(" "),a("el-date-picker",{attrs:{type:"datetimerange",size:"mini","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd","default-time":["12:00:00"]},on:{change:t.pick},model:{value:t.value1,callback:function(e){t.value1=e},expression:"value1"}}),t._v(" "),a("el-select",{staticStyle:{width:"140px"},attrs:{clearable:"",size:"mini",placeholder:"请选择状态"},on:{change:function(e){return t.initdata()}},model:{value:t.state,callback:function(e){t.state=e},expression:"state"}},t._l(t.options,function(t){return a("el-option",{key:t.value,attrs:{label:t.Name,value:t.value}})}),1),t._v(" "),a("el-select",{staticStyle:{width:"120px"},attrs:{clearable:"",size:"mini",placeholder:"请选择类型"},on:{change:function(e){return t.initdata()}},model:{value:t.stateType,callback:function(e){t.stateType=e},expression:"stateType"}},t._l(t.optionsType,function(t){return a("el-option",{key:t.value,attrs:{label:t.Name,value:t.value}})}),1),t._v(" "),a("el-select",{staticStyle:{width:"120px"},attrs:{size:"mini",clearable:"",placeholder:"请选择区域"},on:{change:function(e){return t.initdata(1)}},model:{value:t.area,callback:function(e){t.area=e},expression:"area"}},t._l(t.areaS,function(t){return a("el-option",{key:t.Value+"1",attrs:{label:t.Value,value:t.Value}})}),1),t._v(" "),a("el-button",{attrs:{loading:this.$store.state.Vuex.loading,type:"primary",size:"mini"},on:{click:function(e){return t.initdata()}}},[t._v("检索")]),t._v(" "),a("el-button",{staticStyle:{float:"right"},attrs:{type:"success",size:"mini"},on:{click:function(e){return t.addbs()}}},[t._v("创建")]),t._v(" "),a("el-dialog",{attrs:{title:"创建任务",visible:t.dialogTableVisible,"before-close":t.handleClose},on:{"update:visible":function(e){t.dialogTableVisible=e}}},[a("div",{staticClass:"dial",staticStyle:{width:"100%",height:"350px"}},[a("div",{staticClass:"demo"},[a("div",[t._v("选择客户:")]),t._v(" "),a("el-select",{staticStyle:{width:"300px"},attrs:{filterable:"",remote:"","reserve-keyword":"",placeholder:"请输入关键词","remote-method":t.remoteMethod,loading:t.loading,size:"mini"},on:{change:t.CusiD},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},t._l(t.optionss,function(t){return a("el-option",{key:t.CusId,attrs:{label:t.FullName,value:t.CusId}})}),1)],1),t._v(" "),a("div",{staticClass:"dome2"},[a("div",{staticClass:"leftdiv"},[t._v("上传文件：")]),t._v(" "),a("div",{staticClass:"rightdiv"},[a("el-button",{attrs:{type:"text",size:"mini"}},[a("label",{attrs:{for:"int"}},[t._v("↑ 上传")]),t._v(" "),a("input",{ref:"clearFile",staticStyle:{"margin-left":"70px",display:"none"},attrs:{id:"int",type:"file",accept:".pdf"},on:{change:function(e){return t.getFile(e)}}})]),t._v(" "),t._l(t.UploadEquInstallOrderFile,function(e,i){return a("div",{key:i,staticClass:"work"},[t._v(t._s(i+" - "+e.name))])})],2)])]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){return t.dialogTableVisiblefalse()}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addtrue()}}},[t._v("确 定")])],1)])],1),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.Data,height:this.$store.state.TableOptimumHeight,size:"mini","highlight-current-row":"",border:"","header-cell-style":{background:"#e1e1e1"}}},[a("el-table-column",{attrs:{prop:"CreateDate",label:"创建时间",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Creater",label:"创建者",width:"80"}}),t._v(" "),a("el-table-column",{attrs:{prop:"OrderCode",label:"任务编号",width:"140"}}),t._v(" "),a("el-table-column",{attrs:{prop:"CusFullName",label:"客户","show-overflow-tooltip":!0}}),t._v(" "),a("el-table-column",{attrs:{prop:"TypeStr",label:"任务类型",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"StateStr",label:"当前状态",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"DeliveryDate",label:"指派时间",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"ArriveDate",label:"到达时间",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"CompleteDate",label:"完成时间",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.State?a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return t.lookitem(e.row)}}},[t._v("派送")]):t._e(),t._v(" "),1!=e.row.State?a("el-button",{attrs:{type:"info",size:"mini"},on:{click:function(a){return t.lookitem(e.row)}}},[t._v("查看")]):t._e(),t._v(" "),1==e.row.State||2==e.row.State?a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return t.lookitem(e.row)}}},[t._v("撤单")]):t._e()]}}])})],1),t._v(" "),a("SaxoFenYe",{attrs:{total:t.total},on:{func:t.func}})],1)},staticRenderFns:[]};var s=a("VU/8")(i,l,!1,function(t){a("ax3m")},"data-v-98fd2174",null);e.default=s.exports}});