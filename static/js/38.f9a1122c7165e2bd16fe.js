webpackJsonp([38],{"5jhZ":function(t,e){},tXVB:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("bOdI"),l=a.n(r),o=a("mvHQ"),i=a.n(o),n=a("t4zo"),s=a.n(n),c=a("uXZL"),u=a.n(c),p={name:"",data:function(){return{options:[{Name:"全部",ID:0,value:-1},{Name:"现场维修",ID:0,value:0},{Name:"小件维修",ID:0,value:1},{Name:"MUL&DBL维修",ID:0,value:4}],StateStr:-1,StateSTR:[{label:"全部",Value:-1},{label:"申请中",Value:1},{label:"已受理",Value:2},{label:"在保状态确认",Value:3},{label:"已预报价",Value:4},{label:"预报价已确认",Value:5},{label:"已指派",Value:6},{label:"已接受任务",Value:7},{label:"已出发",Value:8},{label:"已到达",Value:9},{label:"工作已完成",Value:10},{label:"已报最终价",Value:11},{label:"已结单",Value:12},{label:"已撤单",Value:13},{label:"其它",Value:14}],pageNum:1,pagesize:10,search:"",workOrderCode:"",Area:"",Brand:"",orderType:-1,total:0,data:[],data2:[],Optios:[],row:{}}},created:function(){this.pagesize=this.$store.state.DisplayNumber,this.initdata(),this.Manufacturer()},components:{},methods:{UpDataMemoFun:function(){var t=this;this.API_POST("WO/UpdateWOMemo",{ID:this.row.WorkOrderId,Str:this.row.Memo}).then(function(e){t.$message.success("修改成功！"),t.$refs.success.start(),t.initdata()})},upDataMemo:function(t){this.$refs.success.start(),this.row=JSON.parse(i()(t)),console.log(t)},querySearch:function(t,e){if(void 0==t)return t="",e(this.Optios),!1;if(""==t)return e(this.Optios),!1;for(var a=t,r=this.Optios,l=[],o=(a.split("")[0],0);o<r.length;o++){var i=r[o];-1!=i.value.indexOf(a)&&l.push(i)}e(l)},Manufacturer:function(){var t=this,e={url:this.$store.state.http+"System/GetBrand",api:"get"};this.$https(e).then(function(e){t.Optios=e.Data;for(var a=0;a<t.Optios.length;a++)t.Optios[a].value=t.Optios[a].Value;console.log(t.Optios)})},initdata:function(t){var e,a=this;1==t&&(this.pageNum=1);var r={url:this.$store.state.http+"WO/GetWOs",api:"get",data:(e={state:-1,search:this.search,workOrderCode:this.workOrderCode,orderType:this.orderType,Area:this.Area,Brand:this.Brand},l()(e,"state",this.StateStr),l()(e,"pageNum",this.pageNum),l()(e,"numPerPage",this.pagesize),l()(e,"orderField",""),l()(e,"orderDirection",""),e)};this.$https(r).then(function(t){console.log(t.Data.Dtos),a.total=t.Data.DataBars,a.data=t.Data.Dtos;for(var e=0;e<a.data.length;e++){var r=a.data[e];r.RepairDate&&(r.RepairDate=r.RepairDate.split("T")[0]),r.AcceptanceDate&&(r.AcceptanceDate=r.AcceptanceDate.split("T")[0]),r.FinishedWorkDate&&(r.FinishedWorkDate=r.FinishedWorkDate.split("T")[0])}})},func:function(t,e){this.pagesize=t,this.pageNum=e,this.initdata()},initdata2:function(){var t,e=this,a=(t={state:-1,search:this.search,workOrderCode:this.workOrderCode,orderType:this.orderType,Area:this.Area,Brand:this.Brand},l()(t,"state",this.StateStr),l()(t,"pageNum",1),l()(t,"numPerPage",999999),l()(t,"orderField",""),l()(t,"orderDirection",""),t);this.API_GET("WO/GetWOs",a).then(function(t){console.log(t),e.data2=t.Dtos;for(var a=0;a<e.data2.length;a++){var r=e.data2[a];r.RepairDate&&(r.RepairDate=r.RepairDate.split("T")[0]),r.AcceptanceDate&&(r.AcceptanceDate=r.AcceptanceDate.split("T")[0]),r.FinishedWorkDate&&(r.FinishedWorkDate=r.FinishedWorkDate.split("T")[0])}setTimeout(function(){e.exportExcelTo("#out-table")},1e3)})},exportExcelTo:function(t){console.log("0000");var e=u.a.utils.table_to_book(document.querySelector(t),{raw:!0}),a=u.a.write(e,{bookType:"xlsx",bookSST:!0,type:"array"});try{s.a.saveAs(new Blob([a],{type:"application/octet-stream"}),"未命名.xlsx")}catch(t){"undefined"!=typeof console&&console.log(t,a)}return a},Edit:function(t){console.log(t),this.$store.state.Vuex.Id=t.WorkOrderId,"现场维修"==t.OrderTypeStr&&this.$router.push({path:"/OnSiteMaintenance",query:t.WorkOrderId}),"小件维修"==t.OrderTypeStr&&this.$router.push({path:"/MinorMaintenance",query:t.WorkOrderId}),"MUL&DEU维修"==t.OrderTypeStr&&this.$router.push({path:"/DBLMaintenance",query:t.WorkOrderId})},router:function(t){var e="";"现场维修"==t.OrderTypeStr&&(e="GetRepairWODetail"),"小件维修"==t.OrderTypeStr&&(e="GetSRWODetail"),"MUL&DEU维修"==t.OrderTypeStr&&(e="GetDBLWODetail"),this.$router.push({path:"/TicketIncome",query:{Id:t.WorkOrderId,Type:e}})}}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"box"},[a("router-view",{on:{refresh:function(e){return t.initdata(1)}}}),t._v(" "),a("div",{staticClass:"TopSerch"},[a("el-input",{staticStyle:{width:"193px"},attrs:{size:"mini",placeholder:"请输入客户名称、设备描述"},on:{change:function(e){return t.initdata(1)}},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),t._v(" "),a("el-input",{staticStyle:{width:"193px"},attrs:{size:"mini",placeholder:"请输入工单单号"},on:{change:function(e){return t.initdata(1)}},model:{value:t.workOrderCode,callback:function(e){t.workOrderCode=e},expression:"workOrderCode"}}),t._v(" "),a("el-select",{staticStyle:{width:"140px"},attrs:{clearable:"",size:"mini",placeholder:"请选择区域"},on:{change:function(e){return t.initdata(1)}},model:{value:t.Area,callback:function(e){t.Area=e},expression:"Area"}},t._l(this.$store.state.Vuex.Area,function(t){return a("el-option",{key:t.Value,attrs:{label:t.Value,value:t.Value}})}),1),t._v(" "),a("el-select",{staticStyle:{width:"140px"},attrs:{size:"mini",placeholder:"请选择状态"},on:{change:function(e){return t.initdata(1)}},model:{value:t.StateStr,callback:function(e){t.StateStr=e},expression:"StateStr"}},t._l(t.StateSTR,function(t){return a("el-option",{key:t.Value,attrs:{label:t.label,value:t.Value}})}),1),t._v(" "),a("el-select",{staticStyle:{width:"140px"},attrs:{size:"mini",placeholder:"请选择类型"},on:{change:function(e){return t.initdata(1)}},model:{value:t.orderType,callback:function(e){t.orderType=e},expression:"orderType"}},t._l(t.options,function(t){return a("el-option",{key:t.Value,attrs:{label:t.Name,value:t.value}})}),1),t._v(" "),a("el-autocomplete",{staticClass:"inline-input",staticStyle:{width:"200px"},attrs:{size:"mini","show-overflow-tooltip":!0,"fetch-suggestions":t.querySearch,placeholder:"请选择品牌",clearable:""},on:{input:function(e){return t.initdata(1)}},model:{value:t.Brand,callback:function(e){t.Brand=e},expression:"Brand"}}),t._v(" "),a("el-button",{staticStyle:{float:"right"},attrs:{type:"info",size:"mini"},on:{click:function(e){return t.initdata2()}}},[t._v("导出")]),t._v(" "),a("el-button",{staticStyle:{float:"right",margin:"0 30px"},attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.initdata(1)}}},[t._v("检索")])],1),t._v(" "),a("saxo-pop",{ref:"success",attrs:{type:"success",title:"修改备注",width:"500"},on:{close:function(e){return t.$refs.success.start()}}},[a("el-input",{staticStyle:{width:"500px"},attrs:{type:"textarea",autosize:{minRows:4,maxRows:4},placeholder:"请输入内容"},model:{value:t.row.Memo,callback:function(e){t.$set(t.row,"Memo",e)},expression:"row.Memo"}}),t._v(" "),a("div",{staticStyle:{"text-align":"right",padding:"10px"}},[a("saxo-button",{attrs:{mini:"",type:"info"},on:{click:function(e){return t.$refs.success.start()}}},[t._v("取消")]),t._v(" "),a("saxo-button",{attrs:{mini:""},on:{click:function(e){return t.UpDataMemoFun()}}},[t._v("保存")])],1)],1),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.data,height:this.$store.state.TableOptimumHeight,size:"mini","highlight-current-row":"",border:"","header-cell-style":{background:"#e1e1e1"}}},[a("el-table-column",{attrs:{prop:"WorkOrderCode",label:"工单单号",width:"140"}}),t._v(" "),a("el-table-column",{attrs:{prop:"CustomerName",label:"客户名称","show-overflow-tooltip":!0}}),t._v(" "),a("el-table-column",{attrs:{prop:"Area",label:"区域",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Brand",label:"品牌",width:"200"}}),t._v(" "),a("el-table-column",{attrs:{prop:"RepairName",label:"报修人",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"RepairDate",label:"报修日期",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"AcceptanceDate",label:"受理日期",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"FinishedWorkDate",label:"完成日期",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"OrderTypeStr",label:"工单类型",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"StatusStr",label:"工单状态",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{label:"备注 点击可编辑","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(e){return[a("p",{on:{click:function(a){return t.upDataMemo(e.row)}}},[t._v(t._s(e.row.Memo))])]}}])}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"160"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("nav",{staticStyle:{"text-align":"center"}},[a("saxo-button",{attrs:{mini:"",type:"primary",size:"mini"},on:{click:function(a){return t.Edit(e.row)}}},[t._v("编辑")]),t._v(" "),a("saxo-button",{attrs:{mini:"",type:"success"},on:{click:function(a){return t.router(e.row)}}},[t._v("票款")])],1)]}}])})],1),t._v(" "),a("el-table",{staticStyle:{width:"100%",display:"none"},attrs:{data:t.data2,id:"out-table",height:this.$store.state.TableOptimumHeight,size:"mini","highlight-current-row":"",border:"","header-cell-style":{background:"#e1e1e1"}}},[a("el-table-column",{attrs:{prop:"WorkOrderCode",label:"工单单号",width:"140"}}),t._v(" "),a("el-table-column",{attrs:{prop:"CustomerName",label:"客户名称","show-overflow-tooltip":!0}}),t._v(" "),a("el-table-column",{attrs:{prop:"Area",label:"区域",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Brand",label:"品牌",width:"200"}}),t._v(" "),a("el-table-column",{attrs:{prop:"RepairName",label:"报修人",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"RepairDate",label:"报修日期",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"AcceptanceDate",label:"受理日期",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"FinishedWorkDate",label:"完成日期",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"OrderTypeStr",label:"工单类型",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"StatusStr",label:"工单状态",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"WorkContent",label:"工作内容",width:"100"}})],1),t._v(" "),a("SaxoFenYe",{attrs:{total:t.total},on:{func:t.func}})],1)},staticRenderFns:[]};var h=a("VU/8")(p,d,!1,function(t){a("5jhZ")},"data-v-ee894d36",null);e.default=h.exports}});